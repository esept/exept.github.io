<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>1</title>
    <url>/2020/05/15/1/</url>
    <content><![CDATA[<p>我想给博客上加上一点自己的东西，比如电影的介绍和推荐，</p>
]]></content>
  </entry>
  <entry>
    <title>Java_JVM</title>
    <url>/2020/06/30/Java_JVM/</url>
    <content><![CDATA[<p>JVM组成部分，每个组件的作用，各组件间的关系，案例，注意事项，面试问题</p>
<a id="more"></a>


<h1 id="JVM组成部分"><a href="#JVM组成部分" class="headerlink" title="JVM组成部分"></a>JVM组成部分</h1><p>java源文件与系统间的中介<br>jvm是源文件（.java)运行在操作系统的媒介<br>案例1</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> c = (a+b)*<span class="number">5</span>;</span><br><span class="line">        System.out.println(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        foo();</span><br><span class="line">	<span class="comment">// write your code here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">out:</span><br><span class="line"><span class="number">15</span></span><br></pre></td></tr></table></figure>
<p>运行，编译，将.java文件转换为.class文件</p>
<p><strong>JVM</strong> :<br>{ [类加载器(负责程序员与JVM交互)] &lt;-双向-&gt; [运行时数据区()] &lt;-双向-&gt; [执行引擎(负责jvm与操作系统的交互)] }</p>
<p>[.java] -{编译}-&gt; [.class]</p>
<p>#类加载器 classloader<br>通过分类和类加载</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Java_迭代</title>
    <url>/2020/06/30/Java_%E8%BF%AD%E4%BB%A3/</url>
    <content><![CDATA[<p>从新学+整理笔记<br>Java</p>
<a id="more"></a>

<h2 id="while"><a href="#while" class="headerlink" title="while"></a>while</h2><h3 id="while-1"><a href="#while-1" class="headerlink" title="while"></a>while</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">condition</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> result = Math.random()&lt;<span class="number">0.99</span>;</span><br><span class="line">        System.out.println(result +<span class="string">","</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(condition())</span><br><span class="line">            System.out.println(<span class="string">"Inside 'while'"</span>);</span><br><span class="line">        System.out.println(<span class="string">"Exited 'while'"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="do-while"><a href="#do-while" class="headerlink" title="do_while"></a>do_while</h3><p>do-while 语句至少是会执行一次<br>在while语句中，如果条件为false，那么其中的语句就不会执行</p>
<h2 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h2><p>for(初始化;布尔表达式;步进)<br>快速for<br><code>5.fori</code>-&gt;<code>for (int i = 0; i &lt; 5; i++)</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c=<span class="number">0</span>;c&lt;<span class="number">128</span>;c++)</span><br><span class="line">            <span class="keyword">if</span>(Character.isLowerCase(c)) &#123;<span class="comment">//检测是否为小写字母</span></span><br><span class="line">            System.out.println(<span class="string">"value "</span>+(<span class="keyword">int</span>)c+<span class="string">" character: "</span>+c);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">out:</span><br><span class="line"></span><br><span class="line">value <span class="number">97</span>	character: a</span><br><span class="line">value <span class="number">98</span>	character: b</span><br><span class="line">value <span class="number">99</span>	character: c</span><br><span class="line">value <span class="number">100</span>	character: d</span><br><span class="line">value <span class="number">101</span>	character: e</span><br><span class="line">value <span class="number">102</span>	character: f</span><br><span class="line">value <span class="number">103</span>	character: g</span><br><span class="line">value <span class="number">104</span>	character: h</span><br><span class="line">value <span class="number">105</span>	character: i</span><br><span class="line">value <span class="number">106</span>	character: j</span><br><span class="line">value <span class="number">107</span>	character: k</span><br><span class="line">value <span class="number">108</span>	character: l</span><br><span class="line">value <span class="number">109</span>	character: m</span><br><span class="line">value <span class="number">110</span>	character: n</span><br><span class="line">value <span class="number">111</span>	character: o</span><br><span class="line">value <span class="number">112</span>	character: p</span><br><span class="line">value <span class="number">113</span>	character: q</span><br><span class="line">value <span class="number">114</span>	character: r</span><br><span class="line">value <span class="number">115</span>	character: s</span><br><span class="line">value <span class="number">116</span>	character: t</span><br><span class="line">value <span class="number">117</span>	character: u</span><br><span class="line">value <span class="number">118</span>	character: v</span><br><span class="line">value <span class="number">119</span>	character: w</span><br><span class="line">value <span class="number">120</span>	character: x</span><br><span class="line">value <span class="number">121</span>	character: y</span><br><span class="line">value <span class="number">122</span>	character: z</span><br></pre></td></tr></table></figure>



<h3 id="逗号分隔符"><a href="#逗号分隔符" class="headerlink" title="逗号分隔符"></a>逗号分隔符</h3><p>通过使用逗号分隔符，可以在for语句中内定义多个变量，但是他们必须具有相同的类型</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>,j=i+<span class="number">10</span>;i&lt;<span class="number">5</span>;i++,j=i*<span class="number">2</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"i = "</span>+i+<span class="string">" j = "</span> +j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span> j = <span class="number">11</span></span><br><span class="line">i = <span class="number">2</span> j = <span class="number">4</span></span><br><span class="line">i = <span class="number">3</span> j = <span class="number">6</span></span><br><span class="line">i = <span class="number">4</span> j = <span class="number">8</span></span><br></pre></td></tr></table></figure>
<h3 id="Foreach语法"><a href="#Foreach语法" class="headerlink" title="Foreach语法"></a>Foreach语法</h3><p>foreach语法用于数组和容器<br>foreach语法表示不必创建int变量去队友访问项构成的序列进行计数，foreach将自动产生每一项（类似python的for）</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line">        <span class="keyword">float</span> f[] = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">            f[i] = rand.nextFloat();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">float</span> x:f)</span><br><span class="line">            System.out.println(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"><span class="number">0.72711575</span></span><br><span class="line"><span class="number">0.39982635</span></span><br><span class="line"><span class="number">0.5309454</span></span><br><span class="line"><span class="number">0.0534122</span></span><br><span class="line"><span class="number">0.16020656</span></span><br><span class="line"><span class="number">0.57799757</span></span><br><span class="line"><span class="number">0.18847865</span></span><br><span class="line"><span class="number">0.4170137</span></span><br><span class="line"><span class="number">0.51660204</span></span><br><span class="line"><span class="number">0.73734957</span></span><br></pre></td></tr></table></figure>

<h4 id="toCharArray"><a href="#toCharArray" class="headerlink" title="toCharArray()"></a>toCharArray()</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c: <span class="string">"An american swallow"</span>.toCharArray())</span><br><span class="line">            System.out.print(c+<span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line">A n   a m e r i c a n   s w a l l o w</span><br></pre></td></tr></table></figure>

<h2 id="死循环的标准格式"><a href="#死循环的标准格式" class="headerlink" title="死循环的标准格式"></a>死循环的标准格式</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">	···</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Scrapy-Bilibili</title>
    <url>/2020/06/26/bilibili-scrapy/</url>
    <content><![CDATA[<p>Scrapy 项目<br>Bilibili某一up主的视频名称、播放量、喜欢数<br>以及对他视频弹幕的爬取与词云制作</p>
<a id="more"></a>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">import</span> json </span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> wordcloud</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> jieba</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DaoyuesheSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'daoyueshe'</span></span><br><span class="line">    allowed_domains = [<span class="string">'bilibili.com'</span>]</span><br><span class="line">    <span class="comment"># start_urls = ['https://space.bilibili.com/99157282/video']</span></span><br><span class="line">    api_all = <span class="string">'https://api.bilibili.com/x/space/upstat?mid=99157282&amp;jsonp=jsonp'</span></span><br><span class="line">    api_video = <span class="string">'https://api.bilibili.com/x/web-interface/view?bvid='</span></span><br><span class="line">    api_comment = <span class="string">'https://comment.bilibili.com/%s.xml'</span></span><br><span class="line">    start_urls = [api_all]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">11</span>):</span><br><span class="line">            url = <span class="string">'https://api.bilibili.com/x/space/arc/search?mid=99157282&amp;ps=30&amp;tid=0&amp;pn=%s&amp;keyword=&amp;order=pubdate&amp;jsonp=jsonp'</span> % (page)</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">                url = url,</span><br><span class="line">                callback = self.parse1</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse1</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        data = json.loads(response.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'data'</span> != <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">for</span> vn <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">31</span>):</span><br><span class="line">                video_data = data.get(<span class="string">'data'</span>).get(<span class="string">'list'</span>).get(<span class="string">'vlist'</span>)[vn]</span><br><span class="line">                <span class="comment"># print(video_data['title'],'--',video_data['play'],'--',video_data['comment'],'--',video_data['bvid'])</span></span><br><span class="line">                <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">                    url = self.api_video+video_data[<span class="string">'bvid'</span>],</span><br><span class="line">                    callback=self.parse_video</span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_video</span><span class="params">(self,response)</span>:</span></span><br><span class="line">        data_v = json.loads(response.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'data_v'</span> != <span class="literal">None</span>:</span><br><span class="line">            cid = str(data_v.get(<span class="string">'data'</span>)[<span class="string">'cid'</span>])</span><br><span class="line">            <span class="comment"># print(cid)</span></span><br><span class="line">            url = self.api_comment</span><br><span class="line">            <span class="comment"># print(type(url))</span></span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">                url = url % (cid) ,</span><br><span class="line">                callback=self.parse_comment</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_comment</span><span class="params">(self,response)</span>:</span></span><br><span class="line">        id = response.xpath(<span class="string">'//chatid/text()'</span>).extract()</span><br><span class="line">        print(id[<span class="number">0</span>])</span><br><span class="line">        url = self.api_comment%(id[<span class="number">0</span>])</span><br><span class="line">        all_comment = requests.get(url)</span><br><span class="line">        all_comment.encoding=<span class="string">'utf8'</span></span><br><span class="line">        soup = BeautifulSoup(all_comment.text,<span class="string">'lxml'</span>)</span><br><span class="line">        res = soup.find_all(<span class="string">'d'</span>)</span><br><span class="line">        comments = [comment.text <span class="keyword">for</span> comment <span class="keyword">in</span> res]</span><br><span class="line">        print(comments)</span><br><span class="line">        print(len(comments))</span><br><span class="line"></span><br><span class="line">        comments_clean = [comment.replace(<span class="string">' '</span>, <span class="string">''</span>) <span class="keyword">for</span> comment <span class="keyword">in</span> comments]  <span class="comment"># 去掉空格</span></span><br><span class="line"></span><br><span class="line">        set(comments_clean)  <span class="comment"># 看一下都有啥类似的没用的词语</span></span><br><span class="line"></span><br><span class="line">        useless_words = [<span class="string">'//TEST'</span>,</span><br><span class="line">                         <span class="string">'/TESR'</span>,</span><br><span class="line">                         <span class="string">'/TEST'</span>,</span><br><span class="line">                         <span class="string">'/TEST/'</span>,</span><br><span class="line">                         <span class="string">'/TEXT'</span>,</span><br><span class="line">                         <span class="string">'/TEXTSUPREME'</span>,</span><br><span class="line">                         <span class="string">'/TSET'</span>,</span><br><span class="line">                         <span class="string">'/Y'</span>,</span><br><span class="line">                         <span class="string">'\\TEST'</span>]</span><br><span class="line"></span><br><span class="line">        comments_clean = [element <span class="keyword">for</span> element <span class="keyword">in</span> comments_clean <span class="keyword">if</span> element <span class="keyword">not</span> <span class="keyword">in</span> useless_words]  <span class="comment"># 去掉不想要的字符</span></span><br><span class="line">        cipin = pd.DataFrame(&#123;<span class="string">'danmu'</span>: comments_clean&#125;)</span><br><span class="line">        cipin[<span class="string">'danmu'</span>].value_counts()  <span class="comment"># 查看词频</span></span><br><span class="line">        danmustr = <span class="string">''</span>.join(element <span class="keyword">for</span> element <span class="keyword">in</span> comments_clean)  <span class="comment"># 把所有的弹幕都合并成一个字符串</span></span><br><span class="line">        words = list(jieba.cut(danmustr))  <span class="comment"># 分词</span></span><br><span class="line">        fnl_words = [word <span class="keyword">for</span> word <span class="keyword">in</span> words <span class="keyword">if</span> len(word) &gt; <span class="number">1</span>]  <span class="comment"># 去掉单字</span></span><br><span class="line">        wc = wordcloud.WordCloud(width=<span class="number">1000</span>, font_path=<span class="string">'STHeiti Medium.ttc'</span>, height=<span class="number">800</span>)  <span class="comment"># 设定词云画的大小字体，一定要设定字体，否则中文显示不出来</span></span><br><span class="line">        wc.generate(<span class="string">' '</span>.join(fnl_words))</span><br><span class="line"></span><br><span class="line">        plt.imshow(wc)  <span class="comment"># 看图</span></span><br><span class="line">        wc.to_file(<span class="string">r"./%s.png"</span>%(id[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title>Diary-2020</title>
    <url>/2020/05/10/diary/</url>
    <content><![CDATA[<p>这里曾经，依旧是我的五月<br>岁月漫长，但是值得等待<br> <a id="more"></a></p>
<h2 id="2020-05"><a href="#2020-05" class="headerlink" title="2020-05"></a>2020-05</h2><p>自己剖析自己是一件挺可怕的事情，因为有的时候一旦发现自己做那件事的原因竟然是因为这样的一个理由，如果这样的原因是一个不愿被自己接受的结果，那面对自己都会有一点不情愿<br>对于爬虫这个东西真的是麻烦，做个项目竟然还要自己购买代理</p>
<p>今天不知道是第几次试图创建图片流失败了<br>我基本上已经要放弃尝试了，现在前端的东西一点也不会，完全就是按照网上的教程来进行自己的操作<br>然后嘞，我发现现在这样子的一个环境还是很适合自己的<br>因为很有感觉<br>然后发现自己创建更新内容和前端，访问量轻轻松松上百</p>
<p>Emmm。。。</p>
<p>想回国的时候去北京吃一堆想吃的东西</p>
<p>今天先这样子吧</p>
<p>喜欢下雨天。</p>
<p>苏格兰威士忌<br>威士忌的味道是我很喜欢的，没有刺激性的气味，淡淡的香气给我一种很安稳的感觉，轻轻的闻一下是一种甜甜的味道。和舌尖接触可以让舌尖发麻，但是没有其他的感觉。现在买的第二瓶还剩一个根，等我晚上再把其他的感觉补上。</p>
<p>朗姆酒<br>闻起来是一种比威士忌更强烈的香气，甜味对我来说有些太浓了</p>
<p>好像从去年的年初就已经丧失了所有的情绪<br>再也没有能让我眼前一亮的词句从我的脑中飞出<br>就算是情绪也可以随意交付</p>
<p>情绪总是将我隐匿在雨中<br>半夏的风吹响雨声<br>树叶叫醒的是升起的朝阳<br>冷的目光灼伤太阳<br>山上的密林升起雾气<br>掩盖住暗黑的半响时光</p>
<p>残冬带不走落地的积雪<br>寒冰也无法接触太阳<br>清晨的露气凝结草叶上<br>白的主题色被初春封藏<br>渐离的梦跨国银河<br>紧贴住秋的霓裳(nichang)</p>
<p>惊春的花木消逝掉白霜<br>推了一把融成的露水<br>滋润在身边寂寥之上<br>半熟的草叶叫迎着梅夏</p>
]]></content>
      <categories>
        <category>日记</category>
      </categories>
      <tags>
        <tag>采集忘却</tag>
      </tags>
  </entry>
  <entry>
    <title>Minist数据集</title>
    <url>/2020/06/19/Minist%E6%95%B0%E6%8D%AE%E9%9B%86/</url>
    <content><![CDATA[<h1 id="Minist数据集"><a href="#Minist数据集" class="headerlink" title="Minist数据集"></a>Minist数据集</h1><p>sorcket</p>
<h3 id="数据集介绍"><a href="#数据集介绍" class="headerlink" title="数据集介绍"></a>数据集介绍</h3><p>手写的七万个数字图片<br>机器学习领域的hello world<br>新的分类算法都会在minist上练习<br>ubyte 二进制文件</p>
<p>压缩的二进制文件<br>.mat 文件<br>二者各自的解压方式不同</p>
<p>在minist里有两个训练的压缩包<br>images 和 labels分别是图片和标签</p>
<h3 id="数据介绍"><a href="#数据介绍" class="headerlink" title="数据介绍"></a>数据介绍</h3><p>Minist在解压之后是二进制文件，需要再进行解包才能获得数据<br>需要知道解包格式<br>第一行：<br>offset 偏移：0000<br>type = 32bits -》 4个int<br>description：magic number 魔法数字<br>第二行：<br>0004 -〉第一行4个int<br>32bit -》4个int<br>number of items 标签个数<br>后面的：<br>0008-0009····数字都是从0到9，因此不需要过大的位置<br>Unsigned byte ：一个byte<br>label：标签<br>Django-》http协议（body-key-value）需要有request然后返回response<br>Socket协议，传输byte数组 可以常链接 延迟低</p>
<h2 id="解包和拆包"><a href="#解包和拆包" class="headerlink" title="解包和拆包"></a>解包和拆包</h2><p>pack 打包 -&gt; 把数字2打包成二进制数组</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct </span><br><span class="line">struct.pack(‘&gt;i’,<span class="number">2</span>) <span class="comment"># 把二打包成int类型</span></span><br><span class="line"><span class="comment"># --- b’\x00\x00\x00\x02’</span></span><br><span class="line">struct.pack(<span class="string">'&gt;B'</span>,<span class="number">2</span>) <span class="comment"># 把二打包成byte类型</span></span><br><span class="line"><span class="comment"># --- b'\x02'</span></span><br></pre></td></tr></table></figure>
<p>unpack 解包<br>要按照解压列表</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解压</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./MNIST_data/train-images-idx3-ubyte'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    buffer = f.read(<span class="number">4</span>*<span class="number">4</span>) <span class="comment"># 4个int -&gt; ’Training set image file‘里 4个int的魔法数字，4个int的图片个数，4个int的宽和高的像素</span></span><br><span class="line">    head = struct.unpack(<span class="string">'&gt;iiii'</span>,buffer) <span class="comment"># 解包成4个int文件</span></span><br><span class="line">    print(head)</span><br><span class="line">    length = head[<span class="number">1</span>]*head[<span class="number">2</span>]*head[<span class="number">3</span>] <span class="comment"># 像素个数，60000*28*28 像素包</span></span><br><span class="line">    print(length)</span><br><span class="line">    buffer = f.read(length)</span><br><span class="line">    print(buffer)</span><br><span class="line">    data = struct.unpack(<span class="string">'&gt;&#123;&#125;B'</span>.format(length),buffer) <span class="comment"># 用unpack解包，‘&gt;&#123;&#125;B’:一个byte的站位，解包length</span></span><br><span class="line"><span class="comment"># (2051, 60000, 28, 28)</span></span><br><span class="line"><span class="comment"># 47040000</span></span><br><span class="line">len(data) <span class="comment"># 长度</span></span><br><span class="line"><span class="comment"># 47040000</span></span><br><span class="line">type(data) <span class="comment"># 类型</span></span><br><span class="line"><span class="comment"># tuple 元组</span></span><br></pre></td></tr></table></figure>

<h2 id="图片的显示"><a href="#图片的显示" class="headerlink" title="图片的显示"></a>图片的显示</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np <span class="comment"># 重新塑形</span></span><br><span class="line">imgs = np.reshape(data,(head[<span class="number">1</span>],head[<span class="number">2</span>],head[<span class="number">3</span>])) <span class="comment"># 装换成矩阵</span></span><br><span class="line">imgs.shape <span class="comment"># 60000个图片 每个28*28个像素</span></span><br><span class="line">~<span class="comment"># (60000, 28, 28)~</span></span><br></pre></td></tr></table></figure>
<p>Imgs有所有的图片数据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    plt.imshow(imgs[i],cmap=<span class="string">'gray'</span>) <span class="comment"># imshow 显示图片 cmap色域</span></span><br><span class="line">    plt.show()</span><br><span class="line"><span class="comment"># 显示图片</span></span><br></pre></td></tr></table></figure>

<h2 id="另一种解包方式：mat"><a href="#另一种解包方式：mat" class="headerlink" title="另一种解包方式：mat"></a>另一种解包方式：mat</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> fetch_mldata</span><br><span class="line">mnist = fetch_mldata(<span class="string">'MNIST original'</span>, data_home=<span class="string">'./'</span>) <span class="comment"># 本地加载数据集</span></span><br><span class="line">mnist</span><br></pre></td></tr></table></figure>

<blockquote>
<p>{‘DESCR’: ‘mldata.org dataset: mnist-original’,<br> ‘COL_NAMES’: [‘label’, ‘data’],<br> ‘target’: array([0., 0., 0., …, 9., 9., 9.]),<br> <del>‘data’: array([[0, 0, 0, …, 0, 0, 0],  二维数组（矩阵-独热编码）</del><br>        [0, 0, 0, …, 0, 0, 0],<br>        [0, 0, 0, …, 0, 0, 0],<br>        …,<br>        [0, 0, 0, …, 0, 0, 0],<br>        [0, 0, 0, …, 0, 0, 0],<br>        [0, 0, 0, …, 0, 0, 0]], dtype=uint8)}  </p>
</blockquote>
<ul>
<li>DESCR 数据集描述</li>
<li>data 包含一个数组，每个实例为一行，每个特征为一列</li>
<li>target 包含一个带有标签的数组<br>接下来要拆分测试和训练集以及将数据和标签页拆分出来<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X,y = mnist[<span class="string">'data'</span>],mnist[<span class="string">'target'</span>] <span class="comment"># 键值对赋值</span></span><br><span class="line">X.shape <span class="comment"># 28*28=784</span></span><br><span class="line"><span class="comment"># (70000, 784)</span></span><br><span class="line">y.shape <span class="comment"># 标签</span></span><br><span class="line">---</span><br><span class="line">~<span class="comment"># 图片的显示~</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">some_digit = X[<span class="number">36000</span>]<span class="comment"># 取第36000张图片</span></span><br><span class="line">some_digit_image = some_digit.reshape(<span class="number">28</span>,<span class="number">28</span>) <span class="comment"># 从新塑形成28*28的像素模式</span></span><br><span class="line">---</span><br><span class="line">plt.imshow(some_digit_image,cmap = matplotlib.cm.binary)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 显示图片</span></span><br><span class="line">y[<span class="number">36000</span>] <span class="comment"># 显示标签</span></span><br><span class="line"><span class="comment"># 5.0</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="建立测试集和训练集"><a href="#建立测试集和训练集" class="headerlink" title="建立测试集和训练集"></a>建立测试集和训练集</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X_train,X_test,y_train,y_test = X[:<span class="number">60000</span>],X[<span class="number">60000</span>:],y[:<span class="number">60000</span>],y[<span class="number">60000</span>:] <span class="comment"># [:60000]从头到六万个；[:60000]从六万个到最后</span></span><br></pre></td></tr></table></figure>
<p>将数据集合交叉洗牌，交叉验证时，每个子集合数据分布均匀，有些机器学习算法对训练实例的顺序敏感</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">shuffle_index = np.random.permutation(<span class="number">60000</span>)</span><br><span class="line">shuffle_index</span><br><span class="line"><span class="comment"># array([32752, 22871, 59898, ..., 14516,   956, 31988])</span></span><br><span class="line">X_train, y_train = X_train[shuffle_index], y_train[shuffle_index]<span class="comment"># 将重新洗牌的顺序赋值给训练组</span></span><br><span class="line">X_train</span><br></pre></td></tr></table></figure>
<blockquote>
<p>array([[0, 0, 0, …, 0, 0, 0],<br>       [0, 0, 0, …, 0, 0, 0],<br>       [0, 0, 0, …, 0, 0, 0],<br>       …,<br>       [0, 0, 0, …, 0, 0, 0],<br>       [0, 0, 0, …, 0, 0, 0],<br>       [0, 0, 0, …, 0, 0, 0]], dtype=uint8)  </p>
</blockquote>
<h2 id="训练一个二元分类器"><a href="#训练一个二元分类器" class="headerlink" title="训练一个二元分类器"></a>训练一个二元分类器</h2><p>是/非<br>识别数字，识别0-9其中的一个数字：例如只识别是不是5</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 识别数字5 ，二元分类5或者非5</span></span><br><span class="line"><span class="comment"># 创建目标向量</span></span><br><span class="line">y_train_5 = (y_train == <span class="number">5</span>)</span><br><span class="line">y_train_5</span><br><span class="line"><span class="comment"># array([ True, False, False, ..., False, False,  True]) 值为5的显示为True</span></span><br><span class="line">y_train_5.reshape(<span class="number">20</span>, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>array([[ True, False, False, …, False, False, False],<br>       [False, False, False, …,  True, False, False],<br>       [False,  True, False, …, False, False, False],<br>       …,<br>       [False, False, False, …,  True, False, False],<br>       [False, False, False, …, False, False, False],<br>       [False,  True, False, …, False, False,  True]])  </p>
</blockquote>
<p><code>y_test_5 = (y_test == 5)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 线性分类器</span></span><br><span class="line"><span class="comment"># SGD 梯度下降 分类器， 适合非常大的数据集，独立处理训练集数据，一次一个，适合在线学习，</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> SGDClassifier</span><br><span class="line"></span><br><span class="line">sgd_clf = SGDClassifier(random_state = <span class="number">42</span>)<span class="comment"># 返回训练好的模型</span></span><br><span class="line">sgd_clf.fit(X_train, y_train_5) <span class="comment"># 用估算器训练模型</span></span><br><span class="line"><span class="comment"># 预测第36000个值 = 5</span></span><br><span class="line">sgd_clf.predict([some_digit])</span><br></pre></td></tr></table></figure>
<p>array([ True])</p>
<h2 id="性能考核"><a href="#性能考核" class="headerlink" title="性能考核"></a>性能考核</h2><h3 id="使用交叉验证测量精度"><a href="#使用交叉验证测量精度" class="headerlink" title="使用交叉验证测量精度"></a>使用交叉验证测量精度</h3><p>评估分类器比评估回归器要困难得多<br>3个折叠，正确率达到 95% 以上</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score <span class="comment"># 单维度</span></span><br><span class="line">cross_val_score(sgd_clf, X_train, y_train_5, cv=<span class="number">3</span>, scoring=<span class="string">"accuracy"</span>) <span class="comment"># cv 折叠</span></span><br></pre></td></tr></table></figure>
<p>array([0.959  , 0.95955, 0.96515])<br>正确率很高，但是有一些片面和局限</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 把每张图都分类成 非5</span></span><br><span class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> BaseEstimator</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Never5Classifier</span><span class="params">(BaseEstimator)</span>:</span> <span class="comment"># 评估非5的情况</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self,X,y = None)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self,X)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> np.zeros((len(X),<span class="number">1</span>),dtype=bool) <span class="comment"># X是所有图片的数据</span></span><br><span class="line"></span><br><span class="line">np.zeros((len(X),<span class="number">1</span>),dtype=bool)<span class="comment"># 显示一下内容</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>array([[False],<br>       [False],<br>       [False],<br>       …,<br>       [False],<br>       [False],<br>       [False]])  </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">never_5_clf = Never5Classifier()</span><br><span class="line">cross_val_score(never_5_clf, X_train, y_train_5, cv=<span class="number">3</span>, scoring=<span class="string">"accuracy"</span>)</span><br></pre></td></tr></table></figure>
<p>array([0.90985, 0.9091 , 0.91   ])</p>
<ul>
<li>准确率超过90%，因为5的图像大约只有10%，你猜一张图不是5，那么90%的时间都是准确的</li>
<li>这说明准确率无法成为分类器的首要性能指标，特别是当你处理偏科数据集，某些类比其他类更为频繁</li>
</ul>
<h3 id="混淆矩阵"><a href="#混淆矩阵" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h3><ul>
<li>评估分类器性能的更好方法是混淆矩阵</li>
<li>A类别实例被分类为B类别次数</li>
<li>想要知道分类器将数字3和数字5混淆多次，通过混淆矩阵的5行3列<br>score 分数 predict 预测值<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_predict</span><br><span class="line">y_train_pred = cross_val_predict(sgd_clf, X_train, y_train_5, cv=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
与 cross_val_score 相比</li>
<li>同样执行交叉验证</li>
<li>返回的不是评估分数，是每个折叠的预测</li>
<li>每一个实例在模型预测时使用的数据，在训练期间从未见过<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line">confusion_matrix(y_train_5, y_train_pred)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>array([[54200,   379],  </p>
<pre><code>[ 1947,  3474]])  </code></pre></blockquote>
</li>
<li>行表示实际类别，列表示预测类别*</li>
<li>第一行 第一列 53272 被正确的分为 非5 ，真负类*</li>
<li>第一行 第二列 1307 被错误的分类成 5 ，假正类*</li>
<li>第二行 第一列 1077 张被错误的分为 非5， 假负类*</li>
<li>第二行 第二列 4344 张被正确的分在了5 ，真正类*</li>
<li>这种衡量方式太复杂，我们可以用更简单的指标*<br>假类尽可能校，真类尽可能多<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">y_train_perfect_predictions &#x3D; y_train_5</span><br><span class="line">confusion_matrix(y_train_5, y_train_perfect_predictions)</span><br></pre></td></tr></table></figure>
array([[54579,     0],<pre><code>[    0,  5421]])</code></pre></li>
</ul>
<h3 id="正类预测的准确率-被称为分类器的精度"><a href="#正类预测的准确率-被称为分类器的精度" class="headerlink" title="正类预测的准确率 被称为分类器的精度"></a>正类预测的准确率 被称为分类器的精度</h3><p><img src="/esept/esept.github/612A4366-A9A0-4900-AFC4-C576ACAA05DC.png" alt><br>从多个角度全面的分析分类器，而不是只讨论精度，因为这是一个二元分类器，因此它是一个二元矩阵，有四个格子，为了能考虑到表里的所有的数据，所以纵向用精度，横向用召回率<br>那么如何获得精度和召回呢</p>
<h3 id="精度和召回率"><a href="#精度和召回率" class="headerlink" title="精度和召回率"></a>精度和召回率</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> precision_score, recall_score <span class="comment"># </span></span><br><span class="line">precision_score(y_train_5, y_train_pred) <span class="comment"># （实际标签，预测标签）；4327 / 4327 + 1276</span></span><br><span class="line"><span class="comment"># 0.9016350895406177 -&gt;准确概率</span></span><br><span class="line">recall_score(y_train_5, y_train_pred)    <span class="comment">#  4327 / 4327 + 1094</span></span><br><span class="line"><span class="comment"># 0.6408411732152739 -&gt;检测出的概率</span></span><br></pre></td></tr></table></figure>
<ul>
<li>说明 检测一张图的时候，只有90%的概率是准确的，而且只有64%的数字5 被它检测出来</li>
<li>精度和召回率合成单一指标，成为 F1 分数，谐波平均值</li>
<li>平均值平等对待所有的值，谐波平均值会给予较低值更高的权重，只有召回率和精度都很高时，才能获得较高的F1分数<br><img src="/esept/esept.github/1FFF4962-E4B3-4763-85B8-F9FE68D4B763.png" alt><br>sklearn中求F1的方法<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> f1_score</span><br><span class="line">f1_score(y_train_5, y_train_pred)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>0.7491912874703472  </p>
</blockquote>
</li>
<li>F1分数对那些具有相近精度和召回率 分类器更有利，这不一定符合你的期望</li>
<li>有时候你更关心精度，有时你能关心召回率</li>
<li>训练一个分类器检测儿童可以放心观看的视频，你可能要求拦截了很多好的视频，低召回率，保留下来的都是安全的视频，高精度</li>
<li>不能同时增加精度并减少召回率，反之亦然<h3 id="精度-召回率权衡"><a href="#精度-召回率权衡" class="headerlink" title="精度/召回率权衡"></a>精度/召回率权衡</h3>￼￼￼<br><img src="/esept/esept.github/CC81A33B-F9D1-4868-810E-AAAE7D0E6590.png" alt></li>
<li>SGDClassifier对每个实例基于决策函数计算一个分值，大于阀值为正类，否则为负类</li>
<li>中间阀值右侧找到4个真正类 真5 ， 一个假正类 6， 精度为 4/5 80%</li>
<li>在所有的6个 真正的5 中，分类器找到了4个，召回率为 4/6 67%</li>
<li>提高阀值，向右移动，精度提高，召回降低</li>
<li>反之阀值降低，召回提高，精度降低</li>
<li>SKlearn不可以直接设置阀值，可以访问决策分数，</li>
<li>SGDClassifier 默认阀值为0 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如何设置阀值</span></span><br><span class="line"><span class="comment"># 不能直接运行</span></span><br><span class="line"><span class="comment"># 用predict_proba得到每个实例属于正类的概率，然后对概率切一下。以LogisticRegression为例</span></span><br><span class="line">clf = LogisticRegression()</span><br><span class="line">clf.fit(X_train, y_train)</span><br><span class="line">pred_proba = clf.predict_proba(X_test)[:, <span class="number">1</span>]</span><br><span class="line">threshold = <span class="number">0.75</span>  <span class="comment"># 阀值设置为0.75</span></span><br><span class="line">pred_label = pred_proba &gt; threshold</span><br></pre></td></tr></table></figure>
pred_proba是每个实例为真的概率<br>假设阈值是0.75<br>pred_label里True就是概率大于0.75的<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 返回决策值decision_function </span></span><br><span class="line">y_scores = sgd_clf.decision_function([some_digit]) <span class="comment"># some_digit=5</span></span><br><span class="line">y_scores <span class="comment"># 决策值</span></span><br></pre></td></tr></table></figure>
array([42217.83953346])<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">threshold = <span class="number">0</span> <span class="comment"># 阀值为0</span></span><br><span class="line">y_some_digit_pred = (y_scores &gt; threshold) <span class="comment"># 42217 &gt; 0 </span></span><br><span class="line">y_some_digit_pred</span><br></pre></td></tr></table></figure>
array([ True]) <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># **提高阀值可以降低召回率**，提高阀值到200000，就错过了这个图 决策值分数为42217</span></span><br><span class="line">threshold = <span class="number">200000</span></span><br><span class="line">y_some_digit_pred = (y_scores &gt; threshold) <span class="comment"># 42217 &lt; 200000</span></span><br><span class="line">y_some_digit_pred</span><br></pre></td></tr></table></figure>
array([False])<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如何决定使用什么阀值</span></span><br><span class="line"><span class="comment"># 返回决策值，而不是预测结果</span></span><br><span class="line">y_scores = cross_val_predict(sgd_clf, X_train, y_train_5, cv=<span class="number">3</span>,</span><br><span class="line">                             method=<span class="string">"decision_function"</span>)</span><br><span class="line"><span class="comment"># y_scores是所有三次折叠平均的一个决策值</span></span><br><span class="line"><span class="comment"># 有了y_scores，可以计算所有可能的阀值的精度和召回率</span></span><br><span class="line">y_scores.shape</span><br><span class="line"><span class="comment"># (60000,)</span></span><br><span class="line">---</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> precision_recall_curve</span><br><span class="line">precisions, recalls, thresholds = precision_recall_curve(y_train_5, y_scores) <span class="comment"># 精度 召回 阀值</span></span><br></pre></td></tr></table></figure>
<img src="/esept/esept.github/DD9F3A4F-57E6-4EB0-A8D1-948762C221C6.png" alt><br>虚线—进度<br>实线-召回<br>交点在0.8左右<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'SimHei'</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_precision_vs_recall</span><span class="params">(precisions, recalls)</span>:</span></span><br><span class="line">    plt.plot(recalls, precisions, <span class="string">"b-"</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">    plt.xlabel(<span class="string">"召回"</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"精度"</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.axis([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">plot_precision_vs_recall(precisions, recalls)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<img src="/esept/esept.github/AD898214-B96B-471F-8F0F-B9F25DD6970B.png" alt><h3 id="通过选择阀值来实现最佳的精度-召回率权衡"><a href="#通过选择阀值来实现最佳的精度-召回率权衡" class="headerlink" title="通过选择阀值来实现最佳的精度/召回率权衡"></a>通过选择阀值来实现最佳的精度/召回率权衡</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 目标设定为90%的精度，阀值大概在30000左右 , 设置了阀值为30000</span></span><br><span class="line">y_train_pred_90 = (y_scores &gt; <span class="number">30000</span>)</span><br><span class="line">precision_score(y_train_5, y_train_pred_90)</span><br><span class="line"><span class="comment"># 0.9292811221507891</span></span><br><span class="line">recall_score(y_train_5, y_train_pred_90)</span><br><span class="line"><span class="comment">#30.5866076369673492</span></span><br></pre></td></tr></table></figure></li>
<li>获得了一个90%精度的分类器，但如果召回太低，精度再高，也不怎么有用</li>
<li>如果工作中，需要99%的精度，你应该回应，召回率是多少？<h3 id="ROC-曲线"><a href="#ROC-曲线" class="headerlink" title="ROC 曲线"></a>ROC 曲线</h3></li>
<li>本质是 真正类率tpr和假正类率fpr（错误的分为正类的负类实例比例）</li>
<li>与召回/精度曲线非常相似<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_curve</span><br><span class="line">fpr, tpr, thresholds = roc_curve(y_train_5, y_scores)</span><br><span class="line"><span class="comment"># 绘制ROC图</span></span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'SimHei'</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_roc_curve</span><span class="params">(fpr, tpr, label=None)</span>:</span></span><br><span class="line">    plt.plot(fpr, tpr, linewidth=<span class="number">2</span>, label=label)</span><br><span class="line">    plt.plot([<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>], <span class="string">'k--'</span>)</span><br><span class="line">    plt.axis([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">    plt.xlabel(<span class="string">'假正类率'</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.ylabel(<span class="string">'真正类率'</span>, fontsize=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">plot_roc_curve(fpr, tpr)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<img src="/esept/esept.github/%E6%9C%AA%E7%9F%A5.png" alt><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 计算曲线下面积AUC，虚线是随机分类0.5到1 </span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score</span><br><span class="line">roc_auc_score(y_train_5, y_scores)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>0.9590312638413596  -&gt; 通过计算面积来衡量效率</p>
<ul>
<li>召回率TPR越高，分类器的假正类FPR就越多</li>
<li>虚线表示纯随机分类器的ROC曲线，好的分类器应该远离这条线，向左上角</li>
<li>是使用精度/召回率 PR曲线，还是使用ROC，关键在于 正类非常少或者更关注假正类而不是假负类，选择PR，反之ROC</li>
<li>例如：前面例子ROC曲线很不错是因为跟负类 非5 相比， 正类 数据5 数量真的很少<h3 id="训练随机森林分类器，比较SGD分类器的ROC曲线和ROC-AUC分数"><a href="#训练随机森林分类器，比较SGD分类器的ROC曲线和ROC-AUC分数" class="headerlink" title="训练随机森林分类器，比较SGD分类器的ROC曲线和ROC AUC分数"></a>训练随机森林分类器，比较SGD分类器的ROC曲线和ROC AUC分数</h3></li>
<li>获取训练集中每个实例的分数</li>
<li>RandomForestClassifier 没有decision_function(),但是拥有dict_proda()方法，sklearn中分类器都有这两个中的一个 -&gt; decision_function()可以获得每一个实力的决策值，和阀值进行对比，如果决策值大于阀值则是正类</li>
<li>dict_proda返回一个矩阵，矩阵的个数和实例相对应，每行一个实例，每列代表一个类别的概率，比如这个图片 70%是5<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line">forest_clf = RandomForestClassifier(n_estimators=<span class="number">10</span>, random_state=<span class="number">42</span>) </span><br><span class="line">y_probas_forest = cross_val_predict(forest_clf, X_train, y_train_5, cv=<span class="number">3</span>,</span><br><span class="line">                                    method=<span class="string">"predict_proba"</span>)</span><br><span class="line"><span class="comment"># n_estimators=10 森林使用了十棵树</span></span><br><span class="line"><span class="comment"># cross_val_predict 交叉验证</span></span><br><span class="line">y_probas_forest</span><br></pre></td></tr></table></figure>
拿到分类的概率<br>array([[0.2, 0.8],【负类，正类】<pre><code>[1. , 0. ],
[1. , 0. ],
…,
[0.8, 0.2],
[1. , 0. ],
[0.2, 0.8]])</code></pre>绘制ROC曲线，需要决策值不是概率，直接使用正类的概率作为决策值：<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">y_scores_forest = y_probas_forest[:, <span class="number">1</span>] <span class="comment"># 取所有的行，取第二列</span></span><br><span class="line">fpr_forest, tpr_forest, thresholds_forest =roc_curve(y_train_5,y_scores_forest)</span><br><span class="line"><span class="comment"># 用roc_curve 获得所有的值</span></span><br><span class="line"><span class="comment"># array([0.8, 0. , 0. , ..., 0.2, 0. , 0.8])</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">plt.plot(fpr, tpr, <span class="string">"b:"</span>, linewidth=<span class="number">2</span>, label=<span class="string">"SGD"</span>)</span><br><span class="line">plot_roc_curve(fpr_forest, tpr_forest, <span class="string">"Random Forest"</span>)</span><br><span class="line">plt.legend(loc=<span class="string">"lower right"</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<img src="/esept/esept.github/%E6%9C%AA%E7%9F%A5.png" alt><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Rand 比SGD 好很多，ROC AUC的分数也高很多</span></span><br><span class="line">roc_auc_score(y_train_5, y_scores_forest)</span><br><span class="line"><span class="comment"># 0.9927612311885732</span></span><br><span class="line"><span class="comment"># 再看一下 精度和召回率 也很高</span></span><br><span class="line">y_train_pred_forest = cross_val_predict(forest_clf, X_train, y_train_5, cv=<span class="number">3</span>)</span><br><span class="line">precision_score(y_train_5, y_train_pred_forest)</span><br><span class="line"><span class="comment"># 0.9842243645924628</span></span><br><span class="line">recall_score(y_train_5, y_train_pred_forest)</span><br><span class="line"><span class="comment"># 0.8286294041689725</span></span><br></pre></td></tr></table></figure>
总结：</li>
<li>选择合适的指标利用交叉验证来对分类器进行评估</li>
<li>选择满足需求的精度/召回率权衡</li>
<li>使用ROC曲线和ROC AUC分数比较多个模型<h2 id="多类别分类器"><a href="#多类别分类器" class="headerlink" title="多类别分类器"></a>多类别分类器</h2></li>
<li>尝试5 之外的检测</li>
<li>多类别分类器 区分 <del>两个以上的类别</del></li>
<li>随机森里和朴素贝叶斯可以直接处理多个类别</li>
<li>支持向量机svm和线性分类器(SGD)只可以处理二元分类器<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3></li>
</ul>
<ol>
<li>将数字图片分类0到9，训练10个二元分类器，每个数字一个，检测一张图片时，获取每个分类器的决策分数，哪个最高属于哪个，称为一对多OvA</li>
<li>为每一对数字训练一个二元分类器，区分0，1 区分0，2 区分1，2 称为一对一OvO策略，存在N个类别，需要N*（N-1）/2个分类器，最后看哪个类别获胜最多</li>
<li>利用二元分类器的变换使他支持多元分类器<h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3></li>
</ol>
<ul>
<li>OvO 只需要用到部分训练集对其必须区分两个类别进行训练</li>
<li>对于较小训练集合OvO比较有优势， 大训练集合 OvA 速度快，所以OvA更常用，比如svm 在数据规模扩大时表现糟糕</li>
<li>sklearn 检查到使用二元分类算法进行多类别分类任务，会自动运行OvA，SVM分类器除外<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 线性二元分类器</span></span><br><span class="line">sgd_clf.fit(X_train, y_train)</span><br><span class="line">sgd_clf.predict([some_digit])</span><br><span class="line"><span class="comment"># array([5.])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 内部实际上训练了10个二元分类器，获得图片的决策分数，然后选择了分数最高的类别</span></span><br><span class="line"><span class="comment"># 返回10个分数，每个类别1个 </span></span><br><span class="line">some_digit_scores = sgd_clf.decision_function([some_digit])</span><br><span class="line">some_digit_scores</span><br></pre></td></tr></table></figure>
<blockquote>
<p>array([[-130925.47994863, -489285.03329748, -233335.03268504,  </p>
<pre><code>-301491.01792999, -504430.31349679,   42217.83953346,  
-709294.90235509, -246867.76598493, -579820.13951646,  
-562334.49609594]])  </code></pre></blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.argmax(some_digit_scores) <span class="comment"># 拿到训练值中值最大的索引</span></span><br><span class="line"><span class="comment"># 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标类别列表会存储在classes_这个属性中，按值大小排列，</span></span><br><span class="line">sgd_clf.classes_</span><br><span class="line"><span class="comment">#  array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])</span></span><br><span class="line">sgd_clf.classes_[np.argmax(some_digit_scores)]</span><br><span class="line"><span class="comment"># 5.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用OvO策略，一对一或者一对多</span></span><br><span class="line"><span class="keyword">from</span> sklearn.multiclass <span class="keyword">import</span> OneVsOneClassifier</span><br><span class="line">ovo_clf = OneVsOneClassifier(SGDClassifier(max_iter=<span class="number">5</span>, tol=-np.infty, random_state=<span class="number">42</span>))</span><br><span class="line">ovo_clf.fit(X_train, y_train)</span><br><span class="line">ovo_clf.predict([some_digit])</span><br><span class="line"><span class="comment"># array([5.])</span></span><br><span class="line"></span><br><span class="line">len(ovo_clf.estimators_)<span class="comment"># 输出估算器的个数</span></span><br><span class="line"><span class="comment"># 45</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用随机森林</span></span><br><span class="line">forest_clf.fit(X_train, y_train)</span><br><span class="line">forest_clf.predict([some_digit])</span><br><span class="line"><span class="comment"># array([5.])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机森林直接将实例分为多个类别，调用predict_proba()可以获得分类器将每个实例分类为每个类别的概率列表</span></span><br><span class="line">forest_clf.predict_proba([some_digit])</span><br><span class="line"><span class="comment"># array([[0. , 0. , 0. , 0.2, 0. , 0.8, 0. , 0. , 0. , 0. ]]) -&gt; 20%是3，80%是5</span></span><br></pre></td></tr></table></figure>
<h3 id="评估分类器"><a href="#评估分类器" class="headerlink" title="评估分类器"></a>评估分类器</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用交叉验证评估SGD的准确率</span></span><br><span class="line">cross_val_score(sgd_clf, X_train, y_train, cv=<span class="number">3</span>, scoring=<span class="string">"accuracy"</span>)</span><br><span class="line"><span class="comment"># array([0.84433113, 0.86754338, 0.86507976]) 运用SGD预测有85%以上的正确率</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将输入进行简单缩放 ，可以得到准确率 90 %以上</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train_scaled = scaler.fit_transform(X_train.astype(np.float64))</span><br><span class="line">cross_val_score(sgd_clf, X_train_scaled, y_train, cv=<span class="number">3</span>, scoring=<span class="string">"accuracy"</span>)</span><br><span class="line"><span class="comment"># array([0.91076785, 0.90694535, 0.90883633]) 经过简单缩放的优化之后可以将正确率踢伤到90%左右</span></span><br></pre></td></tr></table></figure>
<h3 id="错误分析"><a href="#错误分析" class="headerlink" title="错误分析"></a>错误分析</h3><h4 id="项目流程"><a href="#项目流程" class="headerlink" title="项目流程"></a>项目流程</h4></li>
</ul>
<ol>
<li>探索数据准备的选项</li>
<li>尝试多个模型</li>
<li>选择最佳模型并用GridSearchCV对参数进行微调</li>
<li>尽可能自动化<h4 id="确定了一个相对合适的模型，进一步优化，分析其错误类型"><a href="#确定了一个相对合适的模型，进一步优化，分析其错误类型" class="headerlink" title="确定了一个相对合适的模型，进一步优化，分析其错误类型"></a>确定了一个相对合适的模型，进一步优化，分析其错误类型</h4></li>
</ol>
<ul>
<li>查看混淆矩阵</li>
<li>使用cross_val_predict()进行预测</li>
<li>调用confusion_matrix()</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">y_train_pred = cross_val_predict(sgd_clf, X_train_scaled, y_train, cv=<span class="number">3</span>) <span class="comment"># 返回一个预测类型/标签</span></span><br><span class="line">conf_mx = confusion_matrix(y_train, y_train_pred) <span class="comment">#通过实际标签和预测标签运用confusion_matrix形成混淆矩阵</span></span><br><span class="line">conf_mx</span><br></pre></td></tr></table></figure>
<p>混淆矩阵（10维）<br>最好的混淆矩阵为对角线的值最大，其余值都为0，那么下面的混淆矩阵的对角线值是正确的，其余的都不是很正确</p>
<blockquote>
<p>array([[5727,    3,   19,    9,    9,   53,   52,    9,   37,    5],<br>       [   2, 6483,   44,   36,    6,   44,    9,   12,   96,   10],<br>       [  54,   40, 5308,  102,   87,   27,  106,   56,  163,   15],<br>       [  53,   39,  137, 5343,    4,  229,   37,   59,  137,   93],<br>       [  22,   30,   35,    9, 5357,   11,   59,   29,   83,  207],<br>       [  82,   46,   34,  189,   67, 4592,  110,   28,  171,  102],<br>       [  34,   23,   41,    1,   40,   90, 5635,    7,   47,    0],<br>       [  24,   23,   67,   24,   51,   13,    7, 5778,   15,  263],<br>       [  49,  158,   66,  159,   14,  163,   58,   24, 5014,  146],<br>       [  42,   32,   27,   92,  154,   27,    3,  202,   76, 5294]])  </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用matplotlib的matshow 函数来查看混淆矩阵的图像表示</span></span><br><span class="line">plt.matshow(conf_mx, cmap = plt.cm.gray) <span class="comment"># [混淆矩阵，颜色域]</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/esept/esept.github/%E6%9C%AA%E7%9F%A5.png" alt><br>除对角线的值过小，对角线过大因此除对角线的都为黑色，根据坐标可以推断出标签的值，比如左上角就是0，<br>横向 -&gt; 实例  纵向 -&gt; 预测值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 看起来不错，大多数图片都在主对角线上，说明它们被正确分类</span></span><br><span class="line"><span class="comment"># 数字5 看起来比较暗，说明1. 数字5图片较少  2. 分类器在数字5上执行效果不如其他数字上好</span></span><br><span class="line"><span class="comment"># 假设把焦点放在错误上，为取得错误率，而不是错误绝对值，需要将混淆矩阵中每个值除以相应类别中的图片数量</span></span><br><span class="line"></span><br><span class="line">row_sums = conf_mx.sum(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line">norm_conf_mx = conf_mx / row_sums</span><br><span class="line"><span class="comment"># 用0填充对角线 只保留错误，重新绘制</span></span><br><span class="line">np.fill_diagonal(norm_conf_mx, <span class="number">0</span>)</span><br><span class="line">plt.matshow(norm_conf_mx, cmap=plt.cm.gray)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/esept/esept.github/%E6%9C%AA%E7%9F%A5.png" alt></p>
<ul>
<li>每行代表实际类别，每列代表预测类别</li>
<li>8，9列比较亮，说明许多图片被错误的分类为数字8，9</li>
<li>类别8，9行也偏亮，说明数字8和9经常会跟其他数字混淆</li>
<li>有些很暗，比如行1，大多数数字1都被正确的分类，一些和8混淆</li>
<li>5和3是错误最多的</li>
</ul>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>数据分析与数据挖掘</tag>
        <tag>Jupyter Notebook</tag>
        <tag>numpy</tag>
        <tag>Pandas</tag>
        <tag>sklearn</tag>
      </tags>
  </entry>
  <entry>
    <title>他是诗人</title>
    <url>/2020/05/08/doc/</url>
    <content><![CDATA[<p>他曾说 我爱你<br>就像叶爱飘零 风爱游荡<br>他曾禁锢在个人世界<br>无人读懂 欢喜惆怅<br> <a id="more"></a></p>
<p>让岁月抚平忧伤<br>年华换成怅惘<br>星空月夜伴随凄凉<br>独自扼杀希望</p>
<p>谁说诗人习惯独自流浪<br>只不过从未找到过家的方向<br>他在尝试抚平心灵创伤<br>用诗来抒发梦想</p>
<p>他也曾尝过爱情<br>决绝 苦涩 需要勇气<br>他不许任何人亵渎这经历<br>就像他人亵渎自己</p>
<p>他早迷失在混乱世界<br>等待爱人将他救起<br>他却说我是诗人<br>悲伤才是对的记忆</p>
<p>他在等人帮他抹去泪水<br>等人填补空洞心伤<br>诗人强撑着精神病体<br>说着自由 理应继续彷徨</p>
<p>现在的我向往自由与孤独<br>现在的我甘愿流浪<br>诗人不停地大声吟唱<br>天空的雨滴浸透出点点荒凉</p>
<p>诗人的梦里有他想要的一切<br>却不知从何记起<br>他在夜里悲伤的哭泣<br>谁又见过他的无助模样</p>
<p>他还在用低沉的声音吟唱<br>唱出对世界无尽的失望<br>海阔天空和万丈悬崖其实一样<br>都会抛下久违的梦想</p>
<p>诗人披着月光<br>低吟清唱着他的忧伤<br>他说坚强一点<br>就像月光不惧朝阳</p>
<p>他在慢慢游荡<br>渐渐走向陌生的远方<br>他也不想背井离乡<br>只因这里过分凄凉</p>
<p>其实诗人早就死亡<br>只剩他的躯体被迫流浪<br>他的灵魂灰飞烟灭<br>却无人惋惜他的坚强</p>
<p>你是否曾望见过诗人的孤寂背影<br>就像月光才是最柔美的光芒<br>人们不知是否该去祭奠<br>来安抚孤魂的游荡带来的离殇</p>
<p>固执的他 说 我是诗人<br>怎敢以流泪缓解悲伤<br>他说我喜欢孤身一人 只身迎接<br>坎坷路途上的天堂</p>
]]></content>
      <categories>
        <category>思考与遐想</category>
      </categories>
      <tags>
        <tag>采集忘却</tag>
      </tags>
  </entry>
  <entry>
    <title>Java_First</title>
    <url>/2020/06/27/java/</url>
    <content><![CDATA[<p>从新学+整理笔记<br>Java基础</p>
<a id="more"></a>

<h2 id="Java概述"><a href="#Java概述" class="headerlink" title="Java概述"></a>Java概述</h2><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>面向对象，简单易学</li>
<li>跨平台性，一次编译处处运行【JVM】</li>
<li>适合分布式项目：大型的互联网分布式项目</li>
</ul>
<h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><ul>
<li>JavaSE 标准版 - 主要</li>
<li>JavaME 微型版 - 移动端，基本淘汰</li>
<li>JavaEE 企业版 - 企业级应用技术开发</li>
</ul>
<h2 id="Java运行环境"><a href="#Java运行环境" class="headerlink" title="Java运行环境"></a>Java运行环境</h2><p>JDK：java开发工具</p>
<ul>
<li>JRE<ul>
<li>JVM： 在内存里创建一个java虚拟机，java程序载入jvm后运行</li>
<li>java核心类库： java在运行的过程中需要依赖一些库文件 </li>
</ul>
</li>
<li>Java开发工具包</li>
</ul>
<blockquote>
<p>可以直接安装JDK</p>
</blockquote>
<h3 id="程序实例"><a href="#程序实例" class="headerlink" title="程序实例"></a>程序实例</h3><p>文件名：helloworld.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helloworld</span></span>&#123;</span><br><span class="line">	<span class="comment">// 程序的执行入口</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123; </span><br><span class="line">		System.out.println(<span class="string">"hello world"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在终端中<br><code>$ javac helloworld.java</code><br>生成.class文件，如果没有出现检查java文件是否为空<br>class文件出现后<br><code>$ java helloworld</code></p>
<h3 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h3><p>文件名字和类名要一致<br>类名的首字母要大写<br>在类里写方法</p>
<h2 id="Java的运行机制"><a href="#Java的运行机制" class="headerlink" title="Java的运行机制"></a>Java的运行机制</h2><p>创建java文件（helloworld.java）<br>    javac<br>自解码文件（helloworld.class）<br>    java<br>jvm运行</p>
<h2 id="java的数据类型"><a href="#java的数据类型" class="headerlink" title="java的数据类型"></a>java的数据类型</h2><ul>
<li>基本数据类型（8种）<br>  ·· 数值类型<pre><code>- 整数类型
    · 字节类型 byte
    · 短整型 short
    · 整型 int
    · 长整型 long
- 小数类型
    · 单精度 float
    · 双精度 double</code></pre>  ·· 布尔类型 boolean<br>  ·· 字符类型 char</li>
<li>引用数据类型<blockquote>
<p><a href="https://blog.csdn.net/zy_remarkable/article/details/80616037?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/zy_remarkable/article/details/80616037?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase</a></p>
</blockquote>
</li>
</ul>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><h4 id="自动类型转换"><a href="#自动类型转换" class="headerlink" title="自动类型转换"></a>自动类型转换</h4><ol>
<li>所有的type、short、char值运算的时候都会提升成int类型（char-&gt;ascii)</li>
<li>int,long,float,double 自身来计算的时候，类型超出范围不会自动转换，如果超出范围了就会出现精度的损失</li>
<li>int + float = float；double <blockquote>
<p>Java在变量赋值的时候，其中float、double、long数据类型变量，需要在赋值直接量后面分别添加f或F、d或D、l或L尾缀来说明。<br>其中，long类型最好以大写L来添加尾缀，因为小写l容易和数字1混淆。<br><a href="https://blog.csdn.net/FX677588/article/details/52663805" target="_blank" rel="noopener">https://blog.csdn.net/FX677588/article/details/52663805</a></p>
</blockquote>
</li>
</ol>
<h4 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h4><ol>
<li>小数转整数，会把小数点后去掉(float-&gt;int)</li>
<li>char 与 int相互转换都是与Ascii相关的</li>
</ol>
<h3 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h3><p>与 &amp; (如果使用&amp;&amp;，则前面的能决定计算结果的时候后一个就不继续进行计算)<br>或 |<br>非 !=<br>双逻辑运算符可以达到短路效果</p>
<h3 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h3><p>boolean-exp ? value0:value1</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">ternary</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> i&lt;<span class="number">10</span> ? i*<span class="number">100</span>:i*<span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(ternary(<span class="number">9</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">out:</span><br><span class="line"><span class="number">900</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Jupyter notebook 基础</title>
    <url>/2020/05/15/jupyternotebook/</url>
    <content><![CDATA[<p>数据科学原理与数据处理第一节<br>Jupyter Notebook的基础使用</p>
<a id="more"></a>


<h1 id="Jupyter-环境安装与运行"><a href="#Jupyter-环境安装与运行" class="headerlink" title="Jupyter 环境安装与运行"></a>Jupyter 环境安装与运行</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>pip install jupyter</p>
<h2 id="打开Jupyter"><a href="#打开Jupyter" class="headerlink" title="打开Jupyter"></a>打开Jupyter</h2><p>cd ‘想建立jupyter文件的地址’</p>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>在添加好地址后输入 ‘juputer notebook’ 即可</p>
<h2 id="运行Jupyter里的代码"><a href="#运行Jupyter里的代码" class="headerlink" title="运行Jupyter里的代码"></a>运行Jupyter里的代码</h2><p>在所在代码行点击shift+enter</p>
<h1 id="Jupyter-魔法命令"><a href="#Jupyter-魔法命令" class="headerlink" title="Jupyter 魔法命令"></a>Jupyter 魔法命令</h1><p>魔法命令必须在开头，不能有注释</p>
<h2 id="run-文件名"><a href="#run-文件名" class="headerlink" title="%run ./文件名"></a>%run ./文件名</h2><p>运行文件夹下的文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt; my_test.py</span><br><span class="line">print(<span class="string">'hello world'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%run ./my_test.py</span><br><span class="line"><span class="comment">#################</span></span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>
<h2 id="load-加载一个函数"><a href="#load-加载一个函数" class="headerlink" title="%load 加载一个函数"></a>%load 加载一个函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt; my_test.py</span><br><span class="line">print(<span class="string">'hello world'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_print</span><span class="params">(x)</span>:</span></span><br><span class="line">	print(x)</span><br></pre></td></tr></table></figure>
<p>再重新执行生成语句，如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># %load ./my_test.py</span></span><br><span class="line">print(<span class="string">'hello world'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_print</span><span class="params">(x)</span>:</span></span><br><span class="line">	print(x)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">my_print(<span class="number">1</span>)</span><br><span class="line"><span class="comment">###########</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>倒入文件的另一种方式</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> my_test <span class="keyword">import</span> my_print</span><br></pre></td></tr></table></figure>
<blockquote>
<p>notebook 只会针对同一文件导入一次，如果在倒入后又重新更改，需要用%run来从新加载一遍，以便达到更新的作用</p>
</blockquote>
<h2 id="timeit-查看代码执行时间"><a href="#timeit-查看代码执行时间" class="headerlink" title="%timeit 查看代码执行时间"></a>%timeit 查看代码执行时间</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 列表生成式</span></span><br><span class="line">%timeit li = [i **<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>)]</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">228</span> µs ± <span class="number">4.31</span> µs per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000</span> loops each) 运行<span class="number">1000</span>次的平均值</span><br><span class="line"></span><br><span class="line">%timeit li = [i **<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000000</span>)]</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">246</span> ms ± <span class="number">2.91</span> ms per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1</span> loop each) 一次的值</span><br></pre></td></tr></table></figure>

<p>%timeit 只能测试一行代码，如果想测试代码块，则运用 <b>%%timeit</b></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%%timeit</span><br><span class="line">li = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    li.append(i**<span class="number">2</span>)</span><br><span class="line">&gt; <span class="number">267</span> µs ± <span class="number">4.03</span> µs per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000</span> loops each)</span><br><span class="line"><span class="comment"># 在python中，使用列表生成式比for更高效</span></span><br></pre></td></tr></table></figure>
<h2 id="time-测量一次代码执行的时间"><a href="#time-测量一次代码执行的时间" class="headerlink" title="%time  测量一次代码执行的时间"></a>%time  测量一次代码执行的时间</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%time li = [i **<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000000</span>)]</span><br><span class="line"></span><br><span class="line">&gt; CPU times: user <span class="number">238</span> ms, sys: <span class="number">10</span> ms, total: <span class="number">248</span> ms Wall time: <span class="number">247</span> ms</span><br><span class="line"></span><br><span class="line">%%time</span><br><span class="line">li = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    li.append(i**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">&gt; CPU times: user <span class="number">8.62</span> ms, sys: <span class="number">3.61</span> ms, total: <span class="number">12.2</span> ms</span><br><span class="line">Wall time: <span class="number">12.2</span> ms</span><br></pre></td></tr></table></figure>

<h2 id="html"><a href="#html" class="headerlink" title="%%html"></a>%%html</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%%html</span><br><span class="line">&lt;div calss = 'mytest'&gt; html content &lt;/div&gt;</span><br><span class="line"><span class="comment">##</span></span><br><span class="line">&gt; html content</span><br></pre></td></tr></table></figure>

<h2 id="writefile"><a href="#writefile" class="headerlink" title="%%writefile"></a>%%writefile</h2><p>写入文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">%%writefile haha.py</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">li = [random.random() <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>)]</span><br><span class="line">%timeit li.sort()</span><br></pre></td></tr></table></figure>










]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>数据分析与数据挖掘</tag>
        <tag>Jupyter Notebook</tag>
      </tags>
  </entry>
  <entry>
    <title>Scrapy原理及个人项目</title>
    <url>/2020/06/13/douban/</url>
    <content><![CDATA[<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>scrapy engine 核心</p>
<p>##spiders 文件-爬虫文件<br>对下载器传回的响应response进行处理，<br>-spider middleware 基本不会用到</p>
<a id="more"></a>
<h2 id="scheduler-调度器"><a href="#scheduler-调度器" class="headerlink" title="scheduler 调度器"></a>scheduler 调度器</h2><p>所有的request都会交给调度器，调度器统一分配后交给下载器，然后<br>指纹去重 去掉重复的url请求</p>
<h2 id="item-pipeline"><a href="#item-pipeline" class="headerlink" title="item pipeline"></a>item pipeline</h2><p>进行io存储的包 在spider的到响应后将html文件写入本地</p>
<h2 id="downloader"><a href="#downloader" class="headerlink" title="downloader"></a>downloader</h2><p>从调度器得到请求后，下载器向服务器发送请求，得到响应 （整合URL队列），下载器的得到响应之后再交给spider<br>–downloader middleware比较常用  对request进行封装，再交给downloader 或 对response进行封装，再交给spider<br>可以在其中加入user-agent、代理IP</p>
<h1 id="项目名称："><a href="#项目名称：" class="headerlink" title="项目名称："></a>项目名称：</h1><h2 id="scrapy-爬取-豆瓣-TOP250-并存入-execl"><a href="#scrapy-爬取-豆瓣-TOP250-并存入-execl" class="headerlink" title="scrapy 爬取 豆瓣 TOP250 并存入 execl"></a>scrapy 爬取 豆瓣 TOP250 并存入 execl</h2><h3 id="spider-py"><a href="#spider-py" class="headerlink" title="spider.py"></a>spider.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubanSpiderSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'douban_spider'</span></span><br><span class="line">    allowed_domains = [<span class="string">'douban.com'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">250</span>,<span class="number">25</span>):</span><br><span class="line">            print(page)</span><br><span class="line">            url = <span class="string">'https://movie.douban.com/top250?start=%s&amp;filter='</span> % (page)</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">                url = url,</span><br><span class="line">                callback=self.parse2</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse2</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        href_s = response.xpath(<span class="string">'//div[@class="article"]/ol/li/div/div[@class="info"]/div/a/@href'</span>).extract()</span><br><span class="line">        <span class="keyword">for</span> href <span class="keyword">in</span> href_s:</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">                url = href,</span><br><span class="line">                callback=self.parse</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        classment = response.xpath(<span class="string">'//div[@id="wrapper"]/div[1]/div/span[1]/text()'</span>).extract()</span><br><span class="line">        comment = response.xpath(<span class="string">'//div[@class="comment"]/p/span[1]/text()'</span>).extract()</span><br><span class="line">        print(response.xpath(<span class="string">'//div[@id="wrapper"]/div/h1/span/text()'</span>).extract())</span><br><span class="line">        item = dict(</span><br><span class="line">            title =response.xpath(<span class="string">'//div[@id="wrapper"]/div/h1/span/text()'</span>).extract(),</span><br><span class="line">            score = response.xpath(<span class="string">'//strong[@class="ll rating_num"]/text()'</span>).extract(),</span><br><span class="line">            classment = classment,</span><br><span class="line">            comment = comment</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">yield</span> item</span><br></pre></td></tr></table></figure>


<h3 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define your item pipelines here</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span></span><br><span class="line"><span class="comment"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook <span class="comment"># 写入excel</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubanPipeline</span>:</span></span><br><span class="line">    wb = Workbook()</span><br><span class="line">    ws = wb.active</span><br><span class="line">    ws.append([<span class="string">'classment'</span>,<span class="string">'title'</span>,<span class="string">'score'</span>,<span class="string">'comment'</span>])</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self,item,spider)</span>:</span></span><br><span class="line">        line = [item[<span class="string">'classment'</span>][<span class="number">0</span>],item[<span class="string">'title'</span>][<span class="number">0</span>],item[<span class="string">'score'</span>][<span class="number">0</span>],item[<span class="string">'comment'</span>][<span class="number">0</span>]]</span><br><span class="line">        self.ws.append(line)</span><br><span class="line">        self.wb.save(<span class="string">'douban.xlsx'</span>)</span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>


<h3 id="item"><a href="#item" class="headerlink" title="item"></a>item</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define here the models for your scraped items</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># See documentation in:</span></span><br><span class="line"><span class="comment"># https://docs.scrapy.org/en/latest/topics/items.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubanItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    <span class="comment"># name = scrapy.Field()</span></span><br><span class="line">    title = scrapy.Field()</span><br><span class="line">    score = scrapy.Field()</span><br><span class="line">    classment = scrapy.Field()</span><br><span class="line">    comment = scrapy.Field()</span><br></pre></td></tr></table></figure>

<h1 id="项目名称"><a href="#项目名称" class="headerlink" title="项目名称"></a>项目名称</h1><h2 id="51job的爬取"><a href="#51job的爬取" class="headerlink" title="51job的爬取"></a>51job的爬取</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> scrapy.spiders <span class="keyword">import</span> CrawlSpider</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> copy <span class="keyword">as</span> deepcopy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A51jobSpider</span><span class="params">(CrawlSpider)</span>:</span></span><br><span class="line">    name = <span class="string">'51job'</span></span><br><span class="line">    allowed_domains = [<span class="string">'search.51job.com'</span>]</span><br><span class="line">    key_word = <span class="string">'java'</span></span><br><span class="line">    <span class="comment"># start_urls = ['http://51job.com/']</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># for page in pages:</span></span><br><span class="line">        url = <span class="string">'https://search.51job.com/list/070300,000000,0000,00,9,99,%s'</span> \</span><br><span class="line">              <span class="string">',2,1.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare='</span>%(self.key_word)</span><br><span class="line">        <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">            url = url,</span><br><span class="line">            callback=self.parse</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        pages =response.xpath(<span class="string">'//div[@class="p_in"]/input/@value'</span>).extract_first()</span><br><span class="line">        print(pages)</span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> range(<span class="number">1</span>,int(pages)+<span class="number">1</span>):</span><br><span class="line">            url = <span class="string">'https://search.51job.com/list/070300,000000,0000,00,9,99,%s,2,%s.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare='</span> % (self.key_word,page)</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">                url=url,</span><br><span class="line">                callback=self.parse_page1</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_page1</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        content_list_x_s = response.xpath(<span class="string">'//div[@class ="dw_table"]/div[@class="el"]'</span>)</span><br><span class="line">        <span class="keyword">for</span> content_list_x <span class="keyword">in</span> content_list_x_s:</span><br><span class="line">            job_name = content_list_x.xpath(<span class="string">'normalize-space(./p/span[1]/a/text())'</span>).extract_first()</span><br><span class="line">            entre_name = content_list_x.xpath(<span class="string">'./span[@class="t2"]/a/text()'</span>).extract_first()</span><br><span class="line">            location = content_list_x.xpath(<span class="string">'./span[@class="t3"]/text()'</span>).extract_first()</span><br><span class="line">            salarie = content_list_x.xpath(<span class="string">'./span[@class="t4"]/text()'</span>).extract_first()</span><br><span class="line">            date = content_list_x.xpath(<span class="string">'./span[@class="t5"]/text()'</span>).extract_first()</span><br><span class="line">            print(job_name,entre_name,location,salarie,date)</span><br><span class="line">            item = dict(</span><br><span class="line">                job_name = job_name,</span><br><span class="line">                entre_name = entre_name,</span><br><span class="line">                location = location,</span><br><span class="line">                salarie = salarie,</span><br><span class="line">                date = date</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">yield</span> item</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define here the models for your scraped items</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># See documentation in:</span></span><br><span class="line"><span class="comment"># https://docs.scrapy.org/en/latest/topics/items.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JobItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    job_name = scrapy.Field()</span><br><span class="line">    entre_name =scrapy.Field()</span><br><span class="line">    location = scrapy.Field()</span><br><span class="line">    salarie = scrapy.Field()</span><br><span class="line">    date = scrapy.Field()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define your item pipelines here</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span></span><br><span class="line"><span class="comment"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JobPipeline</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.mysql_conn = pymysql.Connection(</span><br><span class="line">            host= <span class="string">'localhost'</span>,</span><br><span class="line">            port = <span class="number">3306</span>,</span><br><span class="line">            user = <span class="string">'root'</span>,</span><br><span class="line">            password = <span class="string">'126511'</span>,</span><br><span class="line">            database = <span class="string">'51job'</span>,</span><br><span class="line">            charset = <span class="string">'utf8'</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self,item,spider)</span>:</span></span><br><span class="line">        cs = self.mysql_conn.cursor()</span><br><span class="line"></span><br><span class="line">        sql_column = <span class="string">','</span>.join([key <span class="keyword">for</span> key <span class="keyword">in</span> item.keys()])</span><br><span class="line">        sql_value = <span class="string">','</span>.join([<span class="string">'"%s"'</span>% item[key] <span class="keyword">for</span> key <span class="keyword">in</span> item.keys()])</span><br><span class="line"></span><br><span class="line">        sql_str = <span class="string">'insert into t_job (%s) value (%s);'</span> %(sql_column,sql_value)</span><br><span class="line">        <span class="comment"># print(sql_str)</span></span><br><span class="line">        cs.execute(sql_str)</span><br><span class="line">        self.mysql_conn.commit()</span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title>Java_方法与数组</title>
    <url>/2020/06/30/java_%E6%96%B9%E6%B3%95%E4%B8%8E%E6%95%B0%E7%BB%84/</url>
    <content><![CDATA[<p>方法与数组</p>
<a id="more"></a>
<p><code>sout</code> -&gt; 输出快捷方式 -&gt;<code>System.out.println();</code></p>
<p>#方法</p>
<h2 id="定义一个方法的格式"><a href="#定义一个方法的格式" class="headerlink" title="定义一个方法的格式"></a>定义一个方法的格式</h2><p><code>pvsm</code> 创建方法快捷方式<code>public static void main(String[] args) {}</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">name</span><span class="params">(方法名称)</span><span class="params">()</span></span>&#123;</span><br><span class="line">	SS;(方法体x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">	name();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1- 方法的定义不能产生嵌套关系<br>2- 方法定义好之后需要调用来让他执行</p>
<h2 id="方法的重载"><a href="#方法的重载" class="headerlink" title="方法的重载"></a>方法的重载</h2><p>多个方法的名称一样，但是参数列表不一样<br>相关：<br>参数个数不同/参数类型不同/参数的多类型顺序不同<br>无关：<br>与参数名称无关/与参数返回值无关</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo01MethodDefine</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(sum(<span class="number">11</span>,<span class="number">22</span>,<span class="number">4</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(sum(<span class="number">11</span>,<span class="number">22</span>,<span class="number">4</span>));</span><br><span class="line">        System.out.println(sum(<span class="number">11</span>,<span class="number">22</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b+c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b+c+d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"><span class="number">40</span></span><br><span class="line"><span class="number">37</span></span><br><span class="line"><span class="number">33</span></span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>数组是一种引用数据类型<br>数组当中的多个数据，类型必须统一<br>数组的长度在程序运行期间不能改变</p>
<h2 id="数组的初始化："><a href="#数组的初始化：" class="headerlink" title="数组的初始化："></a>数组的初始化：</h2><p>在内存中创建一个数组，并向其中赋予一些默认值<br>动态初始化：指定长度</p>
<h3 id="动态初始化数组的格式："><a href="#动态初始化数组的格式：" class="headerlink" title="动态初始化数组的格式："></a>动态初始化数组的格式：</h3><p><code>数据类型[] 数组名称 = new 数据类型[数组长度]</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arrayA = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">300</span>];</span><br><span class="line"><span class="keyword">double</span>[] arrayB = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">10</span>];</span><br><span class="line">String[] arrayC = <span class="keyword">new</span> String[<span class="number">5</span>];</span><br></pre></td></tr></table></figure>
<p>左侧数据类型，代表数组中保存的数据，全是统一的什么类型<br>【】-&gt; 表示这是一个数组<br>数组名称-&gt; 数组的名字<br>&lt;=&gt;<br>new 代表创建数组的动作<br>数据类型： 必须和左边的数据类型保持一致<br>中括号的长度： 数组中保存的数据个数，是一个int数字</p>
<h3 id="静态初始化：指定内容-直接将具体的数据内容进行指定"><a href="#静态初始化：指定内容-直接将具体的数据内容进行指定" class="headerlink" title="静态初始化：指定内容:直接将具体的数据内容进行指定"></a>静态初始化：指定内容:直接将具体的数据内容进行指定</h3><p><code>数据类型[] 数组名称 = new 数据类型[] {元素1,元素2···}</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arrayD = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">5</span>,<span class="number">15</span>,<span class="number">25</span>&#125;;</span><br><span class="line">String[] arrayE = <span class="keyword">new</span> String[]&#123;<span class="string">"hello"</span>,<span class="string">"world"</span>,<span class="string">"Java"</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>使用静态初始化数组的时候，格式还可以在省略一下：可以省略’new 数据类型[]’</p>
<h2 id="初始化的拆分"><a href="#初始化的拆分" class="headerlink" title="初始化的拆分"></a>初始化的拆分</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arrayB ;</span><br><span class="line">arrayB = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">11</span>,<span class="number">21</span>,<span class="number">41</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span>[] arrayc;</span><br><span class="line">arrayc = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">5</span>];</span><br></pre></td></tr></table></figure>
<h2 id="访问数组元素"><a href="#访问数组元素" class="headerlink" title="访问数组元素"></a>访问数组元素</h2><p>直接打印数组名称得到的是数组对应的内存地址哈希值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">shuzu</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] array = &#123;<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>&#125;;</span><br><span class="line">        System.out.println(array); <span class="comment">// out:[I@5b2133b1</span></span><br><span class="line">        System.out.println(array[<span class="number">0</span>]); <span class="comment">// out: 10</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] arrayA = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">        System.out.println(arrayA[<span class="number">0</span>]); <span class="comment">//out:0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">out:</span><br><span class="line">[I@<span class="number">5</span>b2133b1</span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<h2 id="访问数组的格式："><a href="#访问数组的格式：" class="headerlink" title="访问数组的格式："></a>访问数组的格式：</h2><p>数组名称[索引值]</p>
<p>在使用动态初始化数组的时候，其中的元素都会自动有一个默认值<br>int：0<br>float：0.0<br>字符类型：‘\u0000’<br>布尔类型：false<br>如果是引用类型：null</p>
<blockquote>
<p><a href="https://blog.csdn.net/zy_remarkable/article/details/80616037?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/zy_remarkable/article/details/80616037?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-5.nonecase</a><br>(引用类型)</p>
</blockquote>
<h3 id="java的内存需要划分成五个部分"><a href="#java的内存需要划分成五个部分" class="headerlink" title="java的内存需要划分成五个部分"></a>java的内存需要划分成五个部分</h3><p><strong>栈（stack）</strong>:存放的都是方法中的局部变量<br>    局部变量：方法的参数，或是方法{}内部的变量<br>    作用域：一旦超出作用域，立刻从栈内存中消失<br><strong>堆（heap）</strong>: 凡事new出来的东西，都在堆当中<br>    堆内存里面的东西都有一个地址值：16进制<br>    堆内存里面的数据都有默认值<br>    整数：0<br>    浮点数：0.0<br>    字符类型：‘\u0000’<br>    布尔类型：false<br>    如果是引用类型：null<br><strong>方法区(Method Area)</strong>:存储.class相关信息，包含方法的信息</p>
<p>本地方法栈(Native Method Stack)<br>寄存器(pc Resister)</p>
<h3 id="ArrayIndexOutOfBoundsException-数组索引越界异常"><a href="#ArrayIndexOutOfBoundsException-数组索引越界异常" class="headerlink" title="ArrayIndexOutOfBoundsException-数组索引越界异常"></a>ArrayIndexOutOfBoundsException-数组索引越界异常</h3><p>原因：索引编号错误<br>解决：修改为存在的正确索引编号</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int[] array &#x3D; null;</span><br><span class="line">System.out.println(array[0]);</span><br></pre></td></tr></table></figure>

<h3 id="NullPointerException-空指针异常"><a href="#NullPointerException-空指针异常" class="headerlink" title="NullPointerException-空指针异常"></a>NullPointerException-空指针异常</h3><p>只赋值了一个null，没有用new进行创建<br>原因：忘了new<br>解决：补上new</p>
<h3 id="获取数组长度"><a href="#获取数组长度" class="headerlink" title="获取数组长度"></a>获取数组长度</h3><p><code>数组名称.length</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span>[] arrayA = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> len = arrayA.length;</span><br><span class="line">System.out.println(len);</span><br><span class="line">out:</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="数组的遍历"><a href="#数组的遍历" class="headerlink" title="数组的遍历"></a>数组的遍历</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span>[] array = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;<span class="comment">//array.fori</span></span><br><span class="line">    System.out.println(array[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组的倒序"><a href="#数组的倒序" class="headerlink" title="数组的倒序"></a>数组的倒序</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">        System.out.println(array[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">"===================="</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> min = <span class="number">0</span>,max = array.length-<span class="number">1</span>;min&lt;max;min++,max--)&#123;</span><br><span class="line">        <span class="keyword">int</span> temp = array[min];</span><br><span class="line">        array[min] = array[max];</span><br><span class="line">        array[max] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">        System.out.println(array[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">···························································</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] array = &#123;<span class="number">10</span>,<span class="number">66</span>,<span class="number">434</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">235</span>,<span class="number">645</span>,<span class="number">34</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            System.out.println(array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] arrayTemp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            arrayTemp[i] = array[i];</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"==========================="</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            array[i] = arrayTemp[array.length-<span class="number">1</span>-i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            System.out.println(array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="小练习"><a href="#小练习" class="headerlink" title="小练习"></a>小练习</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayReturn</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        printArray(cal(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">int</span>[] array)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            System.out.println(array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] cal(<span class="keyword">int</span> a,<span class="keyword">int</span> b, <span class="keyword">int</span> c)&#123; <span class="comment">//数组-类模型</span></span><br><span class="line">        <span class="keyword">int</span> sum = a+b+c;</span><br><span class="line">        <span class="keyword">int</span> avg = sum/<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">int</span>[] newArray = &#123;sum,avg&#125;;</span><br><span class="line">        <span class="keyword">return</span> newArray;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>


















]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Scrapy-Redis分布式爬虫</title>
    <url>/2020/05/14/scrapy-redis/</url>
    <content><![CDATA[<p>修改scrapy-爬虫里的文件，使项目成为scrapy-redis爬虫项目<br>【redis】-【scrapy】-【爬虫】-【pyhton】</p>
<a id="more"></a>

<h1 id="Redis基础介绍"><a href="#Redis基础介绍" class="headerlink" title="Redis基础介绍"></a>Redis基础介绍</h1><h2 id="Redis-的数据库结构"><a href="#Redis-的数据库结构" class="headerlink" title="Redis 的数据库结构"></a>Redis 的数据库结构</h2><ol>
<li>Redis中有16个数据库db(0) ~ db(15)<br>开启Redis后默认使用db(0)<br>非关系型数据库，所有数据都堆积在一起</li>
<li>切换数据库：<br>select 【index】<br>例如：切换到db1 </li>
</ol>
<blockquote>
<p>select 1<br>3. 终端里<br>$ redis-cli<br>显示端口号：‘27.0.0.1:6379&gt; ’<br>select 1<br>select 0</p>
</blockquote>
<h2 id="Redis的数据类型"><a href="#Redis的数据类型" class="headerlink" title="Redis的数据类型"></a>Redis的数据类型</h2><p>后续上传文件</p>
<h2 id="pycharm-配置"><a href="#pycharm-配置" class="headerlink" title="pycharm 配置"></a>pycharm 配置</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">redis_conn = redis.StrictRedis(</span><br><span class="line">    host = <span class="string">'localhost'</span>,</span><br><span class="line">    port = <span class="number">6379</span>,</span><br><span class="line">    password=<span class="string">''</span>,</span><br><span class="line">    decode_responses = <span class="literal">True</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="运行redis命令"><a href="#运行redis命令" class="headerlink" title="运行redis命令"></a>运行redis命令</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">ret = redis_conn.execute_command(<span class="string">'keys *'</span>)</span><br><span class="line">print(ret)</span><br><span class="line">print(type(ret))</span><br><span class="line">redis_conn.execute_command(<span class="string">'set k1 v1'</span>)</span><br><span class="line">print(ret)</span><br><span class="line"><span class="comment">######################################</span></span><br><span class="line">[<span class="string">'k3'</span>, <span class="string">'k1'</span>, <span class="string">'k5'</span>, <span class="string">'k2'</span>]</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></span><br><span class="line">['k3', 'k1', 'k5', 'k2']</span><br></pre></td></tr></table></figure>

<h1 id="Scrapy-redis"><a href="#Scrapy-redis" class="headerlink" title="Scrapy-redis"></a>Scrapy-redis</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>pip install scrapy-redis</p>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>多个爬虫项目爬取一个网站<br>多台计算机配合爬取一个网站</p>
<p>scrapy-redis 组建实现分布式爬虫<br>不是一种框架，是一个拓展使scrapy可以完成分布式爬虫</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>在scrapy项目中的settings加入下列代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动Scrapy-Redis去重过滤器，取消Scrapy的去重功能</span></span><br><span class="line">DUPEFILTER_CLASS = <span class="string">"scrapy_redis.dupefilter.RFPDupeFilter"</span></span><br><span class="line"><span class="comment"># 启用Scrapy-Redis的调度器，取消Scrapy的调度器</span></span><br><span class="line">SCHEDULER = <span class="string">"scrapy_redis.scheduler.Scheduler"</span></span><br><span class="line"><span class="comment"># Scrapy-Redis断点续爬</span></span><br><span class="line">SCHEDULER_PERSIST = <span class="literal">True</span></span><br><span class="line"><span class="comment"># 配置Redis数据库的连接</span></span><br><span class="line">REDIS_URL = <span class="string">'redis://127.0.0.1:6379'</span></span><br></pre></td></tr></table></figure>
<p>在这行代码中，需要不断访问代理IP</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">request.meta[<span class="string">'proxy'</span>] = <span class="string">'http://'</span> + ur.urlopen(<span class="string">'http://api.ip.data5u.com/dynamic/get.html?order=d314e5e5e19b0dfd19762f98308114ba&amp;sep=3'</span>).read().decode(<span class="string">'utf-8'</span>).strip() <span class="comment"># 设置代理</span></span><br></pre></td></tr></table></figure>

<h2 id="proxypool-py"><a href="#proxypool-py" class="headerlink" title="proxypool.py"></a>proxypool.py</h2><p>在项目文件夹（非spider）下建立proxypool.py</p>
<ol>
<li>倒入模块<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> urllib.request <span class="keyword">as</span> ur</span><br><span class="line"><span class="keyword">import</span> time</span><br></pre></td></tr></table></figure></li>
<li>定义Proxypool类并定义两个方法<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyPool</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.redis_conn = redis.StrictRedis(</span><br><span class="line">            host=<span class="string">'localhost'</span>,</span><br><span class="line">            port = <span class="number">6379</span>,</span><br><span class="line">            decode_responses=<span class="literal">True</span>,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_proxy</span><span class="params">(self)</span>:</span></span><br><span class="line">    	proxy_new = ur.urlopen(<span class="string">'http://api.ip.data5u.com/dynamic/get.html?order=d314e5e5e19b0dfd19762f98308114ba&amp;sep=4'</span>).read().decode(<span class="string">'utf-8'</span>).strip().split(<span class="string">' '</span>)</span><br><span class="line">    	print(proxy)</span><br><span class="line">        <span class="comment"># while True:# 不断循环获取链接</span></span><br><span class="line">        <span class="comment">#     proxy_new = ur.urlopen('http://api.ip.data5u.com/dynamic/get.html?order=d314e5e5e19b0dfd19762f98308114ba&amp;sep=4').read().decode('utf-8').strip().split(' ')# strip：去掉首位空格，split：用空格隔开</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_proxy</span><span class="params">(self)</span>:</span></span><br><span class="line">     	<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    ProxyPool().set_proxy()</span><br></pre></td></tr></table></figure>
<p>此时运行main，会获取到两个被打印的代理IP</p>
<h2 id="更换代理IP地址-得到"><a href="#更换代理IP地址-得到" class="headerlink" title="更换代理IP地址(得到)"></a>更换代理IP地址(得到)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_proxy</span><span class="params">(self)</span>:</span></span><br><span class="line">	proxy_odd = <span class="literal">None</span> <span class="comment"># 旧的代理IP地址</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	    proxy_new = ur.urlopen(<span class="string">'代理IP地址'</span>).read().decode(<span class="string">'utf-8'</span>).strip().split(<span class="string">' '</span>) <span class="comment"># 获取的新的代理IP地址</span></span><br><span class="line">	    <span class="keyword">if</span> proxy_new != proxy_odd: <span class="comment"># 如果心就的代理IP不同</span></span><br><span class="line">	    	proxy_odd = proxy_new <span class="comment"># 将新的代理IP赋值给旧的代理IP</span></span><br><span class="line">	        self.redis_conn.delete(<span class="string">'proxy'</span>) <span class="comment"># 删除链接对象里‘proxy’这个键的值</span></span><br><span class="line">	        self.redis_conn.sadd(<span class="string">'proxy'</span>,*proxy_new) <span class="comment"># 向‘proxy’这个键中添加两个代理IP地址（刚刚获取到的），这里相当于执行了两次添加</span></span><br><span class="line">	        time.sleep(<span class="number">2</span>) <span class="comment"># 睡眠</span></span><br><span class="line">	    <span class="keyword">else</span>:</span><br><span class="line">	        time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="设置代理IP地址"><a href="#设置代理IP地址" class="headerlink" title="设置代理IP地址"></a>设置代理IP地址</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyPool</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_proxy</span><span class="params">(self)</span>:</span></span><br><span class="line">	    ret = self.redis_conn.scandmember(<span class="string">'proxy'</span>,<span class="number">1</span>) <span class="comment">#得到代理IP</span></span><br><span class="line">	    print(ret) <span class="comment"># </span></span><br><span class="line">	    print(type(ret)) <span class="comment"># list对象，列表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># ProxyPool().set_proxy()</span></span><br><span class="line">    ProxyPool().get_proxy()</span><br></pre></td></tr></table></figure>
<p>在这种情况下可能出现的问题是，在set-proxy运行到’delete‘时，得到的代理IP的值为空，因此要加入一个判断，在代理IP的值为空的情况下需要进行的操作</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyPool</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_proxy</span><span class="params">(self)</span>:</span></span><br><span class="line">        proxy_s = self.redis_conn.scandmember(<span class="string">'proxy'</span>,<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># print(ret)</span></span><br><span class="line">        <span class="comment"># print(type(ret))</span></span><br><span class="line">        <span class="keyword">if</span> proxy_s: <span class="comment"># 如果proxy—s的值不为空</span></span><br><span class="line">            <span class="keyword">return</span> proxy_s[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># 如果为空</span></span><br><span class="line">            time.sleep(<span class="number">0.1</span>) <span class="comment"># 延时0.1s</span></span><br><span class="line">            <span class="keyword">return</span> self.get_proxy() <span class="comment"># 调用自己</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># ProxyPool().set_proxy()</span></span><br><span class="line">    ProxyPool().get_proxy()</span><br></pre></td></tr></table></figure>
<p>之后开启main方法</p>
<h2 id="修改middlewares"><a href="#修改middlewares" class="headerlink" title="修改middlewares"></a>修改middlewares</h2><p>倒入包</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> zhaobiao.proxypool <span class="keyword">import</span> ProxyPool</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZhaobiaoDownloaderMiddleware</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span> <span class="comment"># 实例化init 对象</span></span><br><span class="line">        self.proxyPool = ProxyPool() </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_request</span><span class="params">(self, request, spider)</span>:</span></span><br><span class="line">        <span class="comment"># request.meta['proxy'] = 'http://' + ur.urlopen('http://api.ip.data5u.com/dynamic/get.html?order=d314e5e5e19b0dfd19762f98308114ba&amp;sep=3').read().decode('utf-8').strip() # 设置代理</span></span><br><span class="line">        request.meta[<span class="string">'proxy'</span>] = <span class="string">'http://'</span> + self.proxyPool.get_proxy()</span><br><span class="line">        print(request.meta[<span class="string">'proxy'</span>])</span><br></pre></td></tr></table></figure>


<h1 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h1><p>之后就可以既在pycharm中开启项目，也可以在terminal中开启项目</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>redis</tag>
        <tag>爬虫</tag>
      </tags>
  </entry>
  <entry>
    <title>博客更新日志</title>
    <url>/2020/06/26/%E5%8D%9A%E5%AE%A2%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/</url>
    <content><![CDATA[<p>用于更新博客格式/小改动的日志</p>
<a id="more"></a>

<p>6-27<br>更新了网站logo</p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>numpy</title>
    <url>/2020/05/17/numpy/</url>
    <content><![CDATA[<p>numpy的安装及基础操作<br>针对数组和矩阵</p>
<a id="more"></a>
<h1 id="安装与倒入"><a href="#安装与倒入" class="headerlink" title="安装与倒入"></a>安装与倒入</h1><p>pip install numpy<br>import numpy as np</p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>numpy是一种数组，本质是ndarray</p>
<h2 id="Python-list"><a href="#Python-list" class="headerlink" title="Python list"></a>Python list</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">li = list(range(<span class="number">10</span>))</span><br><span class="line">li</span><br><span class="line"></span><br><span class="line">&gt; [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">li[<span class="number">5</span>] = <span class="string">'hello python'</span></span><br><span class="line">li</span><br><span class="line">&gt; [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="string">'hello python'</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure>
<p>list 的类型是不确定的，也可以将其中的一个元素修改成字符串<br>list很灵活，但因为可以存储各种数据，因此很不灵活，在处理大型数据时效率很低</p>
<h2 id="Python-array"><a href="#Python-array" class="headerlink" title="Python array"></a>Python array</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> array</span><br><span class="line">arr = array.array(<span class="string">'i'</span>,list(range(<span class="number">10</span>))) <span class="comment"># ‘i'-&gt;类型为正数</span></span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<p>在修改其中数据的时候，如果将其中的数据修改类型则会出现报错</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">arr[<span class="number">5</span>] = <span class="string">'hello python'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError     Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-8</span>-b1067373fade&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">----&gt; 1 arr[5] = 'hello python'</span><br><span class="line"></span><br><span class="line">TypeError: an integer <span class="keyword">is</span> required (got type str)</span><br></pre></td></tr></table></figure>
<p>如果列表示多维的，那么他们之间的计算就会不方便</p>
<h2 id="numpy-ndarray"><a href="#numpy-ndarray" class="headerlink" title="numpy.ndarray"></a>numpy.ndarray</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">nparr = np.array(list(range(<span class="number">10</span>)))</span><br><span class="line">nparr</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">type(nparr)</span><br><span class="line"></span><br><span class="line">&gt; numpy.ndarray</span><br><span class="line"></span><br><span class="line">nparr.dtype <span class="comment">#每个元素的类型</span></span><br><span class="line"></span><br><span class="line">&gt; dtype(<span class="string">'int64'</span>)</span><br><span class="line"></span><br><span class="line">nparr[<span class="number">3</span>] = <span class="number">33</span> <span class="comment"># 修改</span></span><br><span class="line">nparr</span><br><span class="line"></span><br><span class="line">&gt; array([ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">33</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">nparr[<span class="number">3</span>] <span class="comment"># 访问</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="number">33</span></span><br><span class="line"></span><br><span class="line">nparr[<span class="number">3</span>] = <span class="string">'hello python'</span></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">ValueError            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-16</span><span class="number">-27473</span>c2d595f&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">----&gt; 1 nparr[3] = 'hello python'</span><br><span class="line">ValueError: invalid literal <span class="keyword">for</span> int() <span class="keyword">with</span> base <span class="number">10</span>: <span class="string">'hello python'</span></span><br><span class="line"></span><br><span class="line">nparr[<span class="number">5</span>] = <span class="number">55.23</span> <span class="comment">#整数类型的ndarray，会忽略小数</span></span><br><span class="line">nparr <span class="comment"># 去掉小数</span></span><br><span class="line"></span><br><span class="line">&gt; array([ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">33</span>,  <span class="number">4</span>, <span class="number">55</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">nparray2 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3.0</span>])</span><br><span class="line">nparray2.dtype</span><br><span class="line"></span><br><span class="line">&gt; dtype(<span class="string">'float64'</span>)</span><br><span class="line"></span><br><span class="line">nparr3 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],dtype = float) <span class="comment"># 定义类型</span></span><br><span class="line">nparr3</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>])</span><br></pre></td></tr></table></figure>
<ol>
<li>方便处理多维度数组或者矩阵之间的运算</li>
<li>在处理多维数组或者矩阵，运算效率高<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">python_test</span><span class="params">(n)</span>:</span></span><br><span class="line">    a = [i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">    b = [i**<span class="number">3</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        c.append(a[i]+b[i])</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">python_test(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"> &gt; [<span class="number">0</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">36</span>, <span class="number">80</span>, <span class="number">150</span>, <span class="number">252</span>, <span class="number">392</span>, <span class="number">576</span>, <span class="number">810</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">numpy_test</span><span class="params">(n)</span>:</span></span><br><span class="line">    a = np.arange(n) ** <span class="number">2</span></span><br><span class="line">    b = np.arange(n) ** <span class="number">3</span></span><br><span class="line">    c = a + b</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">numpy_test(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([  <span class="number">0</span>,   <span class="number">2</span>,  <span class="number">12</span>,  <span class="number">36</span>,  <span class="number">80</span>, <span class="number">150</span>, <span class="number">252</span>, <span class="number">392</span>, <span class="number">576</span>, <span class="number">810</span>])</span><br><span class="line"></span><br><span class="line">time res = python_test(<span class="number">100000000</span>)</span><br><span class="line"></span><br><span class="line">&gt; CPU times: user <span class="number">1</span>min <span class="number">4</span>s, sys: <span class="number">15.5</span> s, total: <span class="number">1</span>min <span class="number">20</span>s</span><br><span class="line">Wall time: <span class="number">1</span>min <span class="number">22</span>s</span><br><span class="line"></span><br><span class="line">%time res = numpy_test(<span class="number">100000000</span>)</span><br><span class="line"></span><br><span class="line">&gt; CPU times: user <span class="number">2.37</span> s, sys: <span class="number">4.3</span> s, total: <span class="number">6.67</span> s</span><br><span class="line">Wall time: <span class="number">6.67</span> s</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="矩阵与随机数的生成"><a href="#矩阵与随机数的生成" class="headerlink" title="矩阵与随机数的生成"></a>矩阵与随机数的生成</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">np.array(range(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">np.arange(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">np.arange(<span class="number">2</span>,<span class="number">20</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([ <span class="number">2</span>,  <span class="number">5</span>,  <span class="number">8</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">17</span>])</span><br><span class="line"></span><br><span class="line">np.arange(<span class="number">2</span>,<span class="number">20</span>,<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line">&gt; Sarray([ <span class="number">2.</span> ,  <span class="number">2.3</span>,  <span class="number">2.6</span>,  <span class="number">2.9</span>,  <span class="number">3.2</span>,  <span class="number">3.5</span>,  <span class="number">3.8</span>,  <span class="number">4.1</span>,  <span class="number">4.4</span>,  <span class="number">4.7</span>,  <span class="number">5.</span> ,</span><br><span class="line">        <span class="number">5.3</span>,  <span class="number">5.6</span>,  <span class="number">5.9</span>,  <span class="number">6.2</span>,  <span class="number">6.5</span>,  <span class="number">6.8</span>,  <span class="number">7.1</span>,  <span class="number">7.4</span>,  <span class="number">7.7</span>,  <span class="number">8.</span> ,  <span class="number">8.3</span>,</span><br><span class="line">        <span class="number">8.6</span>,  <span class="number">8.9</span>,  <span class="number">9.2</span>,  <span class="number">9.5</span>,  <span class="number">9.8</span>, <span class="number">10.1</span>, <span class="number">10.4</span>, <span class="number">10.7</span>, <span class="number">11.</span> , <span class="number">11.3</span>, <span class="number">11.6</span>,</span><br><span class="line">       <span class="number">11.9</span>, <span class="number">12.2</span>, <span class="number">12.5</span>, <span class="number">12.8</span>, <span class="number">13.1</span>, <span class="number">13.4</span>, <span class="number">13.7</span>, <span class="number">14.</span> , <span class="number">14.3</span>, <span class="number">14.6</span>, <span class="number">14.9</span>,</span><br><span class="line">       <span class="number">15.2</span>, <span class="number">15.5</span>, <span class="number">15.8</span>, <span class="number">16.1</span>, <span class="number">16.4</span>, <span class="number">16.7</span>, <span class="number">17.</span> , <span class="number">17.3</span>, <span class="number">17.6</span>, <span class="number">17.9</span>, <span class="number">18.2</span>,</span><br><span class="line">       <span class="number">18.5</span>, <span class="number">18.8</span>, <span class="number">19.1</span>, <span class="number">19.4</span>, <span class="number">19.7</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">np.zeros(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>])</span><br><span class="line"></span><br><span class="line">np.zeros(<span class="number">10</span>,dtype=int)</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">np.zeros(shape=(<span class="number">3</span>,<span class="number">5</span>),dtype=int)</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line">np.ones(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>])</span><br><span class="line"></span><br><span class="line">np.ones(shape=(<span class="number">3</span>,<span class="number">5</span>),dtype=int)</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">         [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">         [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">np.full(<span class="number">10</span>,<span class="number">99</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>])</span><br><span class="line"></span><br><span class="line">np.full((<span class="number">3</span>,<span class="number">5</span>),<span class="number">99</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>],</span><br><span class="line">         [<span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>],</span><br><span class="line">         [<span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等差数列</span></span><br><span class="line">np.linspace(<span class="number">0</span>,<span class="number">20</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt; array([ <span class="number">0.</span>        ,  <span class="number">2.22222222</span>,  <span class="number">4.44444444</span>,  <span class="number">6.66666667</span>,  <span class="number">8.88888889</span>,</span><br><span class="line">       <span class="number">11.11111111</span>, <span class="number">13.33333333</span>, <span class="number">15.55555556</span>, <span class="number">17.77777778</span>, <span class="number">20.</span>        ])</span><br></pre></td></tr></table></figure>
<p>生成随机数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.random.randint(<span class="number">0</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">8</span></span><br><span class="line"></span><br><span class="line">np.random.randint(<span class="number">0</span>,<span class="number">10</span>,size = (<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">8</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"></span><br><span class="line">np.random.randint(<span class="number">0</span>,<span class="number">10</span>,size = (<span class="number">2</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">4</span>],</span><br><span class="line">         [<span class="number">7</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每次得到的值都不同</span></span><br><span class="line">np.random.randint(<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>) </span><br><span class="line"><span class="comment"># 而在加入seed后可在每次得到相同的值</span></span><br><span class="line">np.random.seed(<span class="number">99</span>)</span><br><span class="line">np.random.randint(<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>) </span><br><span class="line"></span><br><span class="line"> &gt; array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment"># 0-1的浮点数随机数</span></span><br><span class="line"> np.random.random()</span><br><span class="line"></span><br><span class="line"><span class="number">0.7010090560320762</span></span><br><span class="line"></span><br><span class="line">np.random.random((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0.1933131</span> , <span class="number">0.97734806</span>, <span class="number">0.57772631</span>, <span class="number">0.51376629</span>],</span><br><span class="line">         [<span class="number">0.85151867</span>, <span class="number">0.38105394</span>, <span class="number">0.27389368</span>, <span class="number">0.64060144</span>],</span><br><span class="line">         [<span class="number">0.49361568</span>, <span class="number">0.33677231</span>, <span class="number">0.61632181</span>, <span class="number">0.36050726</span>]])</span><br></pre></td></tr></table></figure>
<h2 id="ndarray的基础操作"><a href="#ndarray的基础操作" class="headerlink" title="ndarray的基础操作"></a>ndarray的基础操作</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">A = np.ones(shape=(<span class="number">3</span>,<span class="number">5</span>))</span><br><span class="line">A</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">       [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">       [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>]])</span><br><span class="line"></span><br><span class="line">A.ndim <span class="comment"># 维度</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="number">2</span></span><br><span class="line"></span><br><span class="line">A.shape <span class="comment"># 维度具体数值</span></span><br><span class="line"></span><br><span class="line">&gt; (<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">A.size <span class="comment"># 元素个数</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape 修改数组维度</span></span><br><span class="line"></span><br><span class="line">a = np.arange(<span class="number">10</span>)</span><br><span class="line">a</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">x=a.reshape(<span class="number">2</span>,<span class="number">5</span>)</span><br><span class="line">x</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">         [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">a.reshape(<span class="number">2</span>,<span class="number">-1</span>) <span class="comment"># 两行</span></span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">         [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">X=a.reshape(<span class="number">-1</span>,<span class="number">2</span>)</span><br><span class="line">X</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">         [<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">         [<span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">         [<span class="number">6</span>, <span class="number">7</span>],</span><br><span class="line">         [<span class="number">8</span>, <span class="number">9</span>]])</span><br></pre></td></tr></table></figure>

<h2 id="取值操作"><a href="#取值操作" class="headerlink" title="取值操作"></a>取值操作</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">X = np.arange(<span class="number">15</span>).reshape(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">X</span><br><span class="line"></span><br><span class="line">&gt; array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">         [ <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>],</span><br><span class="line">         [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>]])</span><br><span class="line"></span><br><span class="line">X[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">X[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>])</span><br><span class="line"></span><br><span class="line">X[<span class="number">0</span>][<span class="number">1</span>] <span class="comment"># 不推荐</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">X[(<span class="number">0</span>,<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">X[<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h2><h3 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = np.arange(<span class="number">10</span>)</span><br><span class="line">a</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">a[:<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">a[<span class="number">5</span>:]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">a[<span class="number">0</span>:<span class="number">8</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>])</span><br><span class="line"></span><br><span class="line">a[::<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">a[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([<span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<h3 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#前两行前三列</span></span><br><span class="line">X[<span class="number">0</span>:<span class="number">2</span>,<span class="number">0</span>:<span class="number">3</span>] = X[:<span class="number">2</span>,:<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">         [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]])</span><br><span class="line">X[:<span class="number">2</span>,:<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">         [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]])</span><br><span class="line"></span><br><span class="line">X[:<span class="number">2</span>][:<span class="number">3</span>]<span class="comment"># 前两行-&gt; 前三行</span></span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">         [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">X[:<span class="number">2</span>,::<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>],</span><br><span class="line">         [<span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">X[::<span class="number">-1</span>,::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">&gt; array([[<span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">10</span>],</span><br><span class="line">         [ <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">7</span>,  <span class="number">6</span>,  <span class="number">5</span>],</span><br><span class="line">         [ <span class="number">4</span>,  <span class="number">3</span>,  <span class="number">2</span>,  <span class="number">1</span>,  <span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line">X.T</span><br><span class="line"></span><br><span class="line">&gt; array([[ <span class="number">0</span>,  <span class="number">5</span>, <span class="number">10</span>],</span><br><span class="line">         [ <span class="number">1</span>,  <span class="number">6</span>, <span class="number">11</span>],</span><br><span class="line">         [ <span class="number">2</span>,  <span class="number">7</span>, <span class="number">12</span>],</span><br><span class="line">         [ <span class="number">3</span>,  <span class="number">8</span>, <span class="number">13</span>],</span><br><span class="line">         [ <span class="number">4</span>,  <span class="number">9</span>, <span class="number">14</span>]])</span><br></pre></td></tr></table></figure>


<h3 id="矩阵的合并"><a href="#矩阵的合并" class="headerlink" title="矩阵的合并"></a>矩阵的合并</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x1 = np.array([[<span class="number">22</span>,<span class="number">168</span>],</span><br><span class="line">              [<span class="number">18</span>,<span class="number">187</span>]])</span><br><span class="line">x2 = np.array([[<span class="number">0</span>],</span><br><span class="line">               [<span class="number">1</span>]])</span><br><span class="line">x = np.concatenate([x1,x2],axis = <span class="number">1</span>)</span><br><span class="line">x</span><br><span class="line"></span><br><span class="line">array([[ <span class="number">22</span>, <span class="number">168</span>,   <span class="number">0</span>],</span><br><span class="line">       [ <span class="number">18</span>, <span class="number">187</span>,   <span class="number">1</span>]])</span><br></pre></td></tr></table></figure>
<h3 id="聚合操作"><a href="#聚合操作" class="headerlink" title="聚合操作"></a>聚合操作</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">x = np.arange(<span class="number">15</span>).reshape(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">x</span><br><span class="line"></span><br><span class="line">&gt; array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">       [ <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>],</span><br><span class="line">       [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>]])</span><br><span class="line"></span><br><span class="line">np.sum(x)</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">105</span></span><br><span class="line"></span><br><span class="line">np.max(x)</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">14</span></span><br><span class="line"></span><br><span class="line">np.min(x)</span><br><span class="line"></span><br><span class="line">&gt; <span class="number">0</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>数据分析与数据挖掘</tag>
        <tag>Jupyter Notebook</tag>
        <tag>numpy</tag>
      </tags>
  </entry>
  <entry>
    <title>matplotlib</title>
    <url>/2020/05/19/matplotlib/</url>
    <content><![CDATA[<h1 id="Matplotlib-安装"><a href="#Matplotlib-安装" class="headerlink" title="Matplotlib 安装"></a>Matplotlib 安装</h1><h1 id="Matplotlib-绘制散点图"><a href="#Matplotlib-绘制散点图" class="headerlink" title="Matplotlib 绘制散点图"></a>Matplotlib 绘制散点图</h1><h1 id="Matplotlib-绘制折线图"><a href="#Matplotlib-绘制折线图" class="headerlink" title="Matplotlib 绘制折线图"></a>Matplotlib 绘制折线图</h1><h1 id="Matplotlib-绘制柱状图和饼状图"><a href="#Matplotlib-绘制柱状图和饼状图" class="headerlink" title="Matplotlib 绘制柱状图和饼状图"></a>Matplotlib 绘制柱状图和饼状图</h1><h1 id="Matplotlib-绘制直方图和箱线图"><a href="#Matplotlib-绘制直方图和箱线图" class="headerlink" title="Matplotlib 绘制直方图和箱线图"></a>Matplotlib 绘制直方图和箱线图</h1><h1 id="Matplotlib-绘制子图"><a href="#Matplotlib-绘制子图" class="headerlink" title="Matplotlib 绘制子图"></a>Matplotlib 绘制子图</h1><h1 id="pandas中绘制图表"><a href="#pandas中绘制图表" class="headerlink" title="pandas中绘制图表"></a>pandas中绘制图表</h1>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>数据分析与数据挖掘</tag>
        <tag>Jupyter Notebook</tag>
        <tag>numpy</tag>
        <tag>Pandas</tag>
        <tag>matplotlib</tag>
      </tags>
  </entry>
  <entry>
    <title>大多数的我</title>
    <url>/2020/05/06/%E5%A4%A7%E5%A4%9A%E6%95%B0%E7%9A%84%E6%88%91/</url>
    <content><![CDATA[<p>少数的我<br>梦见了故乡</p>
<a id="more"></a>
<p>从未回去那里的魂魄<br>抢夺去了风中<br>应见泪水相拥的画面<br>战乱连年<br>仅有的雨也成了雪<br>融入这暴戾的暖炉<br>痛不知思绪的去向<br>只能肆意地游荡在躯体<br>千万之一相见的几率<br>释怀于死前<br>无言的喧寂<br>大多数的我<br>梦不见故乡<br>身处于不知何方 无可奈何<br>指引的信号刻画于手臂<br>感官隐于黑暗<br>轻道  恭喜</p>
]]></content>
      <categories>
        <category>思考与遐想</category>
      </categories>
      <tags>
        <tag>采集忘却</tag>
      </tags>
  </entry>
  <entry>
    <title>服务器日志分析</title>
    <url>/2020/05/20/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>如果我想你</title>
    <url>/2020/05/08/%E5%A6%82%E6%9E%9C%E6%88%91%E6%83%B3%E4%BD%A0/</url>
    <content><![CDATA[<p>愿你能从他身上听到你想听的话<br>单调却挂念的话<br>有没有一些<br>来自我这个人渣</p>
<a id="more"></a>
<p>记忆的沙 霜冻的画<br>故乡的花已经发芽<br>牵着希望的手悄然滑下<br>我还是怀念我残破的家<br>音乐盒的主人公默念牵挂<br>没有你的口信<br>我不敢安家<br>你还留着我寄存的味道吗<br>书写下的话 让天空散漫着花<br>那景象是我从未见过的<br>我想问你可知爱字如何落下<br>却无法否认那是我从未见过的回答</p>
]]></content>
      <categories>
        <category>思考与遐想</category>
      </categories>
      <tags>
        <tag>采集忘却</tag>
      </tags>
  </entry>
  <entry>
    <title>爬虫项目1</title>
    <url>/2020/05/13/%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE1/</url>
    <content><![CDATA[<p>通过在老师带领下操作了爬虫项目爬取csdn的热门博客，希望自己可以试着去爬取bilibili上某一up主的视频题目</p>
<a id="more"></a>

<h1 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h1><h2 id="获取网页内容"><a href="#获取网页内容" class="headerlink" title="获取网页内容"></a>获取网页内容</h2><p>首先，由于是直接找某一up的视频，所以网站解析页可以为他的主页</p>
<blockquote>
<p>https: //space.bilibili.com/</p>
</blockquote>
<p>在主页中，选择选项中的“视频”，可以获得一个新的网址</p>
<blockquote>
<p>https: //space.bilibili.com/99157282/video</p>
</blockquote>
<p>为了寻找到不同页数时所使用的不同网址，因此点击第二、三页得到另一个网址</p>
<blockquote>
<p>https: //space.bilibili.com/99157282/video?tid=0&amp;page=2&amp;keyword=&amp;order=pubdate<br>https: //space.bilibili.com/99157282/video?tid=0&amp;page=3&amp;keyword=&amp;order=pubdate<br>通过对比可以发现在不同页面只有【page=2】更改，因此可以了解到不同页面的区别只是需要更改page的数字即可</p>
</blockquote>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>爬虫</tag>
        <tag>个人项目</tag>
      </tags>
  </entry>
  <entry>
    <title>Scrapy爬虫</title>
    <url>/2020/05/13/%E7%88%AC%E8%99%AB/</url>
    <content><![CDATA[<p>python-scrapy学习中所做的爬取某一招标网站的内容<br>【scrapy】-【爬虫】-【pyhton】</p>
<a id="more"></a>

<h1 id="模拟请求头与代理IP"><a href="#模拟请求头与代理IP" class="headerlink" title="模拟请求头与代理IP"></a>模拟请求头与代理IP</h1><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><ol>
<li>找到目标文件夹</li>
<li>创建项目  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ scrapy startproject &#39;ProjectName&#39;</span><br><span class="line">$ cd &#39;ProjectName&#39;</span><br><span class="line">$ scrapy genspider &#39;Name&#39; &quot;网站域名&quot;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="配置Setting"><a href="#配置Setting" class="headerlink" title="配置Setting"></a>配置Setting</h2><ol>
<li><p>关闭Robot协议</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ROBOTSTXT_OBEY = <span class="literal">False</span></span><br></pre></td></tr></table></figure></li>
<li><p>开启Download_Delay</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DOWNLOAD_DELAY = <span class="number">3</span></span><br></pre></td></tr></table></figure></li>
<li><p>设置默认请求头</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DEFAULT_REQUEST_HEADERS = &#123;</span><br><span class="line">  <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span>,</span><br><span class="line">  <span class="string">'Accept-Language'</span>: <span class="string">'en'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>开启下载中间件与管道文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DOWNLOADER_MIDDLEWARES = &#123;</span><br><span class="line">   <span class="string">'zhaobiao.middlewares.ZhaobiaoDownloaderMiddleware'</span>: <span class="number">543</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">   <span class="string">'zhaobiao.pipelines.ZhaobiaoPipeline'</span>: <span class="number">300</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>设置请求头 Cookie和User-Agent</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DEFAULT_REQUEST_HEADERS = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36'</span>,</span><br><span class="line">    <span class="string">'Cookie'</span>:<span class="string">'登陆后的cookie'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Spiders-项目文件"><a href="#Spiders-项目文件" class="headerlink" title="Spiders/项目文件"></a>Spiders/项目文件</h2><h3 id="设置存储的数据格式"><a href="#设置存储的数据格式" class="headerlink" title="设置存储的数据格式"></a>设置存储的数据格式</h3><p>即爬虫项目里需要爬取的内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sql_data = dict(</span><br><span class="line">      projectcode=<span class="string">''</span>,  <span class="comment"># 项目编号</span></span><br><span class="line">      web=<span class="string">''</span>,  <span class="comment"># 信息来源网站</span></span><br><span class="line">      keyword=<span class="string">''</span>,  <span class="comment"># 关键字</span></span><br><span class="line">      detail_url=<span class="string">''</span>,  <span class="comment"># 招标详细页网址</span></span><br><span class="line">      title=<span class="string">''</span>,  <span class="comment"># 第三方网站发布标题</span></span><br><span class="line">      toptype=<span class="string">''</span>,  <span class="comment"># 信息类型</span></span><br><span class="line">      province=<span class="string">''</span>,  <span class="comment"># 归属省份</span></span><br><span class="line">      product=<span class="string">''</span>,  <span class="comment"># 产品范畴</span></span><br><span class="line">      industry=<span class="string">''</span>,  <span class="comment"># 归属行业</span></span><br><span class="line">      tendering_manner=<span class="string">''</span>,  <span class="comment"># 招标方式</span></span><br><span class="line">      publicity_date=<span class="string">''</span>,  <span class="comment"># 招标公示日期</span></span><br><span class="line">      expiry_date=<span class="string">''</span>,  <span class="comment"># 招标截止时间</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>

<h3 id="设置Form表单的数据格式"><a href="#设置Form表单的数据格式" class="headerlink" title="设置Form表单的数据格式"></a>设置Form表单的数据格式</h3><p>即从网站可以获取的数据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">form_data = dict(</span><br><span class="line">       infoClassCodes=<span class="string">''</span>,</span><br><span class="line">       rangeType=<span class="string">''</span>,</span><br><span class="line">       projectType=<span class="string">'bid'</span>,</span><br><span class="line">       fundSourceCodes=<span class="string">''</span>,</span><br><span class="line">       dateType=<span class="string">''</span>,</span><br><span class="line">       startDateCode=<span class="string">''</span>,</span><br><span class="line">       endDateCode=<span class="string">''</span>,</span><br><span class="line">       normIndustry=<span class="string">''</span>,</span><br><span class="line">       normIndustryName=<span class="string">''</span>,</span><br><span class="line">       zone=<span class="string">''</span>,</span><br><span class="line">       zoneName=<span class="string">''</span>,</span><br><span class="line">       zoneText=<span class="string">''</span>,</span><br><span class="line">       key=<span class="string">''</span>,  <span class="comment"># 搜索的关键字</span></span><br><span class="line">       pubDateType=<span class="string">''</span>,</span><br><span class="line">       pubDateBegin=<span class="string">''</span>,</span><br><span class="line">       pubDateEnd=<span class="string">''</span>,</span><br><span class="line">       sortMethod=<span class="string">'timeDesc'</span>,</span><br><span class="line">       orgName=<span class="string">''</span>,</span><br><span class="line">       currentPage=<span class="string">''</span>,  <span class="comment"># 当前页码</span></span><br><span class="line">   )</span><br></pre></td></tr></table></figure>
<h3 id="定义start-requests-self"><a href="#定义start-requests-self" class="headerlink" title="定义start_requests(self)"></a>定义start_requests(self)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span></span><br><span class="line"></span><br><span class="line">    form_data = self.form_data</span><br><span class="line">    form_data[<span class="string">'key'</span>] = <span class="string">'路由器'</span></span><br><span class="line">    form_data[<span class="string">'currentPage'</span>] = <span class="string">'2'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">yield</span> scrapy.FormRequest( <span class="comment"># 对FormRequest的封装，可以提交表单数据</span></span><br><span class="line">        url = <span class="string">'http://ss.ebnew.com/tradingSearch/index.htm'</span>,</span><br><span class="line">        formdata= form_data,<span class="comment"># 传递字典对象</span></span><br><span class="line">        callback=self.parse_page1,<span class="comment"># 定义回调函数</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_page1</span><span class="params">(self,response)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'2.html'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(response.body) <span class="comment"># 写入到本地</span></span><br></pre></td></tr></table></figure>

<h3 id="创建start文件"><a href="#创建start文件" class="headerlink" title="创建start文件"></a>创建start文件</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> scrapy <span class="keyword">import</span> cmdline</span><br><span class="line"></span><br><span class="line">cmdline.execute(<span class="string">'scrapy crawl bilian'</span>.split())</span><br></pre></td></tr></table></figure>

<h2 id="配置代理ip"><a href="#配置代理ip" class="headerlink" title="配置代理ip"></a>配置代理ip</h2><p>找到middlewares里的class ZhaobiaoDownloaderMiddleware 里的<br>process_request</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 需要倒入包</span></span><br><span class="line"><span class="keyword">import</span> urllib.request <span class="keyword">as</span> ur <span class="comment"># 使用ur.urlopen</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">process_request</span><span class="params">(self, request, spider)</span>:</span></span><br><span class="line">        request.meta[<span class="string">'proxy'</span>] = <span class="string">'http://'</span> + ur.urlopen(<span class="string">'代理IP地址'</span>).read().decode(<span class="string">'utf-8'</span>).strip() <span class="comment"># 设置代理</span></span><br></pre></td></tr></table></figure>
<p>.strip（）去掉首位换行符</p>
<h1 id="页面中的数据过滤提取"><a href="#页面中的数据过滤提取" class="headerlink" title="页面中的数据过滤提取"></a>页面中的数据过滤提取</h1><h2 id="定义parse-page1"><a href="#定义parse-page1" class="headerlink" title="定义parse_page1"></a>定义parse_page1</h2><p>从网页中寻找有需要的信息，并用xpath标记出来</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_page1</span><span class="params">(self,response)</span>:</span></span><br><span class="line">    content_list_x_s = response.xpath(<span class="string">'//div[@class="ebnew-content-list"]/div'</span>)</span><br><span class="line">    <span class="keyword">for</span> content_list_x <span class="keyword">in</span> content_list_x_s:</span><br><span class="line">        toptype = content_list_x.xpath(<span class="string">'./div[1]/i[1]/text()'</span>).extract_first()</span><br><span class="line">        title = content_list_x.xpath(<span class="string">'./div[1]/a[1]/text()'</span>).extract_first()</span><br><span class="line">        publicity_date =content_list_x.xpath(<span class="string">'./div[1]/i[2]/text()'</span>).extract_first()</span><br><span class="line">        <span class="keyword">if</span> publicity_date:</span><br><span class="line">            publicity_date = re.sub(<span class="string">'[^0-9\-]'</span>,<span class="string">''</span>,publicity_date) <span class="comment"># 将发布日期里的文字'发布日期'替换成空字符串的格式</span></span><br><span class="line"></span><br><span class="line">        tendering_manner = content_list_x.xpath(<span class="string">'./div[2]/div[1]/p[1]/span[2]/text()'</span>).extract_first()</span><br><span class="line">        product = content_list_x.xpath(<span class="string">'./div[2]/div[1]/p[2]/span[2]/text()'</span>).extract_first()</span><br><span class="line">        expiry_date = content_list_x.xpath(<span class="string">'./div[2]/div[2]/p[1]/span[2]/text()'</span>).extract_first()</span><br><span class="line">        province = content_list_x.xpath(<span class="string">'./div[2]/div[2]/p[2]/span[2]/text()'</span>).extract_first()</span><br><span class="line">        <span class="comment"># print(toptype,title,publicity_date,tendering_manner,product,expiry_date,province)</span></span><br></pre></td></tr></table></figure>

<h2 id="定义parse-page2"><a href="#定义parse-page2" class="headerlink" title="定义parse_page2"></a>定义parse_page2</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">yield</span> scrapy.Request(</span><br><span class="line">        url = <span class="string">'http://www.ebnew.com/businessShow/645672039.html'</span>,</span><br><span class="line">        callback = self.parse_page(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_page2</span><span class="params">(self,response)</span>:</span></span><br><span class="line">    li_x_s = response.xpath(<span class="string">'//ul[@class="ebnew-project-information pd-t25 pd-b25 pd-l20 clearfix ebnew-border bg-f9 mg-t20 color-444 font-12"]/li'</span>)</span><br><span class="line">    projectcode = li_x_s[<span class="number">0</span>].xpath(<span class="string">'./span[2]/text()'</span>).extract_first()</span><br><span class="line">    industry = li_x_s[<span class="number">7</span>].xpath(<span class="string">'./span[2]/text()'</span>).extract_first()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> projectcode: <span class="comment"># 在没有找到项目编号的情况下使用正则表达式来寻找</span></span><br><span class="line">        projectcode_find = re.findall(<span class="string">'项目编号[：:]&#123;0,1&#125;\s&#123;0,2&#125;([a-zA-Z0-9\-]&#123;10,80&#125;)'</span>,response.body.decode(<span class="string">'utf-8'</span>))</span><br><span class="line">        projectcode = projectcode_find[<span class="number">0</span>] <span class="keyword">if</span> projectcode_find <span class="keyword">else</span> <span class="string">""</span></span><br><span class="line">    <span class="comment"># print(industry,projectcode)</span></span><br></pre></td></tr></table></figure>


<h1 id="异常请求的处理机制"><a href="#异常请求的处理机制" class="headerlink" title="异常请求的处理机制"></a>异常请求的处理机制</h1><p>在setting中加入</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">LOG_FILE= <span class="string">'zhaobiao.log'</span> <span class="comment"># 将错误写入到这个错误文件中</span></span><br><span class="line">LOG_LEVEL = <span class="string">'ERROR'</span> <span class="comment"># 定义错误写入的错误级别</span></span><br></pre></td></tr></table></figure>

<h1 id="请求链的健壮性优化"><a href="#请求链的健壮性优化" class="headerlink" title="请求链的健壮性优化"></a>请求链的健壮性优化</h1><h2 id="首先定义关键字"><a href="#首先定义关键字" class="headerlink" title="首先定义关键字"></a>首先定义关键字</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">keyword_s =[</span><br><span class="line">    <span class="string">'路由器'</span>,<span class="string">'变压器'</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="注释异常请求的处理机制"><a href="#注释异常请求的处理机制" class="headerlink" title="注释异常请求的处理机制"></a>注释异常请求的处理机制</h2><h2 id="一些细小的修改"><a href="#一些细小的修改" class="headerlink" title="一些细小的修改"></a>一些细小的修改</h2><ol>
<li>在allowed_domaine中加入参数，因为start_request中有’<a href="http://ss.ebnew.com/tradingSearch/index.htm&#39;" target="_blank" rel="noopener">http://ss.ebnew.com/tradingSearch/index.htm&#39;</a><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">allowed_domains = [<span class="string">'ebnew'</span>,<span class="string">'ss.ebnew.com'</span>]</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="异步IO实现数据持久化储存"><a href="#异步IO实现数据持久化储存" class="headerlink" title="异步IO实现数据持久化储存"></a>异步IO实现数据持久化储存</h1><h2 id="PyMysql"><a href="#PyMysql" class="headerlink" title="PyMysql"></a>PyMysql</h2><p>连接本地数据库‘pipelines.py’</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql <span class="comment"># 倒入包</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.mysql_conn = pymysql.connections(</span><br><span class="line">            host = <span class="string">'localhost'</span>,</span><br><span class="line">            post=<span class="number">3306</span>,</span><br><span class="line">            user=<span class="string">'root'</span>,</span><br><span class="line">            password = <span class="string">'126511'</span>,</span><br><span class="line">            database=<span class="string">'zhaobiao'</span>,</span><br><span class="line">            charset=<span class="string">'utf8'</span>,</span><br><span class="line"></span><br><span class="line">        )</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> zhaobiao <span class="keyword">charset</span> utf8 <span class="comment"># 创建数据库</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_zhaobiao( <span class="comment"># 创建表格</span></span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    projectcode <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    web <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    keyword <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    detail_url <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    title <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    toptype <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    province <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    product <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    industry <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    tendering_manner <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    publicity_date <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    expiry_date <span class="built_in">varchar</span>(<span class="number">100</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>创建光标对象</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self, item, spider)</span>:</span></span><br><span class="line">      <span class="comment"># 创建光标对象</span></span><br><span class="line">      cs = self.mysql_conn.cursur()</span><br><span class="line">      <span class="comment"># sql_str = 'insert into t_zhaobiao (字段,字段) value ("值","值")'</span></span><br><span class="line">      sql_column = <span class="string">','</span>.join([key <span class="keyword">for</span> key <span class="keyword">in</span> item.keys()])</span><br><span class="line">      sql_value = <span class="string">','</span>.join([<span class="string">'"%s"'</span>% item[key] <span class="keyword">for</span> key <span class="keyword">in</span> item.keys()])</span><br><span class="line">      sql_str = <span class="string">'insert into t_zhaobiao (%s) value (%s);'</span> %(sql_column,sql_value)</span><br><span class="line">      cs.execute(sql_str)</span><br><span class="line"></span><br><span class="line">      self.mysql_conn.commit()</span><br><span class="line">      <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>
<p>代码主体修改及补充</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span> <span class="comment"># 可以跳过allow domaine</span></span><br><span class="line">       <span class="keyword">for</span> keyword <span class="keyword">in</span> self.keyword_s:</span><br><span class="line">           form_data = deepcopy(self.form_data)</span><br><span class="line">           form_data[<span class="string">'key'</span>] = keyword</span><br><span class="line">           form_data[<span class="string">'currentPage'</span>] = <span class="string">'1'</span></span><br><span class="line">           request = scrapy.FormRequest(</span><br><span class="line">               url=<span class="string">'http://ss.ebnew.com/tradingSearch/index.htm'</span>,</span><br><span class="line">               formdata=form_data,</span><br><span class="line">               callback=self.parse_start</span><br><span class="line">           )</span><br><span class="line">           request.meta[<span class="string">'form_data'</span>] = form_data <span class="comment"># 把这个对象保存在request对象的meta里</span></span><br><span class="line">           <span class="keyword">yield</span> request</span><br></pre></td></tr></table></figure>


<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><h2 id="bilian-py"><a href="#bilian-py" class="headerlink" title="bilian.py"></a>bilian.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">import</span> re <span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy <span class="comment"># 深度复制</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BilianSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'bilian'</span></span><br><span class="line">    allowed_domains = [<span class="string">'ebnew'</span>,<span class="string">'ss.ebnew.com'</span>]</span><br><span class="line"></span><br><span class="line">    keyword_s =[</span><br><span class="line">        <span class="string">'路由器'</span>,<span class="string">'变压器'</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># start_urls = ['http://ebnew/']</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># def parse(self, response):</span></span><br><span class="line">    <span class="comment">#     pass</span></span><br><span class="line">    <span class="comment"># 存储的数据格式</span></span><br><span class="line">    sql_data = dict(</span><br><span class="line">        projectcode=<span class="string">''</span>,  <span class="comment"># 项目编号</span></span><br><span class="line">        web=<span class="string">''</span>,  <span class="comment"># 信息来源网站</span></span><br><span class="line">        keyword=<span class="string">''</span>,  <span class="comment"># 关键字</span></span><br><span class="line">        detail_url=<span class="string">''</span>,  <span class="comment"># 招标详细页网址</span></span><br><span class="line">        title=<span class="string">''</span>,  <span class="comment"># 第三方网站发布标题</span></span><br><span class="line">        toptype=<span class="string">''</span>,  <span class="comment"># 信息类型</span></span><br><span class="line">        province=<span class="string">''</span>,  <span class="comment"># 归属省份</span></span><br><span class="line">        product=<span class="string">''</span>,  <span class="comment"># 产品范畴</span></span><br><span class="line">        industry=<span class="string">''</span>,  <span class="comment"># 归属行业</span></span><br><span class="line">        tendering_manner=<span class="string">''</span>,  <span class="comment"># 招标方式</span></span><br><span class="line">        publicity_date=<span class="string">''</span>,  <span class="comment"># 招标公示日期</span></span><br><span class="line">        expiry_date=<span class="string">''</span>,  <span class="comment"># 招标截止时间</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># Form表单的数据格式</span></span><br><span class="line">    form_data = dict(</span><br><span class="line">        infoClassCodes=<span class="string">''</span>,</span><br><span class="line">        rangeType=<span class="string">''</span>,</span><br><span class="line">        projectType=<span class="string">'bid'</span>,</span><br><span class="line">        fundSourceCodes=<span class="string">''</span>,</span><br><span class="line">        dateType=<span class="string">''</span>,</span><br><span class="line">        startDateCode=<span class="string">''</span>,</span><br><span class="line">        endDateCode=<span class="string">''</span>,</span><br><span class="line">        normIndustry=<span class="string">''</span>,</span><br><span class="line">        normIndustryName=<span class="string">''</span>,</span><br><span class="line">        zone=<span class="string">''</span>,</span><br><span class="line">        zoneName=<span class="string">''</span>,</span><br><span class="line">        zoneText=<span class="string">''</span>,</span><br><span class="line">        key=<span class="string">''</span>,  <span class="comment"># 搜索的关键字</span></span><br><span class="line">        pubDateType=<span class="string">''</span>,</span><br><span class="line">        pubDateBegin=<span class="string">''</span>,</span><br><span class="line">        pubDateEnd=<span class="string">''</span>,</span><br><span class="line">        sortMethod=<span class="string">'timeDesc'</span>,</span><br><span class="line">        orgName=<span class="string">''</span>,</span><br><span class="line">        currentPage=<span class="string">''</span>,  <span class="comment"># 当前页码</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_requests</span><span class="params">(self)</span>:</span> <span class="comment"># 可以跳过allow domaine</span></span><br><span class="line">        <span class="keyword">for</span> keyword <span class="keyword">in</span> self.keyword_s:</span><br><span class="line">            form_data = deepcopy(self.form_data)</span><br><span class="line">            form_data[<span class="string">'key'</span>] = keyword</span><br><span class="line">            form_data[<span class="string">'currentPage'</span>] = <span class="string">'1'</span></span><br><span class="line">            request = scrapy.FormRequest(</span><br><span class="line">                url=<span class="string">'http://ss.ebnew.com/tradingSearch/index.htm'</span>,</span><br><span class="line">                formdata=form_data,</span><br><span class="line">                callback=self.parse_start</span><br><span class="line">            )</span><br><span class="line">            request.meta[<span class="string">'form_data'</span>] = form_data <span class="comment"># 把这个对象保存在request对象的meta里</span></span><br><span class="line">            <span class="keyword">yield</span> request</span><br><span class="line"></span><br><span class="line">        <span class="comment"># yield scrapy.Request(</span></span><br><span class="line">        <span class="comment">#     url = 'http://www.ebnew.com/businessShow/645672039.html',</span></span><br><span class="line">        <span class="comment">#     callback = self.parse_page(2)</span></span><br><span class="line">        <span class="comment"># )</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># form_data = self.form_data</span></span><br><span class="line">        <span class="comment"># form_data['key'] = '路由器'</span></span><br><span class="line">        <span class="comment"># form_data['currentPage'] = '2'</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># yield scrapy.FormRequest( # 对FormRequest的封装，可以提交表单数据</span></span><br><span class="line">        <span class="comment">#     url = 'http://ss.ebnew.com/tradingSearch/index.htm',</span></span><br><span class="line">        <span class="comment">#     formdata= form_data,# 传递字典对象</span></span><br><span class="line">        <span class="comment">#     callback=self.parse_page1,# 定义回调函数</span></span><br><span class="line">        <span class="comment"># )</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_start</span><span class="params">(self,response)</span>:</span></span><br><span class="line">        a_text_s = response.xpath(<span class="string">'//form[@id="pagerSubmitForm"]/a/text()'</span>).extract()</span><br><span class="line">        page_max = max(</span><br><span class="line">            [int(a_text) <span class="keyword">for</span> a_text <span class="keyword">in</span> a_text_s <span class="keyword">if</span> re.match(<span class="string">'\d+'</span>,a_text)] <span class="comment"># 都是数字的列表取最大值</span></span><br><span class="line">        )</span><br><span class="line">        page_max = <span class="number">2</span></span><br><span class="line">        self.parse_page1(response) <span class="comment"># parse_start 访问的就是第一页，所以要加这个步骤，在进行其他页码的遍历</span></span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> range(<span class="number">2</span>,page_max+<span class="number">1</span>):</span><br><span class="line">            form_data = deepcopy(response.meta[<span class="string">'form_data'</span>])</span><br><span class="line">            form_data[<span class="string">'currentPage'</span>] = str(page)</span><br><span class="line">            request = scrapy.FormRequest(</span><br><span class="line">                url = <span class="string">'http://ss.ebnew.com/tradingSearch/index.htm'</span>,</span><br><span class="line">                formdata=form_data,</span><br><span class="line">                callback=self.parse_page1</span><br><span class="line">            )</span><br><span class="line">            request.meta[<span class="string">'form_data'</span>] = form_data</span><br><span class="line">            <span class="keyword">yield</span> request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_page1</span><span class="params">(self,response)</span>:</span></span><br><span class="line">        form_data = response.meta[<span class="string">'form_data'</span>]</span><br><span class="line">        keyword = form_data.get(<span class="string">'key'</span>)</span><br><span class="line">        content_list_x_s = response.xpath(<span class="string">'//div[@class="ebnew-content-list"]/div'</span>)</span><br><span class="line">        <span class="keyword">for</span> content_list_x <span class="keyword">in</span> content_list_x_s:</span><br><span class="line">            sql_data = deepcopy(self.sql_data)</span><br><span class="line">            <span class="comment"># 这里需要把下面的数据保存到sql_data里</span></span><br><span class="line">            sql_data[<span class="string">'toptype'</span>] = content_list_x.xpath(<span class="string">'./div[1]/i[1]/text()'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'title'</span>] = content_list_x.xpath(<span class="string">'./div[1]/a[1]/text()'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'publicity_date'</span>] =content_list_x.xpath(<span class="string">'./div[1]/i[2]/text()'</span>).extract_first()</span><br><span class="line">            <span class="keyword">if</span> sql_data[<span class="string">'publicity_date'</span>]:</span><br><span class="line">                sql_data[<span class="string">'publicity_date'</span>] = re.sub(<span class="string">'[^0-9\-]'</span>,<span class="string">''</span>,sql_data[<span class="string">'publicity_date'</span>]) <span class="comment"># 将发布日期里的文字'发布日期'替换成空字符串的格式</span></span><br><span class="line"></span><br><span class="line">            sql_data[<span class="string">'tendering_manner'</span>] = content_list_x.xpath(<span class="string">'./div[2]/div[1]/p[1]/span[2]/text()'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'product'</span>] = content_list_x.xpath(<span class="string">'./div[2]/div[1]/p[2]/span[2]/text()'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'expiry_date'</span>] = content_list_x.xpath(<span class="string">'./div[2]/div[2]/p[1]/span[2]/text()'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'province'</span>] = content_list_x.xpath(<span class="string">'./div[2]/div[2]/p[2]/span[2]/text()'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'detail_url'</span>] = content_list_x.xpath(<span class="string">'./div[1]/a/@href'</span>).extract_first()</span><br><span class="line">            sql_data[<span class="string">'keyword'</span>] = keyword</span><br><span class="line">            sql_data[<span class="string">'web'</span>] = <span class="string">'必联网'</span></span><br><span class="line">            request = scrapy.Request(</span><br><span class="line">                url = sql_data[<span class="string">'detail_url'</span>],</span><br><span class="line">                callback=self.parse_page2</span><br><span class="line">            )</span><br><span class="line">            request.meta[<span class="string">'sql_data'</span>] = sql_data</span><br><span class="line">            <span class="keyword">yield</span> request</span><br><span class="line">            <span class="comment"># print(toptype,title,publicity_date,tendering_manner,product,expiry_date,province)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_page2</span><span class="params">(self,response)</span>:</span></span><br><span class="line">        sql_data = response.meta[<span class="string">'sql_data'</span>]</span><br><span class="line">        sql_data[<span class="string">'projectcode'</span>] = response.xpath(</span><br><span class="line">            <span class="string">'/ul[contains(@class,"ebnew-project-information")]/li[1]/span[2]/text()'</span>).extract_first()</span><br><span class="line">        sql_data[<span class="string">'industry'</span>] = response.xpath(</span><br><span class="line">            <span class="string">'/ul[contains(@class,"ebnew-project-information")]/li[8]/span[2]/text()'</span>).extract_first()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> response.meta[<span class="string">'projectcode'</span>]:</span><br><span class="line">            projectcode_find = re.findall(<span class="string">'项目编号[：:]&#123;0,1&#125;\s&#123;0,2&#125;([a-zA-Z0-9\-]&#123;10,80&#125;)'</span>,response.body.decode(<span class="string">'utf-8'</span>))</span><br><span class="line">            response.meta[<span class="string">'projectcode '</span>]= projectcode_find[<span class="number">0</span>] <span class="keyword">if</span> projectcode_find <span class="keyword">else</span> <span class="string">""</span></span><br><span class="line">        <span class="comment"># print(industry,projectcode)</span></span><br><span class="line">        <span class="keyword">yield</span> sql_data <span class="comment"># 把sql_data转交给管道文件</span></span><br></pre></td></tr></table></figure>
<h2 id="pipelines-py"><a href="#pipelines-py" class="headerlink" title="pipelines.py"></a>pipelines.py</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZhaobiaoPipeline</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.mysql_conn = pymysql.connections(</span><br><span class="line">            host = <span class="string">'localhost'</span>,</span><br><span class="line">            post=<span class="number">3306</span>,</span><br><span class="line">            user=<span class="string">'root'</span>,</span><br><span class="line">            password = <span class="string">'126511'</span>,</span><br><span class="line">            database=<span class="string">'zhaobiao'</span>,</span><br><span class="line">            charset=<span class="string">'utf8'</span>,</span><br><span class="line"></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self, item, spider)</span>:</span></span><br><span class="line">        <span class="comment"># 创建光标对象</span></span><br><span class="line">        cs = self.mysql_conn.cursur()</span><br><span class="line">        <span class="comment"># sql_str = 'insert into t_zhaobiao (字段,字段) value ("值","值")'</span></span><br><span class="line">        sql_column = <span class="string">','</span>.join([key <span class="keyword">for</span> key <span class="keyword">in</span> item.keys()])</span><br><span class="line">        sql_value = <span class="string">','</span>.join([<span class="string">'"%s"'</span>% item[key] <span class="keyword">for</span> key <span class="keyword">in</span> item.keys()])</span><br><span class="line">        sql_str = <span class="string">'insert into t_zhaobiao (%s) value (%s);'</span> %(sql_column,sql_value)</span><br><span class="line">        cs.execute(sql_str)</span><br><span class="line"></span><br><span class="line">        self.mysql_conn.commit()</span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>爬虫</tag>
        <tag>个人项目</tag>
      </tags>
  </entry>
  <entry>
    <title>特征工程</title>
    <url>/2020/05/23/%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="特征工程"><a href="#特征工程" class="headerlink" title="特征工程"></a>特征工程</h1><p>-&gt; 拿到的数据不规范，了解数据的一些信息和格式，便于后期工作<br>-&gt; 机器学习前的准备工作<br>-&gt; 前期是理论，后期是实践</p>
<h2 id="本周内容"><a href="#本周内容" class="headerlink" title="本周内容"></a>本周内容</h2><a id="more"></a>
<h3 id="1-机器学习的简单理解"><a href="#1-机器学习的简单理解" class="headerlink" title="1.机器学习的简单理解"></a>1.机器学习的简单理解</h3><p>和其他的计算机程序没有区别<br>核心也是算法和数据，从数据中学习，并建立模型<br>拿到源数据</p>
<blockquote>
<p>机器学习：选择一种学习算法，从数据中学习并建立成模型来 对新的数据进行预测的计算机科学<br>• 机器学习适用于：</p>
</blockquote>
<ol>
<li>不存在已知算法解决方案的复杂问题</li>
<li>需要大量手动调整或者规则列表超长的问题</li>
<li>可以适应环境波动的系统<br>• 机器学习就是要用数据和算法训练有效的模型，再用模型去预 测新的数据</li>
</ol>
<h3 id="2-机器学习中的基础概念"><a href="#2-机器学习中的基础概念" class="headerlink" title="2.机器学习中的基础概念"></a>2.机器学习中的基础概念</h3><ol>
<li>提供给算法的包含所需解决方案的训练数据，称为标签</li>
<li>属性加上其值 就是特征</li>
<li>通过给定的特征来预测一个目标数值，叫回归任务</li>
<li>用于训练模型的数据叫训练集</li>
<li>用于测试模型精度的数据叫测试集</li>
<li>每一条数据叫一个样本(x)，样本对应的结果叫标签(y)</li>
<li>模型在训练数据上表现良好，泛化不好叫过度拟合，反之欠拟合</li>
<li>模型训练就是通过训练数据找到算法最合适的参数</li>
</ol>
<h3 id="3-机器学习模型训练工作原理"><a href="#3-机器学习模型训练工作原理" class="headerlink" title="3.机器学习模型训练工作原理"></a>3.机器学习模型训练工作原理</h3><p>-&gt; 图片</p>
<h3 id="4-机器学习执行流程"><a href="#4-机器学习执行流程" class="headerlink" title="4.机器学习执行流程"></a>4.机器学习执行流程</h3><p>-&gt; 图片</p>
<h3 id="5-数据处理对于机器学习的重要性"><a href="#5-数据处理对于机器学习的重要性" class="headerlink" title="5.数据处理对于机器学习的重要性"></a>5.数据处理对于机器学习的重要性</h3><p>• 机器学习的核心问题：算法好坏和数据好坏<br>• 复杂问题，数据比算法更重要<br>• 数据处理主要解决的问题：</p>
<ol>
<li>数据量不足</li>
<li>训练数据不具备代表性</li>
<li>质量差的数据</li>
<li>特征筛选</li>
</ol>
<p>— 实践 —</p>
<h3 id="6-特征工程"><a href="#6-特征工程" class="headerlink" title="6.特征工程"></a>6.特征工程</h3><p>机器学习的关键是 提取出一组好的用来训练的特征集，这个过 程叫特征工程，包括：</p>
<ol>
<li>特征选择 从现有特征中选择最有用的特征进行训练</li>
<li>特征提取 将现有特征进行整合，产生更有用的特征，比 如降维算法</li>
<li>通过收集 新数据创造新特征</li>
</ol>
<h3 id="7-一个机器学习项目的数据处理流程"><a href="#7-一个机器学习项目的数据处理流程" class="headerlink" title="7.一个机器学习项目的数据处理流程"></a>7.一个机器学习项目的数据处理流程</h3><ol>
<li>真实数据观察全局</li>
<li>选择性能指标、检查假设</li>
<li>获取数据 创建工作区，快速查看数据结构，创建测试集</li>
<li>从可视化中探索数据 将数据可视化、寻找相关性、试验不同的属性组合</li>
<li>机器学习前的数据准备 数据清理、自定义转换器、特征缩放、转换流水线</li>
<li>选择训练模型 评估训练集、交叉验证、分析最佳模型及其错误、测试集评</li>
<li>模型调优</li>
<li>分析最佳模型和测试集评估</li>
<li>系统维护和监控</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>目标：给机器学习提供更好的数据，才可以得到精度高的模型，来预测新数据<br>需要：     提供足够数据量的数据<br>        训练数据要具备代表性<br>        数据质量不能太差<br>        关键部分是提取出一组好的特征集来训练模型</p>
<h1 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a>代码部分</h1><h2 id="获取数据与初步分析"><a href="#获取数据与初步分析" class="headerlink" title="获取数据与初步分析"></a>获取数据与初步分析</h2><p>需求模块</p>
<blockquote>
<p>jupyter,matplotlib,numpy,pandas,scipy,scikit-learn<br>引入操作系统【os】<br>引入pandas<br>加载外部数据</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_housing_data</span><span class="params">(housing_path = <span class="string">'./'</span>)</span>:</span></span><br><span class="line">    csv_path = os.path.join(housing_path,<span class="string">'housing.csv'</span>)</span><br><span class="line">    <span class="keyword">return</span> pd.read_csv(csv_path)</span><br><span class="line"></span><br><span class="line">housing = load_housing_data() <span class="comment"># 被引入的数据被叫做housing</span></span><br><span class="line">housing.head()</span><br><span class="line">housing.shape  <span class="comment"># 显示数据数量</span></span><br><span class="line">---&gt; (20640, 10) # 两万条数据，十个特征</span><br><span class="line">housing.info() <span class="comment"># 查看数据集的简单描述，得到每个属性和非空值数据量</span></span><br></pre></td></tr></table></figure>
<p>&lt;class ‘pandas.core.frame.DataFrame’&gt;<br>RangeIndex: 20640 entries, 0 to 20639<br>Data columns (total 10 columns):</p>
<h1 id="Column-Non-Null-Count-Dtype"><a href="#Column-Non-Null-Count-Dtype" class="headerlink" title="Column              Non-Null Count  Dtype"></a>Column              Non-Null Count  Dtype</h1><hr>
<p> 0   longitude           20640 non-null  float64<br> 1   latitude            20640 non-null  float64<br> 2   housing_median_age  20640 non-null  float64<br> 3   total_rooms         20640 non-null  float64<br> 4   total_bedrooms      20433 non-null  float64 -&gt; 有空值，需要补充或者删除掉<br> 5   population          20640 non-null  float64<br> 6   households          20640 non-null  float64<br> 7   median_income       20640 non-null  float64<br> 8   median_house_value  20640 non-null  float64<br> 9   ocean_proximity     20640 non-null  object -&gt; 分类<br>dtypes: float64(9), object(1)<br>memory usage: 1.6+ MB<br>—&gt; [total_bedrooms]      20433 non-null  float64 数据和其他的数量不同， 有一部分空值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">housing[<span class="string">'ocean_proximity'</span>].value_counts()  <span class="comment"># 查看多少种分类</span></span><br><span class="line">housing.describe() <span class="comment"># 显示数值属性摘要</span></span><br></pre></td></tr></table></figure>
<p>—&gt;<br>INLAND        6551<br>NEAR OCEAN    2658<br>NEAR BAY      2290<br>ISLAND           5<br>Name: ocean_proximity, dtype: int64</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用pandas绘制matplotlib的图表需要用到下面的魔法命令</span></span><br><span class="line">%matplotlib inline </span><br><span class="line"><span class="comment"># 将jupyter 作为matplotlib的后端显示</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">housing.hist(bins = <span class="number">50</span>,figsize = (<span class="number">20</span>,<span class="number">15</span>)) <span class="comment"># bins-数值个数；figsize-图片大小，特征值幅度大</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>—&gt; 图1，2，3</p>
<p>房龄和房价被设定了上限值-&gt; 最大值出现一条很高的直线：</p>
<ul>
<li>对设置了上线的区域从新采集，重新设置标签值</li>
<li>把五十万美元的区域数据从训练集中移除-&gt; 设置上限的区域移除<br>重尾 头高尾长 -&gt;数据前期有很高的直线，后期数据基本没有</li>
<li>转换数据，把数据形状变成偏钟型分布(正态分布)-&gt; 平均值为0，标准差为1<br>收入特征</li>
<li>数据提供的上游证实 是年薪 单位万美元， 提前对特征进行缩放是正常的，需要得知数据是如何缩放的</li>
</ul>
<h2 id="创建训练集和测试集"><a href="#创建训练集和测试集" class="headerlink" title="创建训练集和测试集"></a>创建训练集和测试集</h2><p>训练集用于模型训练 占整个数据集的80% ，测试占20%</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_train_test</span><span class="params">(data,test_radio)</span>:</span> <span class="comment">#（数据，比例）</span></span><br><span class="line">    np.random.seed(<span class="number">42</span>) <span class="comment"># 使每次返回的数据集都是相同的</span></span><br><span class="line">    indices = np.random.permutation(len(data)) <span class="comment"># 对原来的数组进行重新洗牌，随机打乱原来的元素顺序；indices 新的乱序索引</span></span><br><span class="line">    test_set_size = int(len(data)*test_radio) <span class="comment"># 获取测试集大小，长度*比例</span></span><br><span class="line">    test_indices = indices[:test_set_size] <span class="comment"># 测试集索引</span></span><br><span class="line">    train_indices = indices[test_set_size:] <span class="comment"># 训练集索引</span></span><br><span class="line">    <span class="keyword">return</span> data.iloc[train_indices],data.iloc[test_indices]  <span class="comment"># 通过物理索引取值，返回测试和训练两个集</span></span><br><span class="line"></span><br><span class="line">train_set ,test_set = split_train_test(housing,<span class="number">0.2</span>)</span><br><span class="line">len(train_set) <span class="comment"># 16512</span></span><br><span class="line">len(test_set) <span class="comment"># 4128</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p> 但如果遇到数据库在不断增加的情况下上面的情况依然不稳定;<br>对样本设置唯一的标识符，对标识符去的哈希值，取哈希的最后一个字节，值小于等于51-&gt; 256%20,放入测试集;<br>哈希值相等的两个对象可能不是一个对象，哈希值不同的两个对象一定不是一个对象;<br>定义一个方法：样本标识符-&gt; 哈希值-&gt; 哈希值最后一个字节.</p>
</blockquote>
<p>运用哈希值是所有数据得到唯一标识符，让这些数据在后续的分类处理中使训练集不变</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib <span class="comment"># md5的包</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_set_check</span><span class="params">(identifier,test_radio,hash = hashlib.md5)</span>:</span><span class="comment"># 测试集的检查（标识符，比例，默认哈希算法）</span></span><br><span class="line">    <span class="keyword">return</span> hash(np.int64(identifier)).digest()[<span class="number">-1</span>]&lt;<span class="number">256</span> *test_radio <span class="comment">#np.int64:np的强制转换；返回摘要，作为二进制字符串 求得哈希值</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_train_test_by_id</span><span class="params">(data,test_ratio,id_columns)</span>:</span><span class="comment"># 通过标识符id识别；id_columns 选择哪一列作为标识符	</span></span><br><span class="line">    ids = data[id_columns] <span class="comment"># 取出标识符的所有数据 -&gt;所有文本的标识符</span></span><br><span class="line">    in_test_set = ids.apply(<span class="keyword">lambda</span> id_:test_set_check(id_,test_ratio)) <span class="comment"># apply方法：设定True和False来表示数据是否在测试集中</span></span><br><span class="line">    <span class="keyword">return</span> data.loc[~in_test_set],data.loc[in_test_set]<span class="comment"># 先训练集（不在测试集的【用到了取反】） ，在测试集</span></span><br><span class="line">housing_with_id = housing.reset_index() <span class="comment"># 使用行索引作为标识符id-&gt;行索引是自己加的，在第一列添加一列index</span></span><br><span class="line">train_set,test_set = split_train_test_by_id(housing_with_id,<span class="number">0.2</span>,<span class="string">'index'</span>) <span class="comment"># 用行索引初始化</span></span><br></pre></td></tr></table></figure>
<p> 基于行索引，不能删除和中间插入，只能末尾插入，否则行索引会变<br> 寻找稳定特征来创建唯一标识符，使用经纬度作为唯一标识符<br> <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">housing_with_id[<span class="string">'id'</span>] = housing[<span class="string">'longitude'</span>]*<span class="number">1000</span>+housing[<span class="string">'latitude'</span>] <span class="comment"># 不重复的样本的id值</span></span><br><span class="line">train_set,test_set = split_train_test_by_id(housing_with_id,<span class="number">0.2</span>,<span class="string">'id'</span>) <span class="comment"># 用经纬度初始化</span></span><br><span class="line"></span><br><span class="line">添加一种sklearn的方法用于分割测试集和训练集</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split <span class="comment"># 自带的，适用于不会更新的数据集的分类方式</span></span><br><span class="line">train_set,test_set = train_test_split(housing,test_size = <span class="number">0.2</span>,random_state = <span class="number">42</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="从数据的可视化中探索数据"><a href="#从数据的可视化中探索数据" class="headerlink" title="从数据的可视化中探索数据"></a>从数据的可视化中探索数据</h2><h3 id="分层采样"><a href="#分层采样" class="headerlink" title="分层采样"></a>分层采样</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">housing[<span class="string">'median_income'</span>].hist() <span class="comment"># 收入情况直方图</span></span><br></pre></td></tr></table></figure>
<p>—&gt;图<br>对收入情况进行分层采样<br>希望测试集能够代表整个数据集中各种不同类型的收入<br>创建收入类别的属性<br>不能将数据分层太多，但每一层都应有相应的数据量<br>将收入的中位数/1.5，限制收入类别数量，使用ceil取整，得到离散类别，将大于五的数据类别合并</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">housing[<span class="string">'income_cat'</span>] = np.ceil(housing[<span class="string">'median_income'</span>]/<span class="number">1.5</span>) <span class="comment"># 新建特征，使用ceil方法将收入的中位数/1.5</span></span><br><span class="line"><span class="comment"># housing['income_cat'].head(20)</span></span><br><span class="line">housing[<span class="string">'income_cat'</span>].where(housing[<span class="string">'income_cat'</span>]&lt;<span class="number">5</span>) <span class="comment"># 大于5的换成Nan</span></span><br><span class="line">housing[<span class="string">'income_cat'</span>].where(housing[<span class="string">'income_cat'</span>]&lt;<span class="number">5</span>,<span class="number">5.0</span>,inplace = <span class="literal">True</span>) <span class="comment"># 对所有上述值为nan的替换成5.0</span></span><br><span class="line">housing[<span class="string">'income_cat'</span>] = pd.cut(housing[<span class="string">'median_income'</span>],bins = [<span class="number">0.</span>,<span class="number">1.5</span>,<span class="number">3.0</span>,<span class="number">4.5</span>,<span class="number">6.</span>,np.inf],labels = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]) <span class="comment"># bins -&gt;区间 labels-&gt;把连续值转换成类别标签</span></span><br><span class="line">``` </span><br><span class="line"><span class="comment">### 统计类别包含的区域个数</span></span><br><span class="line">```python</span><br><span class="line">housing[<span class="string">'income_cat'</span>].value_counts()</span><br><span class="line"><span class="comment"># 收入类别直方图</span></span><br><span class="line">housing[<span class="string">'income_cat'</span>].hist()</span><br></pre></td></tr></table></figure>
<h3 id="根据类别进行分层采样"><a href="#根据类别进行分层采样" class="headerlink" title="根据类别进行分层采样"></a>根据类别进行分层采样</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedShuffleSplit</span><br><span class="line">split = StratifiedShuffleSplit(n_splits = <span class="number">1</span>, test_size = <span class="number">0.2</span>,random_state = <span class="number">42</span>)<span class="comment"># n_splits = 1 默认是10</span></span><br><span class="line"><span class="keyword">for</span> train_index,test_index <span class="keyword">in</span> split.split(housing,housing[<span class="string">'income_cat'</span>]): <span class="comment"># 对数据进行分层采样</span></span><br><span class="line">    start_train_set = housing.loc[train_index]</span><br><span class="line">    start_test_set = housing.loc[test_index]</span><br><span class="line">start_train_set.shape <span class="comment">#---&gt;(16512, 11)</span></span><br></pre></td></tr></table></figure>

<h3 id="查看所有住房数据根据收入类别比例分布，收入占类别的百分比"><a href="#查看所有住房数据根据收入类别比例分布，收入占类别的百分比" class="headerlink" title="查看所有住房数据根据收入类别比例分布，收入占类别的百分比"></a>查看所有住房数据根据收入类别比例分布，收入占类别的百分比</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">start_train_set[<span class="string">'income_cat'</span>].value_counts()/len(start_train_set) <span class="comment"># 分层抽样测试集合</span></span><br><span class="line">housing[<span class="string">'income_cat'</span>].value_counts()/len(housing)<span class="comment"># 完整数据集合</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">income_cat_proportions</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> data[<span class="string">"income_cat"</span>].value_counts() / len(data)</span><br><span class="line"></span><br><span class="line">train_set, test_set = train_test_split(housing, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">compare_props = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">"全部数据"</span>: income_cat_proportions(housing),</span><br><span class="line">    <span class="string">"分层抽样"</span>: income_cat_proportions(start_test_set),</span><br><span class="line">    <span class="string">"随机抽样"</span>: income_cat_proportions(test_set),</span><br><span class="line">&#125;).sort_index()</span><br><span class="line">compare_props[<span class="string">"随机. %error"</span>] = <span class="number">100</span> * compare_props[<span class="string">"随机抽样"</span>] / compare_props[<span class="string">"全部数据"</span>] - <span class="number">100</span></span><br><span class="line">compare_props[<span class="string">"分层. %error"</span>] = <span class="number">100</span> * compare_props[<span class="string">"分层抽样"</span>] / compare_props[<span class="string">"全部数据"</span>] - <span class="number">100</span></span><br><span class="line">compare_props</span><br></pre></td></tr></table></figure>
<p>—&gt;三张图</p>
<p>把测试集已处理完成，用分层抽样的训练集数据来进行分析</p>
<h3 id="将地理数据可视化"><a href="#将地理数据可视化" class="headerlink" title="将地理数据可视化"></a>将地理数据可视化</h3><p>建立一个各个区域的分布图，以便于数据的可视化</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">housing.plot(kind = <span class="string">'scatter'</span>,x = <span class="string">'longitude'</span>,y = <span class="string">'latitude'</span>)</span><br><span class="line"><span class="comment"># 将alpha值设为0.1，可以看出高密度数据点的位置 0-&gt;完全透明 1-&gt;完全不透明</span></span><br><span class="line">housing.plot(kind = <span class="string">'scatter'</span>,x = <span class="string">'longitude'</span>,y = <span class="string">'latitude'</span>,alpha = <span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">housing.plot(kind = <span class="string">"scatter"</span>,x = <span class="string">'longitude'</span>,y = <span class="string">'latitude'</span>,alpha = <span class="number">0.4</span>,</span><br><span class="line">            s = housing[<span class="string">'population'</span>]/<span class="number">100</span>,label = <span class="string">"population"</span>,figsize = (<span class="number">10</span>,<span class="number">7</span>),</span><br><span class="line">             c =<span class="string">"median_house_value"</span>,cmap = plt.get_cmap(<span class="string">"gist_rainbow"</span>),colorbar = <span class="literal">True</span>,</span><br><span class="line">             sharex = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入图片让图片成为背景</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.image <span class="keyword">as</span> mping</span><br><span class="line">california_img = mping.imread(<span class="string">'./california.png'</span>)</span><br><span class="line"></span><br><span class="line">housing.plot(kind = <span class="string">"scatter"</span>,x = <span class="string">'longitude'</span>,y = <span class="string">'latitude'</span>,alpha = <span class="number">0.4</span>,</span><br><span class="line">            s = housing[<span class="string">'population'</span>]/<span class="number">100</span>,label = <span class="string">"population"</span>,figsize = (<span class="number">10</span>,<span class="number">7</span>),</span><br><span class="line">             c =<span class="string">"median_house_value"</span>,cmap = plt.get_cmap(<span class="string">"rainbow"</span>),colorbar = <span class="literal">True</span>,</span><br><span class="line">             sharex = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">plt.imshow(california_img,extent = [<span class="number">-124.55</span>,<span class="number">-113.8</span>,<span class="number">32.45</span>,<span class="number">42.05</span>],alpha = <span class="number">0.5</span>,</span><br><span class="line">          cmap = plt.get_cmap(<span class="string">"rainbow"</span>))</span><br><span class="line">plt.ylabel(<span class="string">"Latitude"</span>,fontsize = <span class="number">14</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Longitude"</span>,fontsize = <span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment"># 使价格成为标准</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.image <span class="keyword">as</span> mping</span><br><span class="line">california_img = mping.imread(<span class="string">'./california.png'</span>)</span><br><span class="line"></span><br><span class="line">housing.plot(kind = <span class="string">"scatter"</span>,x = <span class="string">'longitude'</span>,y = <span class="string">'latitude'</span>,alpha = <span class="number">0.4</span>,</span><br><span class="line">            s = housing[<span class="string">'population'</span>]/<span class="number">100</span>,label = <span class="string">"population"</span>,figsize = (<span class="number">10</span>,<span class="number">7</span>),</span><br><span class="line">             c =<span class="string">"median_house_value"</span>,cmap = plt.get_cmap(<span class="string">"rainbow"</span>),colorbar = <span class="literal">False</span>,</span><br><span class="line">             sharex = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">plt.imshow(california_img,extent = [<span class="number">-124.55</span>,<span class="number">-113.8</span>,<span class="number">32.45</span>,<span class="number">42.05</span>],alpha = <span class="number">0.5</span>,</span><br><span class="line">          cmap = plt.get_cmap(<span class="string">"rainbow"</span>))</span><br><span class="line">plt.ylabel(<span class="string">"Latitude"</span>,fontsize = <span class="number">14</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Longitude"</span>,fontsize = <span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">prices = housing[<span class="string">'median_house_value'</span>]</span><br><span class="line">tick_values = np.linspace(prices.min(),prices.max(),<span class="number">11</span>)<span class="comment"># 在最小值与最大值之间十一等分</span></span><br><span class="line">cbar  =plt.colorbar()</span><br><span class="line">cbar.ax.set_yticklabels([<span class="string">"$%dk"</span>%(round(v/<span class="number">1000</span>))<span class="keyword">for</span> v <span class="keyword">in</span> tick_values],fontsize = <span class="number">14</span>)</span><br><span class="line">cbar.set_label(<span class="string">'Median House Value'</span>,fontsize = <span class="number">16</span>)</span><br><span class="line">plt.legend(fontsize = <span class="number">16</span>)</span><br><span class="line"><span class="comment"># save_fig("california_housing_prices_plot")</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h3 id="寻找特征之间的相关性"><a href="#寻找特征之间的相关性" class="headerlink" title="寻找特征之间的相关性"></a>寻找特征之间的相关性</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 房屋位置与地理位置 靠海 人口密度相关</span></span><br><span class="line"><span class="comment"># 寻找特征之间的相关性</span></span><br><span class="line"><span class="comment"># corr() 计算出所有特征之间的相关系数，称为皮尔逊相关系数-&gt; -1 到 1   0-&gt;无关  1-&gt;完全相关正相关  -1 -&gt;完全相关负相关</span></span><br><span class="line">corr_matrix = housing.corr()</span><br><span class="line">corr_matrix</span><br><span class="line"></span><br><span class="line">corr_matrix[<span class="string">'median_house_value'</span>].sort_values(ascending = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用pandas scatter_matrix 函数，绘制出特征之间的相关性</span></span><br><span class="line"><span class="keyword">from</span> pandas.plotting <span class="keyword">import</span> scatter_matrix</span><br><span class="line">attributes = [<span class="string">'median_house_value'</span>,<span class="string">'median_income'</span>,<span class="string">'total_rooms'</span>,<span class="string">'housing_median_age'</span>]</span><br><span class="line">scatter_matrix(housing[attributes],figsize = (<span class="number">12</span>,<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">housing.plot(kind = <span class="string">'scatter'</span>,x = <span class="string">'median_income'</span>,y = <span class="string">'median_house_value'</span>,alpha = <span class="number">0.1</span>) <span class="comment"># 房价和收入的关系</span></span><br><span class="line">housing.plot(kind = <span class="string">'scatter'</span>,x = <span class="string">'median_income'</span>,y = <span class="string">'median_house_value'</span>,alpha = <span class="number">0.1</span>)<span class="comment"># 扩大这个表的显示范围，</span></span><br><span class="line">plt.axis([<span class="number">0</span>,<span class="number">16</span>,<span class="number">0</span>,<span class="number">550000</span>])</span><br></pre></td></tr></table></figure>
<p>五十万美元是一条清晰线，因为在采样中被设置上限，45w，35w，28w也有虚线，可能是异常值，可以在后期将数据删除掉</p>
<ul>
<li><p>在给机器学习算法输入数据之前，我们识别出了一些异常数据，需要提前清理掉，也发现了不同属性之间的某些联系，跟目标属性相关的联系</p>
</li>
<li><p>某些属性分布显示出了明显的“重尾”分布，对进行转换处理，计算其对数</p>
</li>
<li><p>在给机器学习算法输入数据之前，最后一件事儿，尝试各种属性的组合</p>
</li>
<li><p>每个项目历程都不一样，大致思路都相识</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加三组特征来计算关联性</span></span><br><span class="line">housing[<span class="string">'rooms_per_household'</span>] = housing[<span class="string">'total_rooms'</span>]/housing[<span class="string">'households'</span>]</span><br><span class="line">housing[<span class="string">'bedrooms_per_room'</span>] = housing[<span class="string">'total_bedrooms'</span>]/housing[<span class="string">'total_rooms'</span>]</span><br><span class="line">housing[<span class="string">'population_per_room'</span>] = housing[<span class="string">'population'</span>]/housing[<span class="string">'households'</span>]</span><br><span class="line"><span class="comment"># 关联矩阵</span></span><br><span class="line">corr_matrix = housing.corr()</span><br><span class="line">corr_matrix[<span class="string">'median_house_value'</span>].sort_values(ascending = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>-&gt;图</p>
</li>
</ul>
<h2 id="机器学习算法的数据准备"><a href="#机器学习算法的数据准备" class="headerlink" title="机器学习算法的数据准备"></a>机器学习算法的数据准备</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 得到一个分层抽样代表全局数据集的训练和测试集</span></span><br><span class="line">housing_labels = start_train_set[<span class="string">'median_house_value'</span>].copy() <span class="comment"># 将数据集的数据和标签分开-&gt; 分离房价</span></span><br><span class="line"></span><br><span class="line">housing = start_train_set.drop(<span class="string">'median_house_value'</span>,axis = <span class="number">1</span>) <span class="comment"># 删除房价这特征，因为要对她做出预测</span></span><br></pre></td></tr></table></figure>

<h3 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h3><p>大多数机器学算法无法在缺失的特征上工作，创建一些函数辅助，total_bedrooms有缺失，<br>放弃这些区域<br>放弃这个属性<br>将缺失值 设置为 某个值，（0， 平均数或者中位数都可以）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">housing.info()</span><br></pre></td></tr></table></figure>
<p>-&gt;图<br>清洗的方案</p>
<ol>
<li>删除这些值</li>
<li>将值为空的部分删除</li>
<li>对数据进行补充<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rows = housing[housing.isnull().any(axis = <span class="number">1</span>)] <span class="comment"># .isnull() 输出矩阵，并判断其中为空的值，若为空输出ture；.any（axis = 1）以行为基准取出输出Ture的行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 放弃这些区域 .dropna()删除空值</span></span><br><span class="line"><span class="comment"># rows.dropna（subset = ['total_bedrooms'])</span></span><br><span class="line"><span class="comment"># 放弃这个属性</span></span><br><span class="line"><span class="comment"># rows.drop('total_bedrooms',axis = 1)</span></span><br><span class="line"><span class="comment"># 将缺失值 设置为 某个值，(0,平均数或者中午数都可以)</span></span><br><span class="line"><span class="comment"># 	----------------------------------------以上都不推荐</span></span><br><span class="line"><span class="comment"># 创建一个imputer实例，指定你要用属性中的中位数值替换该属性的缺失值</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> Imputer <span class="keyword">as</span> SimpleImputer <span class="comment"># 估算器</span></span><br><span class="line"></span><br><span class="line">imputer = SimpleImputer(strategy = <span class="string">'median'</span>) <span class="comment"># 一种算法；用中位数填补空值</span></span><br><span class="line"><span class="comment"># 使用fit（）将imputer实例适配到训练集</span></span><br><span class="line">housing_num = housing.drop(<span class="string">'ocean_proximity'</span>,axis = <span class="number">1</span>)<span class="comment"># 排除掉非浮点类型</span></span><br><span class="line">imputer.fit(housing_num) <span class="comment"># 适配；最后一列是非浮点类型因此有报错</span></span><br><span class="line"></span><br><span class="line">imputer.statistics_ <span class="comment"># 特征值中位数</span></span><br><span class="line">housing_num.median().values</span><br><span class="line">X = imputer.transform(housing_num) 返回的是各个特征的值，需要将他们转换成dataframe格式</span><br><span class="line">housing_tr = pd.DataFrame(X, columns = housing_num.columns, index = housing_num.index)</span><br><span class="line">housing_tr.info()<span class="comment"># 检测是否还有空值</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>-》</p>
<h3 id="scikit-Learn-机器学习框架"><a href="#scikit-Learn-机器学习框架" class="headerlink" title="scikit-Learn 机器学习框架"></a>scikit-Learn 机器学习框架</h3><p>Tensorflow-深度学习框架<br>一致性<br>估算器 比如：各种机器学习算法 fit()执行估算器<br>转换器 比如：LabelBinarizer transform() 执行转换数据集 fit_transform() 先估算，再转换<br>预测器 predict() 对给定的新数据集进行预测 score() 评估测试集的预测质量<br>检查<br>imputer.strategy_学习参数通过公共实例变量访问</p>
<h3 id="处理文本和分类属性"><a href="#处理文本和分类属性" class="headerlink" title="处理文本和分类属性"></a>处理文本和分类属性</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">housing_cat = housing[[<span class="string">'ocean_proximity'</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将文本转化成对应的数字分类 ， 使用转换器</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">encoder = LabelEncoder()</span><br><span class="line"></span><br><span class="line">housing_cat_encoder = encoder.fit_transform(housing_cat)</span><br><span class="line">housing_cat_encoder</span><br><span class="line"><span class="comment"># -》 array([0, 0, 4, ..., 1, 0, 3]) 用从零到4⃣ 五个值将其中的类别进行替代</span></span><br><span class="line">encoder.classes_<span class="comment"># 全局的对象属性</span></span><br><span class="line"><span class="comment"># -》array(['&lt;1H OCEAN', 'INLAND', 'ISLAND', 'NEAR BAY', 'NEAR OCEAN'],dtype=object)</span></span><br></pre></td></tr></table></figure>

<p>机器学习算法会以为两个相近的数字比远的数字更相似，比如0，4 比 0，1相似度更高，<br>创建独热编码，当 &lt;1H ,第0个属性为1，其余都为0， 列别是InLand时候，另一个属性为1，其余为0，1为热，0为冷，独热编码<br>OneHotEncoder编码器, fit_trans需要二维数组， 转换housing_cat</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder <span class="comment"># 独热编码：属于哪个区域哪个区域的值就为1，其余为0</span></span><br><span class="line">encoder = OneHotEncoder() <span class="comment"># 独热编码转化器</span></span><br><span class="line">housing_cat_encoder.reshape(<span class="number">-1</span>, <span class="number">1</span>) <span class="comment"># 数据变成一列</span></span><br><span class="line">housing_cat_hot = encoder.fit_transform(housing_cat_encoder.reshape(<span class="number">-1</span>, <span class="number">1</span>)) <span class="comment"># 返回稀疏矩阵</span></span><br><span class="line"><span class="comment">#-》 &lt;16512x5 sparse matrix of type '&lt;class 'numpy.float64'&gt;' with 16512 stored elements in Compressed Sparse Row format&gt;</span></span><br><span class="line">housing_cat_hot.toarray() <span class="comment"># 从稀疏矩阵 转换成 numpy</span></span><br><span class="line"><span class="comment">#-》</span></span><br><span class="line">		<span class="comment"># array([[1., 0., 0., 0., 0.],</span></span><br><span class="line">		<span class="comment">#        [1., 0., 0., 0., 0.],</span></span><br><span class="line">		<span class="comment">#        [0., 0., 0., 0., 1.],</span></span><br><span class="line">		<span class="comment">#        ...,</span></span><br><span class="line">		<span class="comment">#        [0., 1., 0., 0., 0.],</span></span><br><span class="line">		<span class="comment">#        [1., 0., 0., 0., 0.],</span></span><br><span class="line">		<span class="comment">#        [0., 0., 0., 1., 0.]])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一次完成两个转换 文本--整数类型--独热类型</span></span><br><span class="line">housing_cat</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelBinarizer</span><br><span class="line">encoder = LabelBinarizer()</span><br><span class="line">housing_cat_1hot = encoder.fit_transform(housing_cat)</span><br><span class="line">housing_cat_1hot</span><br><span class="line"><span class="comment">#-》</span></span><br><span class="line"><span class="comment"># array([[1, 0, 0, 0, 0],</span></span><br><span class="line">       <span class="comment"># [1, 0, 0, 0, 0],</span></span><br><span class="line">       <span class="comment"># [0, 0, 0, 0, 1],</span></span><br><span class="line">       <span class="comment"># ...,</span></span><br><span class="line">       <span class="comment"># [0, 1, 0, 0, 0],</span></span><br><span class="line">       <span class="comment"># [1, 0, 0, 0, 0],</span></span><br><span class="line">       <span class="comment"># [0, 0, 0, 1, 0]])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出稀疏矩阵</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelBinarizer</span><br><span class="line">encoder = LabelBinarizer(sparse_output = <span class="literal">True</span>)</span><br><span class="line">housing_cat_1hot = encoder.fit_transform(housing_cat)</span><br><span class="line">housing_cat_1hot</span><br><span class="line"><span class="comment">#-》 &lt;16512x5 sparse matrix of type '&lt;class 'numpy.int64'&gt;' with 16512 stored elements in Compressed Sparse Row format&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="自定义转换器"><a href="#自定义转换器" class="headerlink" title="自定义转换器"></a>自定义转换器</h3><p>必须包含fit和transfrom</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> BaseEstimator, TransformerMixin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过列表生成式取值</span></span><br><span class="line">rooms_ix, bedrooms_ix, population_ix, household_ix = [list(housing.columns).index(col) <span class="keyword">for</span> col <span class="keyword">in</span> (<span class="string">"total_rooms"</span>, <span class="string">"total_bedrooms"</span>, <span class="string">"population"</span>, <span class="string">"households"</span>)]</span><br><span class="line">rooms_ix, bedrooms_ix, population_ix, household_ix </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CombinedAttributesAdder</span><span class="params">(BaseEstimator, TransformerMixin)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, add_bedrooms_per_room = True)</span>:</span> <span class="comment"># 初始化</span></span><br><span class="line">        self.add_bedrooms_per_room = add_bedrooms_per_room</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y = None)</span>:</span><span class="comment">#（本身，数据，标签（可以没有））</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, X, y = None)</span>:</span> <span class="comment">#（本身，数据，标签（可以没有））</span></span><br><span class="line"></span><br><span class="line">        rooms_per_household = X[:, rooms_ix] / X[:, household_ix]</span><br><span class="line">        population_per_household = X[:, population_ix] / X[:, household_ix]</span><br><span class="line">        <span class="keyword">if</span> self.add_bedrooms_per_room:</span><br><span class="line">            bedrooms_per_room = X[:, bedrooms_ix] / X[:, rooms_ix]</span><br><span class="line">            <span class="keyword">return</span> np.c_[X, rooms_per_household,population_per_household, bedrooms_per_room]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> np.c_[X, rooms_per_household,population_per_household]</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">attr_adder = CombinedAttributesAdder(add_bedrooms_per_room = <span class="literal">False</span>)</span><br><span class="line">housing_extra_attribs = attr_adder.transform(housing.values) <span class="comment">#转换成numpy矩阵</span></span><br><span class="line">housing_extra_attribs</span><br><span class="line"><span class="comment"># - 》</span></span><br><span class="line"><span class="comment"># array([[-121.89, 37.29, 38.0, ..., 2, 4.625368731563422, 2.094395280235988],</span></span><br><span class="line"><span class="comment">#        [-121.93, 37.05, 14.0, ..., 5, 6.008849557522124,2.7079646017699117],</span></span><br><span class="line"><span class="comment">#        [-117.2, 32.77, 31.0, ..., 2, 4.225108225108225, 2.0259740259740258],</span></span><br><span class="line"><span class="comment">#        ...,</span></span><br><span class="line"><span class="comment">#        [-116.4, 34.09, 9.0, ..., 3, 6.34640522875817,    2.742483660130719],</span></span><br><span class="line"><span class="comment">#        [-118.01, 33.82, 31.0, ..., 3, 5.50561797752809,  3.808988764044944],</span></span><br><span class="line"><span class="comment">#        [-122.45, 37.77, 52.0, ..., 3,4.843505477308295,1.9859154929577465]],dtype=object)</span></span><br><span class="line"></span><br><span class="line">housing_tr = pd.DataFrame(housing_extra_attribs)</span><br><span class="line"><span class="comment"># 		0 			1 		2 	3 		4 		5 		6 		7 			8 		9 		10	 	11</span></span><br><span class="line"><span class="comment"># 0 	-121.89 	37.29 	38 	1568 	351 	710 	339 	2.7042 	&lt;1H OCEAN 	2 	4.62537 	2.0944</span></span><br><span class="line"><span class="comment"># 1 	-121.93 	37.05 	14 	679 	108 	306 	113 	6.4214 	&lt;1H OCEAN 	5 	6.00885 	2.70796</span></span><br><span class="line"><span class="comment"># 2 	-117.2 		32.77 	31 	1952 	471 	936 	462 	2.8621 	NEAR OCEAN 	2 	4.22511 	2.02597</span></span><br><span class="line"><span class="comment"># 3 	-119.61 	36.31 	25 	1847 	371 	1460 	353 	1.8839 	INLAND 		2 	5.23229 	4.13598</span></span><br><span class="line"><span class="comment"># 4 	-118.59 	34.23 	17 	6592 	1525 	4459 	1463 	3.0347 	&lt;1H OCEAN 	3 	4.50581 	3.04785</span></span><br><span class="line"></span><br><span class="line">housing_extra_attribs = pd.DataFrame(</span><br><span class="line">    housing_extra_attribs,</span><br><span class="line">    columns=list(housing.columns)+[<span class="string">"rooms_per_household"</span>, <span class="string">"population_per_household"</span>],</span><br><span class="line">    index=housing.index)</span><br><span class="line"></span><br><span class="line">housing_extra_attribs.sample(<span class="number">20</span>) <span class="comment">#采样</span></span><br></pre></td></tr></table></figure>
<h3 id="特征缩放"><a href="#特征缩放" class="headerlink" title="特征缩放"></a>特征缩放</h3><p>最重要也是最需要应用在数据上的转换器，就是特征缩放，输入数值属性有很大的比例差异，会导致机器学习算法性能表现不佳<br>房间总数 范围6到39320，收入中位数范围0到15<br>目标值通常不需要缩放<br>同比缩放所有属性，2种方法 最小-最大缩放和标准化<br>最小-最大缩放，又叫归一化，将值重新缩放到0到1之间，将值减去最小值并除以最大值和最小值差，如果你不希望是0到1，可以调整超参数feature_range<br>标准化 减去平均值，所以标准化均值总是0，然后除以方差，结果的分布具备单位方差，不同于归一化，标准化不将值绑定到特定范围，受异常值影响小<br>缩放器仅用来拟合训练集，不是完成的数据集</p>
<h3 id="转换流水线"><a href="#转换流水线" class="headerlink" title="转换流水线"></a>转换流水线</h3><p>许多数据转换的步骤需要以正确的顺序来执行， PipeLine来支持这样的转换<br>pipline构造函数会通过一系列名称/估算器的配对来定义步骤的序列，必须是转换器，必须有fit_fransform()方法<br>调用流水芡的fit方法时，会在所有转换器上按照顺序依次调用fit_transform()，将一个调用的输出作为参数传递给下一个调用方法，直到传递到最终<br>估算器，只会调用fit方法</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 常规：</span></span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line">num_pipeline = Pipeline([</span><br><span class="line">        (<span class="string">'imputer'</span>, SimpleImputer(strategy=<span class="string">"median"</span>)),<span class="comment"># 数据缺失值中位数补偿</span></span><br><span class="line">        (<span class="string">'attribs_adder'</span>, CombinedAttributesAdder()), <span class="comment"># 自定义数据转换</span></span><br><span class="line">        (<span class="string">'std_scaler'</span>, StandardScaler())<span class="comment"># 数据标注化缩放</span></span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">housing_num_tr = num_pipeline.fit_transform(housing_num)</span><br></pre></td></tr></table></figure>

<p>下面是一个完成流水线的例子</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 转换器 dataFrame -&gt; series -&gt; ndarray </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataFrameSelector</span><span class="params">(BaseEstimator, TransformerMixin)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, attribute_names)</span>:</span></span><br><span class="line">        self.attribute_names = attribute_names</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y=None)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> X[self.attribute_names].values</span><br><span class="line"></span><br><span class="line">num_attribs =list(housing_num) </span><br><span class="line"><span class="comment">#-&gt;</span></span><br><span class="line">	<span class="comment"># ['longitude',</span></span><br><span class="line">	<span class="comment">#  'latitude',</span></span><br><span class="line">	<span class="comment">#  'housing_median_age',</span></span><br><span class="line">	<span class="comment">#  'total_rooms',</span></span><br><span class="line">	<span class="comment">#  'total_bedrooms',</span></span><br><span class="line">	<span class="comment">#  'population',</span></span><br><span class="line">	<span class="comment">#  'households',</span></span><br><span class="line">	<span class="comment">#  'median_income',</span></span><br><span class="line">	<span class="comment">#  'income_cat']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据问题</span></span><br><span class="line">num_pipeline = Pipeline([</span><br><span class="line">        (<span class="string">'selector'</span>, DataFrameSelector(num_attribs)),</span><br><span class="line">        (<span class="string">'imputer'</span>, SimpleImputer(strategy=<span class="string">"median"</span>)),</span><br><span class="line">        (<span class="string">'attribs_adder'</span>, CombinedAttributesAdder()),</span><br><span class="line">        (<span class="string">'std_scaler'</span>, StandardScaler()),</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> TransformerMixin </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLabelBinarizer</span><span class="params">(TransformerMixin)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        self.encoder = LabelBinarizer(*args, **kwargs)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, x, y=<span class="number">0</span>)</span>:</span></span><br><span class="line">        self.encoder.fit(x)</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, x, y=<span class="number">0</span>)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.encoder.transform(x)</span><br><span class="line"></span><br><span class="line">cat_attribs = [<span class="string">'ocean_proximity'</span>]</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelBinarizer</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文本独热编码pipeline，两个pipeline同步执行</span></span><br><span class="line">cat_pipeline = Pipeline([</span><br><span class="line">        (<span class="string">'selector'</span>, DataFrameSelector(cat_attribs)),               </span><br><span class="line">        (<span class="string">'LabelBinarizer'</span>, MyLabelBinarizer()),</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> FeatureUnion</span><br><span class="line">full_pipeline = FeatureUnion(transformer_list=[</span><br><span class="line">        (<span class="string">"num_pipline"</span>, num_pipeline,),</span><br><span class="line">        (<span class="string">'cat_pipline'</span>, cat_pipeline),</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">housing_prepared = full_pipeline.fit_transform(housing)</span><br></pre></td></tr></table></figure>

<h2 id="选择和训练模型"><a href="#选择和训练模型" class="headerlink" title="选择和训练模型"></a>选择和训练模型</h2><ul>
<li>获得数据</li>
<li>数据搜索</li>
<li>对训练集和测试集进行拆分</li>
<li>编写了转换数据流水线</li>
<li>自动清理和准备机器学习算法的数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df = pd.DataFrame(housing_prepared)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<h3 id="训练模型和评估训练集"><a href="#训练模型和评估训练集" class="headerlink" title="训练模型和评估训练集"></a>训练模型和评估训练集</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression <span class="comment">#倒入线性回归算法</span></span><br><span class="line">lin_reg = LinearRegression() <span class="comment"># 初始化估算器</span></span><br><span class="line">lin_reg.fit(housing_prepared, housing_labels) <span class="comment"># 训练数据匹配到算法，做模型训练</span></span><br><span class="line"><span class="comment"># -&gt; LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测数据</span></span><br><span class="line">some_data = housing.iloc[:<span class="number">5</span>]</span><br><span class="line">some_labels = housing_labels.iloc[:<span class="number">5</span>]</span><br><span class="line">some_data_prepared = full_pipeline.transform(some_data)</span><br><span class="line">print(<span class="string">"Predictions:"</span>, lin_reg.predict(some_data_prepared))</span><br><span class="line"><span class="comment">#-&gt; Predictions: [203682.37379543 326371.39370781 204218.64588245  58685.4770482 194213.06443039]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error <span class="comment"># 计算均方根误差</span></span><br><span class="line">housing_predictions = lin_reg.predict(housing_prepared)</span><br><span class="line">lin_mse = mean_squared_error(housing_labels, housing_predictions)</span><br><span class="line">lin_mse</span><br><span class="line">lin_rmse = np.sqrt(lin_mse)</span><br><span class="line">lin_rmse <span class="comment"># 预测房价和真实房价的误差</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 大多数地区的房屋中位数 在120000到265000美元之间，预测误差高达 68628,这是一个典型的模型对训练数据拟合不足的案例，</span></span><br><span class="line"><span class="comment"># 原因可能是特征无法提供足够的信息来做出更好的预测，或者模型本身不够强大，</span></span><br><span class="line"><span class="comment"># 1. 选择强大的模型，2 为算法提供更好的特征，3.减少对模型的限制等方法，</span></span><br><span class="line"><span class="comment"># 决策树可以找到复杂的非线性关系</span></span><br><span class="line"><span class="comment"># -&gt; 68376.64295459937</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor <span class="comment"># 决策树模型 决策树估算器</span></span><br><span class="line">tree_reg = DecisionTreeRegressor(random_state=<span class="number">42</span>)</span><br><span class="line">tree_reg.fit(housing_prepared, housing_labels)</span><br><span class="line"><span class="comment"># -》 DecisionTreeRegressor(criterion='mse', max_depth=None, max_features=None,max_leaf_nodes=None,min_impurity_decrease=0.0,min_impurity_split=None, min_samples_leaf=1,min_samples_split=2, min_weight_fraction_leaf=0.0,presort=False, random_state=42, splitter='best')</span></span><br><span class="line"></span><br><span class="line">housing_predictions = tree_reg.predict(housing_prepared)</span><br><span class="line">tree_mse = mean_squared_error(housing_labels, housing_predictions)</span><br><span class="line">tree_rmse = np.sqrt(tree_mse)</span><br><span class="line">tree_rmse</span><br><span class="line"><span class="comment"># -》0.0</span></span><br><span class="line"><span class="comment"># 完美，也可能是这个模型对数据严重过度拟合了，如何确认？轻易不要启动测试集，拿训练集中的一部分用于训练，另一部分用于模型的验证</span></span><br></pre></td></tr></table></figure>


<h3 id="使用交叉验证来更好的进行评估"><a href="#使用交叉验证来更好的进行评估" class="headerlink" title="使用交叉验证来更好的进行评估"></a>使用交叉验证来更好的进行评估</h3><p>多次（10次）训练和评估</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用train_test_split函数将训练集分为较小的训练集和验证集，然后根据这些较小的训练集来训练模型，并对其进行评估</span></span><br><span class="line"><span class="comment"># sklearn的交叉验证，将训练集随机分割成10个不同的子集，每个子集称为一个折叠，对模型进行10次训练和评估，每次挑选1个折叠进行评估，另外9个进行训练</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="comment"># neg_mean_squared_error‘ 也就是 均方差回归损失 该统计参数是预测数据和原始数据对应点误差的平方和的均值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 决策树交叉验证</span></span><br><span class="line">scores = cross_val_score(tree_reg, housing_prepared, housing_labels,</span><br><span class="line">                         scoring=<span class="string">"neg_mean_squared_error"</span>, cv=<span class="number">10</span>)</span><br><span class="line">tree_rmse_scores = np.sqrt(-scores)</span><br><span class="line">tree_rmse_scores</span><br><span class="line"></span><br><span class="line"><span class="comment"># -》array([70307.54079165, 67270.94561829, 71361.89886493, 68889.91784739,70992.94150631, 74140.66907294, 70607.72083897, 70576.13836762,76433.16342183, 70270.96266671])</span></span><br><span class="line"><span class="comment"># 比线性的值的误差更大</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">display_scores</span><span class="params">(scores)</span>:</span></span><br><span class="line">    print(<span class="string">"Scores:"</span>, scores)</span><br><span class="line">    print(<span class="string">"Mean:"</span>, scores.mean())</span><br><span class="line">    print(<span class="string">"Standard deviation:"</span>, scores.std())</span><br><span class="line">display_scores(tree_rmse_scores)</span><br><span class="line"><span class="comment"># -》</span></span><br><span class="line"><span class="comment"># Scores: [70307.54079165 67270.94561829 71361.89886493 68889.91784739 70992.94150631 74140.66907294 70607.72083897 70576.13836762 76433.16342183 70270.96266671]</span></span><br><span class="line"><span class="comment"># Mean: 71085.189899664</span></span><br><span class="line"><span class="comment"># Standard deviation: 2431.961029690467</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 线性 交叉验证</span></span><br><span class="line">lin_scores = cross_val_score(lin_reg, housing_prepared, housing_labels,scoring=<span class="string">"neg_mean_squared_error"</span>, cv=<span class="number">10</span>)</span><br><span class="line">lin_rmse_scores = np.sqrt(-lin_scores)</span><br><span class="line">display_scores(lin_rmse_scores)</span><br><span class="line"></span><br><span class="line"><span class="comment"># -》</span></span><br><span class="line"><span class="comment"># Scores: [66877.52325028 66608.120256   70575.91118868 74179.94799352 67683.32205678 71103.16843468 64782.65896552 67711.29940352 71080.40484136 67687.6384546 ]</span></span><br><span class="line"><span class="comment"># Mean: 68828.99948449328</span></span><br><span class="line"><span class="comment"># Standard deviation: 2662.7615706103443</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor <span class="comment"># 随机森林</span></span><br><span class="line">forest_reg = RandomForestRegressor(n_estimators=<span class="number">10</span>, random_state=<span class="number">42</span>)</span><br><span class="line">forest_reg.fit(housing_prepared, housing_labels)</span><br><span class="line"></span><br><span class="line"><span class="comment"># RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=None,</span></span><br><span class="line"><span class="comment">#            max_features='auto', max_leaf_nodes=None,</span></span><br><span class="line"><span class="comment">#            min_impurity_decrease=0.0, min_impurity_split=None,</span></span><br><span class="line"><span class="comment">#            min_samples_leaf=1, min_samples_split=2,</span></span><br><span class="line"><span class="comment">#            min_weight_fraction_leaf=0.0, n_estimators=10, n_jobs=1,</span></span><br><span class="line"><span class="comment">#            oob_score=False, random_state=42, verbose=0, warm_start=False)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 误差比对</span></span><br><span class="line">housing_predictions = forest_reg.predict(housing_prepared)</span><br><span class="line">forest_mse = mean_squared_error(housing_labels, housing_predictions)</span><br><span class="line">forest_rmse = np.sqrt(forest_mse)</span><br><span class="line">forest_rmse</span><br><span class="line"></span><br><span class="line"><span class="comment">#-》 22112.540875989125</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 交叉验证</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line">forest_scores = cross_val_score(forest_reg, housing_prepared, housing_labels,scoring=<span class="string">"neg_mean_squared_error"</span>, cv=<span class="number">10</span>)</span><br><span class="line">forest_rmse_scores = np.sqrt(-forest_scores)</span><br><span class="line">display_scores(forest_rmse_scores)</span><br><span class="line"><span class="comment"># -》</span></span><br><span class="line"><span class="comment"># Scores: [51513.5500248  48821.99364978 53451.63889205 54910.55855153 50405.68166817 56772.90691171 51909.21824137 50516.14893695 55699.80788403 53107.7805515 ]</span></span><br><span class="line"><span class="comment"># Mean: 52710.92853118938</span></span><br><span class="line"><span class="comment"># Standard deviation: 2414.7271791176026</span></span><br></pre></td></tr></table></figure>
<h3 id="模型调参和网格搜索"><a href="#模型调参和网格搜索" class="headerlink" title="模型调参和网格搜索"></a>模型调参和网格搜索</h3><p>手动调整超参数，找到很好的组合很困难<br>使用GridSearchCV替你进行搜索，告诉它，进行试验的超参数是什么，和需要尝试的值，它会使用交叉验证评估所有超参数的可能组合</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV <span class="comment"># 网格搜索</span></span><br><span class="line"></span><br><span class="line">param_grid = [ <span class="comment"># 参数-》两个参数组合</span></span><br><span class="line">    &#123;<span class="string">'n_estimators'</span>: [<span class="number">3</span>, <span class="number">10</span>, <span class="number">30</span>], <span class="string">'max_features'</span>: [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]&#125;,</span><br><span class="line">    &#123;<span class="string">'bootstrap'</span>: [<span class="literal">False</span>], <span class="string">'n_estimators'</span>: [<span class="number">3</span>, <span class="number">10</span>], <span class="string">'max_features'</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]&#125;,</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">forest_reg = RandomForestRegressor(random_state=<span class="number">42</span>) <span class="comment"># 将上面的组合被随机森林初始化</span></span><br><span class="line">grid_search = GridSearchCV(forest_reg, param_grid, cv=<span class="number">5</span>, <span class="comment"># 放在网格中，cv=5，使用五次的验证</span></span><br><span class="line">                           scoring=<span class="string">'neg_mean_squared_error'</span>, return_train_score=<span class="literal">True</span>)</span><br><span class="line">grid_search.fit(housing_prepared, housing_labels)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">grid_search.best_params_ <span class="comment"># 查询效果最好的组合</span></span><br><span class="line"><span class="comment">#-&gt; &#123;'max_features': 6, 'n_estimators': 30&#125;</span></span><br><span class="line"></span><br><span class="line">grid_search.best_estimator_ <span class="comment"># 最好的估算器</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=None,</span></span><br><span class="line"><span class="comment">#            max_features=6, max_leaf_nodes=None, min_impurity_decrease=0.0,</span></span><br><span class="line"><span class="comment">#            min_impurity_split=None, min_samples_leaf=1,</span></span><br><span class="line"><span class="comment">#            min_samples_split=2, min_weight_fraction_leaf=0.0,</span></span><br><span class="line"><span class="comment">#            n_estimators=30, n_jobs=1, oob_score=False, random_state=42,</span></span><br><span class="line"><span class="comment">#            verbose=0, warm_start=False)</span></span><br><span class="line"></span><br><span class="line">cvres = grid_search.cv_results_</span><br><span class="line"><span class="keyword">for</span> mean_score, params <span class="keyword">in</span> zip(cvres[<span class="string">"mean_test_score"</span>], cvres[<span class="string">"params"</span>]):</span><br><span class="line">    print(np.sqrt(-mean_score), params)</span><br><span class="line"><span class="comment">#-》</span></span><br><span class="line"><span class="comment"># 64265.85210091941 &#123;'max_features': 2, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 55882.984840186626 &#123;'max_features': 2, 'n_estimators': 10&#125;</span></span><br><span class="line"><span class="comment"># 53472.52977048399 &#123;'max_features': 2, 'n_estimators': 30&#125;</span></span><br><span class="line"><span class="comment"># 61320.61721024631 &#123;'max_features': 4, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 53834.66617027598 &#123;'max_features': 4, 'n_estimators': 10&#125;</span></span><br><span class="line"><span class="comment"># 51273.25987325864 &#123;'max_features': 4, 'n_estimators': 30&#125;</span></span><br><span class="line"><span class="comment"># 59851.160077252265 &#123;'max_features': 6, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 53108.49267924178 &#123;'max_features': 6, 'n_estimators': 10&#125;</span></span><br><span class="line"><span class="comment"># 50804.490677496164 &#123;'max_features': 6, 'n_estimators': 30&#125;</span></span><br><span class="line"><span class="comment"># 59225.21977850634 &#123;'max_features': 8, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 52883.78258097852 &#123;'max_features': 8, 'n_estimators': 10&#125;</span></span><br><span class="line"><span class="comment"># 50942.15913785863 &#123;'max_features': 8, 'n_estimators': 30&#125;</span></span><br><span class="line"><span class="comment"># 62801.35724701795 &#123;'bootstrap': False, 'max_features': 2, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 54452.705621479254 &#123;'bootstrap': False, 'max_features': 2, 'n_estimators': 10&#125;</span></span><br><span class="line"><span class="comment"># 61122.949491813 &#123;'bootstrap': False, 'max_features': 3, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 53014.33296453683 &#123;'bootstrap': False, 'max_features': 3, 'n_estimators': 10&#125;</span></span><br><span class="line"><span class="comment"># 60252.65376680052 &#123;'bootstrap': False, 'max_features': 4, 'n_estimators': 3&#125;</span></span><br><span class="line"><span class="comment"># 52716.55059637336 &#123;'bootstrap': False, 'max_features': 4, 'n_estimators': 10&#125;</span></span><br></pre></td></tr></table></figure>
<p>数据准备步骤也可以当作超参数来处理，网格搜索会自动查找是否添加你不确定的特征，比如是否使用转换器 combinedAttre的超参数add_bedrooms_per_rom<br>也可是使用它自动寻找处理问题的最佳方法，比如异常值，缺失特征，特征选择等</p>
<h4 id="随机搜索"><a href="#随机搜索" class="headerlink" title="随机搜索"></a>随机搜索</h4>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>数据分析与数据挖掘</tag>
        <tag>Jupyter Notebook</tag>
        <tag>numpy</tag>
        <tag>Pandas</tag>
        <tag>sklearn</tag>
        <tag>matplotlib</tag>
        <tag>projec</tag>
        <tag>机器学习</tag>
      </tags>
  </entry>
  <entry>
    <title>Java_面向对象</title>
    <url>/2020/06/30/java_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    <content><![CDATA[<p>Java从新学<br>面向对象</p>
<a id="more"></a>

<h1 id="面向对象："><a href="#面向对象：" class="headerlink" title="面向对象："></a>面向对象：</h1><p>当需要实现一个功能的时候，不关心具体的步骤，而是找一个已经具有该功能的人</p>
<p>面向过程：<br>当实现一个功能的时候，每一个具体的步骤都要亲力亲为，详细处理每一个细节</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">60</span>&#125;;</span><br><span class="line">    <span class="comment">//面向过程</span></span><br><span class="line">    System.out.print(<span class="string">"["</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(i == array.length-<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(array[i]+<span class="string">"]"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.print(array[i]+<span class="string">", "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">"+++++++++++++++++++++++"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//面向对象</span></span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>]</span><br><span class="line">+++++++++++++++++++++++</span><br><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>]</span><br></pre></td></tr></table></figure>

<h1 id="封装、继承、多态"><a href="#封装、继承、多态" class="headerlink" title="封装、继承、多态"></a>封装、继承、多态</h1><h2 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h2><!-- 类：一组相关属性和行为的集合，可以看作是一类食物的模版，使用事物的属性特征和行为特征来描述 -->

<h3 id="类的定义"><a href="#类的定义" class="headerlink" title="类的定义"></a>类的定义</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo2</span> </span>&#123;</span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="comment">//成员方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"eat"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"sleep"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"study"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        demo2 stu = <span class="keyword">new</span> demo2();</span><br><span class="line">        stu.name = <span class="string">"John"</span> ;</span><br><span class="line">        stu.age = <span class="number">14</span>;</span><br><span class="line">        System.out.println(stu.name);<span class="comment">//引用类型</span></span><br><span class="line">        System.out.println(stu.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">out:</span><br><span class="line">John</span><br><span class="line"><span class="number">14</span></span><br></pre></td></tr></table></figure>
<p>成员变量是直接定义在类当中的，在方法外面<br>成员方法不要谢static关键词</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>通常情况下，一个累并不能直接使用，需要根据类创建一个对象，才能使用</p>
<ol>
<li>导报，指出需要使用的类，在什么位置<br>import 包名称<br>import···</li>
</ol>
<p>2.创建，格式：<br>类名称 对象名 = new 名称();</p>
<p>3.使用<br>分为两种情况<br>成员变量: 对象名.成员变量名<br>成员方法: 对象名.成员方法名</p>
<p>如果成员变量没有进行赋值,那么会有一个默认值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">phone</span> </span>&#123;</span><br><span class="line">    String brand;</span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line">    String color;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String who)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"call "</span> + who);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(String who)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"send to "</span> + who);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">···································································</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo1PhoneOne</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        phone one = <span class="keyword">new</span> phone();</span><br><span class="line">        one.brand = <span class="string">"apple"</span>;</span><br><span class="line">        one.color = <span class="string">"black"</span>;</span><br><span class="line">        one.price = <span class="number">32222</span>;</span><br><span class="line">        System.out.println(one.brand);</span><br><span class="line">        System.out.println(one.color);</span><br><span class="line">        System.out.println(one.price);</span><br><span class="line">        one.call(<span class="string">"me"</span>);</span><br><span class="line">        one.sendMessage(<span class="string">"him"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line">apple</span><br><span class="line">black</span><br><span class="line"><span class="number">32222.0</span></span><br><span class="line">call me</span><br><span class="line">send to him</span><br></pre></td></tr></table></figure>
<p>适用对象类型作为方法的参数<br>当一个对象作为参数,传递到方法中时,实际上传递进去的是对象的地址值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo4</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        phone ph = <span class="keyword">new</span> phone();</span><br><span class="line">        ph.brand = <span class="string">"apple"</span>;</span><br><span class="line">        ph.color = <span class="string">"black"</span>;</span><br><span class="line">        ph.price = <span class="number">2222</span>;</span><br><span class="line">        methode(ph);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">methode</span><span class="params">(phone param)</span> </span>&#123;</span><br><span class="line">        System.out.println(param.price+<span class="string">"\n"</span>+param.color+<span class="string">"\n"</span>+param.brand);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"><span class="number">2222.0</span></span><br><span class="line">black</span><br><span class="line">apple</span><br></pre></td></tr></table></figure>
<p>使用对象类型作为方法的返回值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo5</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        phone o = getPhone();</span><br><span class="line">        System.out.println(o.brand);</span><br><span class="line">        System.out.println(o.color);</span><br><span class="line">        System.out.println(o.price);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> phone <span class="title">getPhone</span><span class="params">()</span></span>&#123;</span><br><span class="line">        phone one = <span class="keyword">new</span> phone();</span><br><span class="line">        one.brand = <span class="string">"apple"</span>;</span><br><span class="line">        one.color = <span class="string">"black"</span>;</span><br><span class="line">        one.price = <span class="number">32222</span>;</span><br><span class="line">        <span class="keyword">return</span> one;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">out:</span><br><span class="line"><span class="number">2222.0</span></span><br><span class="line">black</span><br><span class="line">apple</span><br></pre></td></tr></table></figure>
<p>局部变量和成员变量<br>定义的位置不一样<br>局部变量: 在方法的内部<br>成员变量: 在方法的外部,直接写在类中</p>
<p>作用范围不一样<br>局部变量: 只有方法当中可以使用,出了方法不可继续使用<br>成员变量:整个类可以通用</p>
<p>默认值不一样<br>局部变量: 没有默认值,如果想使用,必须手动赋值<br>成员变量: 有默认值</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
</search>
